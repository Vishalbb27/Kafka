[2024-04-25 11:14:02,419] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:48:10,840] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-04-25 11:48:50,692] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-04-25 11:48:50,693] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(2) for 0 partitions (state.change.logger)
[2024-04-25 11:49:04,965] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(1, 2) for 0 partitions (state.change.logger)
[2024-04-25 11:49:04,965] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2024-04-25 11:51:43,440] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:51:43,601] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 2) for 0 partitions (state.change.logger)
[2024-04-25 11:52:13,176] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 2) for 0 partitions (state.change.logger)
[2024-04-25 11:52:13,177] INFO [Controller id=0 epoch=2] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-04-25 11:52:30,849] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet(1, 2) for 0 partitions (state.change.logger)
[2024-04-25 11:52:40,617] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet(1, 2) for 0 partitions (state.change.logger)
[2024-04-25 11:52:40,618] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2024-04-25 11:52:47,260] INFO [Controller id=2 epoch=3] Changed partition test-0 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-25 11:52:47,260] INFO [Controller id=2 epoch=3] Changed partition test-1 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-04-25 11:52:47,260] INFO [Controller id=2 epoch=3] Changed partition test-2 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-04-25 11:52:47,260] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:52:47,260] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:52:47,282] INFO [Controller id=2 epoch=3] Changed partition test-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 11:52:47,282] INFO [Controller id=2 epoch=3] Changed partition test-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 11:52:47,282] INFO [Controller id=2 epoch=3] Changed partition test-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 11:52:47,285] INFO [Controller id=2 epoch=3] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-04-25 11:52:47,286] INFO [Controller id=2 epoch=3] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-04-25 11:52:47,287] INFO [Controller id=2 epoch=3] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-04-25 11:52:47,287] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 3 partitions (state.change.logger)
[2024-04-25 11:52:47,288] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:52:47,290] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 2 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:52:47,290] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:52:47,290] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 2 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:52:47,306] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 2 from controller 2 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-04-25 11:52:47,306] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 2 from controller 2 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-04-25 11:52:47,331] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 2 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-04-25 11:52:47,447] INFO [Broker id=1] Leader test-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 11:52:47,455] INFO [Broker id=2] Leader test-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 11:52:47,468] INFO [Broker id=1] Finished LeaderAndIsr request in 177ms correlationId 2 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:52:47,472] INFO [Broker id=2] Finished LeaderAndIsr request in 182ms correlationId 2 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:52:47,482] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 3 with correlation id 3 (state.change.logger)
[2024-04-25 11:52:47,486] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 3 with correlation id 3 (state.change.logger)
[2024-04-25 11:52:47,488] INFO [Broker id=0] Leader test-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 11:52:47,505] INFO [Broker id=0] Finished LeaderAndIsr request in 213ms correlationId 1 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:52:47,530] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 3 with correlation id 2 (state.change.logger)
[2024-04-25 11:57:15,953] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:57:15,953] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:57:15,953] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 3 partitions (state.change.logger)
[2024-04-25 11:57:15,955] INFO [Broker id=2] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 3 with correlation id 4 (state.change.logger)
[2024-04-25 11:57:15,956] INFO [Broker id=0] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 3 with correlation id 3 (state.change.logger)
[2024-04-25 11:57:15,957] INFO [Broker id=1] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 3 with correlation id 4 (state.change.logger)
[2024-04-25 11:57:15,970] INFO [Controller id=2 epoch=3] Partition test-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 11:57:15,974] INFO [Controller id=2 epoch=3] Partition test-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 11:57:15,977] INFO [Controller id=2 epoch=3] Partition test-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 11:57:15,977] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:57:15,978] INFO [Controller id=2 epoch=3] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2024-04-25 11:57:15,980] INFO [Controller id=2 epoch=3] Sending StopReplica request for 1 replicas to broker 1 (state.change.logger)
[2024-04-25 11:57:15,980] INFO [Controller id=2 epoch=3] Sending StopReplica request for 1 replicas to broker 2 (state.change.logger)
[2024-04-25 11:57:15,981] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:57:15,981] INFO [Controller id=2 epoch=3] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2024-04-25 11:57:15,982] INFO [Controller id=2 epoch=3] Sending StopReplica request for 1 replicas to broker 1 (state.change.logger)
[2024-04-25 11:57:15,982] INFO [Controller id=2 epoch=3] Sending StopReplica request for 1 replicas to broker 2 (state.change.logger)
[2024-04-25 11:57:15,982] INFO [Broker id=2] Handling StopReplica request correlationId 5 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:57:15,982] INFO [Broker id=0] Handling StopReplica request correlationId 4 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:57:15,982] INFO [Broker id=1] Handling StopReplica request correlationId 5 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:57:15,992] INFO [Broker id=2] Handling StopReplica request correlationId 6 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:57:15,992] INFO [Broker id=0] Handling StopReplica request correlationId 5 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:57:15,992] INFO [Broker id=1] Handling StopReplica request correlationId 6 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:57:16,017] ERROR [Broker id=2] Ignoring StopReplica request (delete=true) from controller 2 with correlation id 6 epoch 3 for partition test-1 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 11:57:16,019] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 2 with correlation id 5 epoch 3 for partition test-0 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 11:57:16,021] ERROR [Broker id=1] Ignoring StopReplica request (delete=true) from controller 2 with correlation id 6 epoch 3 for partition test-2 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 11:57:16,024] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:57:16,026] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:57:16,027] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:58:45,886] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-04-25 11:58:45,944] INFO [Controller id=1 epoch=4] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-04-25 11:58:45,947] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet(1) for 1 partitions (state.change.logger)
[2024-04-25 11:58:45,975] INFO [Controller id=1 epoch=4] Partition test-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 11:58:45,983] INFO [Controller id=1 epoch=4] Partition test-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 11:58:45,983] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:58:46,005] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 1 partitions (state.change.logger)
[2024-04-25 11:58:46,038] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 4 for partition test-2 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 11:58:46,043] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 4 with correlation id 1 for 0 partitions (state.change.logger)
[2024-04-25 11:58:46,053] INFO [Broker id=1] Finished LeaderAndIsr request in 50ms correlationId 1 from controller 1 for 1 partitions (state.change.logger)
[2024-04-25 11:58:46,062] INFO [Broker id=1] Add 0 partitions and deleted 1 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 4 with correlation id 2 (state.change.logger)
[2024-04-25 11:58:53,357] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-04-25 11:58:53,358] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet(2) for 0 partitions (state.change.logger)
[2024-04-25 11:58:53,361] INFO [Controller id=1 epoch=4] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-04-25 11:58:53,362] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet(1, 2) for 1 partitions (state.change.logger)
[2024-04-25 11:58:53,365] INFO [Broker id=1] Add 0 partitions and deleted 1 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 4 with correlation id 4 (state.change.logger)
[2024-04-25 11:58:53,373] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:58:53,373] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:58:53,374] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet(1, 2) for 3 partitions (state.change.logger)
[2024-04-25 11:58:53,376] INFO [Broker id=1] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 4 with correlation id 5 (state.change.logger)
[2024-04-25 11:58:53,379] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:58:53,385] INFO [Controller id=1 epoch=4] Partition test-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 11:58:53,390] INFO [Controller id=1 epoch=4] Partition test-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 11:58:53,390] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:58:53,392] INFO [Controller id=1 epoch=4] Sending StopReplica request for 1 replicas to broker 1 (state.change.logger)
[2024-04-25 11:58:53,392] INFO [Controller id=1 epoch=4] Sending StopReplica request for 1 replicas to broker 2 (state.change.logger)
[2024-04-25 11:58:53,394] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:58:53,394] INFO [Controller id=1 epoch=4] Sending StopReplica request for 1 replicas to broker 1 (state.change.logger)
[2024-04-25 11:58:53,394] INFO [Controller id=1 epoch=4] Sending StopReplica request for 1 replicas to broker 2 (state.change.logger)
[2024-04-25 11:58:53,395] INFO [Broker id=1] Handling StopReplica request correlationId 6 from controller 1 for 1 partitions (state.change.logger)
[2024-04-25 11:58:53,407] INFO [Broker id=1] Handling StopReplica request correlationId 7 from controller 1 for 1 partitions (state.change.logger)
[2024-04-25 11:58:53,435] ERROR [Broker id=1] Ignoring StopReplica request (delete=true) from controller 1 with correlation id 7 epoch 4 for partition test-2 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 11:58:53,440] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:59:12,525] INFO [Controller id=2 epoch=5] Sending UpdateMetadata request to brokers HashSet(0, 2) for 0 partitions (state.change.logger)
[2024-04-25 11:59:12,547] INFO [Controller id=2 epoch=5] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-04-25 11:59:12,548] INFO [Controller id=2 epoch=5] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-04-25 11:59:12,548] INFO [Controller id=2 epoch=5] Sending UpdateMetadata request to brokers HashSet(0, 2) for 2 partitions (state.change.logger)
[2024-04-25 11:59:12,553] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:59:12,566] INFO [Controller id=2 epoch=5] Partition test-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 11:59:12,568] INFO [Controller id=2 epoch=5] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:59:12,572] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 5 for partition test-1 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 11:59:12,578] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 2 epoch 5 with correlation id 1 for 0 partitions (state.change.logger)
[2024-04-25 11:59:12,588] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:59:12,590] INFO [Broker id=2] Finished LeaderAndIsr request in 38ms correlationId 1 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:59:12,602] INFO [Broker id=2] Add 0 partitions and deleted 2 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 5 with correlation id 2 (state.change.logger)
[2024-04-25 11:59:12,612] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 5 for partition test-0 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 11:59:12,617] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 2 epoch 5 with correlation id 1 for 0 partitions (state.change.logger)
[2024-04-25 11:59:12,624] INFO [Broker id=0] Finished LeaderAndIsr request in 38ms correlationId 1 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:59:12,631] INFO [Broker id=0] Add 0 partitions and deleted 2 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 5 with correlation id 2 (state.change.logger)
[2024-04-25 11:59:21,211] INFO [Controller id=2 epoch=5] Sending UpdateMetadata request to brokers HashSet(0, 2) for 0 partitions (state.change.logger)
[2024-04-25 11:59:21,211] INFO [Controller id=2 epoch=5] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-04-25 11:59:21,217] INFO [Controller id=2 epoch=5] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-04-25 11:59:21,217] INFO [Controller id=2 epoch=5] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-04-25 11:59:21,219] INFO [Broker id=2] Add 0 partitions and deleted 1 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 5 with correlation id 4 (state.change.logger)
[2024-04-25 11:59:21,219] INFO [Broker id=0] Add 0 partitions and deleted 1 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 5 with correlation id 4 (state.change.logger)
[2024-04-25 11:59:21,227] INFO [Controller id=2 epoch=5] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:59:21,227] INFO [Controller id=2 epoch=5] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:59:21,228] INFO [Controller id=2 epoch=5] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 3 partitions (state.change.logger)
[2024-04-25 11:59:21,231] INFO [Broker id=0] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 5 with correlation id 5 (state.change.logger)
[2024-04-25 11:59:21,231] INFO [Broker id=2] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 5 with correlation id 5 (state.change.logger)
[2024-04-25 11:59:21,240] INFO [Controller id=2 epoch=5] Partition test-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 11:59:21,246] INFO [Controller id=2 epoch=5] Partition test-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 11:59:21,252] INFO [Controller id=2 epoch=5] Partition test-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 11:59:21,252] INFO [Controller id=2 epoch=5] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:59:21,254] INFO [Controller id=2 epoch=5] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2024-04-25 11:59:21,255] INFO [Controller id=2 epoch=5] Sending StopReplica request for 1 replicas to broker 1 (state.change.logger)
[2024-04-25 11:59:21,255] INFO [Controller id=2 epoch=5] Sending StopReplica request for 1 replicas to broker 2 (state.change.logger)
[2024-04-25 11:59:21,257] INFO [Controller id=2 epoch=5] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:59:21,258] INFO [Broker id=0] Handling StopReplica request correlationId 6 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:59:21,258] INFO [Controller id=2 epoch=5] Sending StopReplica request for 1 replicas to broker 0 (state.change.logger)
[2024-04-25 11:59:21,258] INFO [Controller id=2 epoch=5] Sending StopReplica request for 1 replicas to broker 1 (state.change.logger)
[2024-04-25 11:59:21,258] INFO [Controller id=2 epoch=5] Sending StopReplica request for 1 replicas to broker 2 (state.change.logger)
[2024-04-25 11:59:21,259] INFO [Broker id=2] Handling StopReplica request correlationId 6 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:59:21,273] INFO [Broker id=2] Handling StopReplica request correlationId 7 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:59:21,273] INFO [Broker id=0] Handling StopReplica request correlationId 7 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 11:59:21,304] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 2 with correlation id 7 epoch 5 for partition test-0 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 11:59:21,307] ERROR [Broker id=2] Ignoring StopReplica request (delete=true) from controller 2 with correlation id 7 epoch 5 for partition test-1 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 11:59:21,312] INFO [Controller id=2 epoch=5] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:59:21,314] INFO [Controller id=2 epoch=5] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:59:39,514] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-04-25 11:59:39,537] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-04-25 11:59:39,539] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1) for 1 partitions (state.change.logger)
[2024-04-25 11:59:39,543] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 1 partitions (state.change.logger)
[2024-04-25 11:59:39,559] INFO [Controller id=1 epoch=6] Partition test-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 11:59:39,566] INFO [Controller id=1 epoch=6] Partition test-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 11:59:39,566] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 11:59:39,568] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition test-2 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 11:59:39,574] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 6 with correlation id 1 for 0 partitions (state.change.logger)
[2024-04-25 11:59:39,583] INFO [Broker id=1] Finished LeaderAndIsr request in 41ms correlationId 1 from controller 1 for 1 partitions (state.change.logger)
[2024-04-25 11:59:39,595] INFO [Broker id=1] Add 0 partitions and deleted 1 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 2 (state.change.logger)
[2024-04-25 12:00:07,278] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-04-25 12:00:07,283] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(2) for 0 partitions (state.change.logger)
[2024-04-25 12:00:07,286] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-04-25 12:00:07,286] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1, 2) for 1 partitions (state.change.logger)
[2024-04-25 12:00:07,294] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 12:00:07,295] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 12:00:07,297] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1, 2) for 3 partitions (state.change.logger)
[2024-04-25 12:00:07,300] INFO [Broker id=1] Add 0 partitions and deleted 1 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 4 (state.change.logger)
[2024-04-25 12:00:07,308] INFO [Broker id=1] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 5 (state.change.logger)
[2024-04-25 12:00:07,308] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 12:00:07,315] INFO [Controller id=1 epoch=6] Partition test-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 12:00:07,321] INFO [Controller id=1 epoch=6] Partition test-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 12:00:07,321] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 12:00:07,324] INFO [Controller id=1 epoch=6] Sending StopReplica request for 1 replicas to broker 1 (state.change.logger)
[2024-04-25 12:00:07,325] INFO [Controller id=1 epoch=6] Sending StopReplica request for 1 replicas to broker 2 (state.change.logger)
[2024-04-25 12:00:07,326] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 12:00:07,326] INFO [Controller id=1 epoch=6] Sending StopReplica request for 1 replicas to broker 1 (state.change.logger)
[2024-04-25 12:00:07,326] INFO [Controller id=1 epoch=6] Sending StopReplica request for 1 replicas to broker 2 (state.change.logger)
[2024-04-25 12:00:07,327] INFO [Broker id=1] Handling StopReplica request correlationId 6 from controller 1 for 1 partitions (state.change.logger)
[2024-04-25 12:00:07,341] INFO [Broker id=1] Handling StopReplica request correlationId 7 from controller 1 for 1 partitions (state.change.logger)
[2024-04-25 12:00:07,365] ERROR [Broker id=1] Ignoring StopReplica request (delete=true) from controller 1 with correlation id 7 epoch 6 for partition test-2 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 12:00:07,370] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 12:00:27,545] INFO [Controller id=2 epoch=7] Sending UpdateMetadata request to brokers HashSet(0, 2) for 0 partitions (state.change.logger)
[2024-04-25 12:00:27,577] INFO [Controller id=2 epoch=7] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-04-25 12:00:27,579] INFO [Controller id=2 epoch=7] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-04-25 12:00:27,579] INFO [Controller id=2 epoch=7] Sending UpdateMetadata request to brokers HashSet(0, 2) for 2 partitions (state.change.logger)
[2024-04-25 12:00:27,586] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 12:00:27,604] INFO [Controller id=2 epoch=7] Partition test-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 12:00:27,606] INFO [Controller id=2 epoch=7] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 12:00:27,616] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 7 for partition test-1 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 12:00:27,624] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 2 epoch 7 with correlation id 1 for 0 partitions (state.change.logger)
[2024-04-25 12:00:27,639] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 12:00:27,643] INFO [Broker id=2] Finished LeaderAndIsr request in 59ms correlationId 1 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 12:00:27,663] INFO [Broker id=2] Add 0 partitions and deleted 2 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 7 with correlation id 2 (state.change.logger)
[2024-04-25 12:00:27,677] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 7 for partition test-0 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 12:00:27,686] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 2 epoch 7 with correlation id 1 for 0 partitions (state.change.logger)
[2024-04-25 12:00:27,703] INFO [Broker id=0] Finished LeaderAndIsr request in 69ms correlationId 1 from controller 2 for 1 partitions (state.change.logger)
[2024-04-25 12:00:27,716] INFO [Broker id=0] Add 0 partitions and deleted 2 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 7 with correlation id 2 (state.change.logger)
[2024-04-25 12:00:38,616] INFO [Controller id=2 epoch=7] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 12:00:49,745] INFO [Controller id=2 epoch=7] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 12:01:14,999] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-04-25 12:01:24,008] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-04-25 12:01:24,009] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(2) for 0 partitions (state.change.logger)
[2024-04-25 12:01:28,686] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(1, 2) for 0 partitions (state.change.logger)
[2024-04-25 12:01:28,687] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2024-04-25 12:03:17,490] INFO [Controller id=1 epoch=1] Changed partition topic1-0 state from NonExistentPartition to NewPartition with assigned replicas 1,0,2 (state.change.logger)
[2024-04-25 12:03:17,491] INFO [Controller id=1 epoch=1] Changed partition topic1-1 state from NonExistentPartition to NewPartition with assigned replicas 0,2,1 (state.change.logger)
[2024-04-25 12:03:17,491] INFO [Controller id=1 epoch=1] Changed partition topic1-2 state from NonExistentPartition to NewPartition with assigned replicas 2,1,0 (state.change.logger)
[2024-04-25 12:03:17,491] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 12:03:17,494] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 12:03:17,513] INFO [Controller id=1 epoch=1] Changed partition topic1-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1, 0, 2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 12:03:17,513] INFO [Controller id=1 epoch=1] Changed partition topic1-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 2, 1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 12:03:17,513] INFO [Controller id=1 epoch=1] Changed partition topic1-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2, 1, 0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 12:03:17,515] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-04-25 12:03:17,517] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-04-25 12:03:17,517] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-04-25 12:03:17,517] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 3 partitions (state.change.logger)
[2024-04-25 12:03:17,518] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 12:03:17,522] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 12:03:17,522] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 12:03:17,524] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 2 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 12:03:17,546] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 1 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-04-25 12:03:17,550] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-04-25 12:03:17,551] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 2 from controller 1 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-04-25 12:03:17,675] INFO [Broker id=0] Leader topic1-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,2,1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 12:03:17,681] INFO [Broker id=2] Leader topic1-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2,1,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 12:03:17,682] INFO [Broker id=1] Leader topic1-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1,0,2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 12:03:17,700] INFO [Broker id=0] Follower topic1-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 12:03:17,706] INFO [Broker id=2] Follower topic1-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 12:03:17,708] INFO [Broker id=1] Follower topic1-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 12:03:17,714] INFO [Broker id=0] Follower topic1-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 12:03:17,716] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 1 epoch 1 with correlation id 1 for 2 partitions (state.change.logger)
[2024-04-25 12:03:17,719] INFO [Broker id=2] Follower topic1-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 12:03:17,720] INFO [Broker id=1] Follower topic1-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 12:03:17,721] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 1 with correlation id 3 for 2 partitions (state.change.logger)
[2024-04-25 12:03:17,721] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 1 with correlation id 2 for 2 partitions (state.change.logger)
[2024-04-25 12:03:17,826] INFO [Broker id=1] Finished LeaderAndIsr request in 304ms correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 12:03:17,848] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 4 (state.change.logger)
[2024-04-25 12:03:17,849] INFO [Broker id=2] Finished LeaderAndIsr request in 326ms correlationId 2 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 12:03:17,853] INFO [Broker id=0] Finished LeaderAndIsr request in 332ms correlationId 1 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 12:03:17,862] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 3 (state.change.logger)
[2024-04-25 12:03:17,879] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 2 (state.change.logger)
[2024-04-25 12:09:53,705] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 12:09:53,705] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 12:09:53,706] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 3 partitions (state.change.logger)
[2024-04-25 12:09:53,708] INFO [Broker id=1] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 5 (state.change.logger)
[2024-04-25 12:09:53,708] INFO [Broker id=0] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 3 (state.change.logger)
[2024-04-25 12:09:53,709] INFO [Broker id=2] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 4 (state.change.logger)
[2024-04-25 12:09:53,729] INFO [Controller id=1 epoch=1] Partition topic1-1 state changed to (Leader:-1,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 12:09:53,729] INFO [Controller id=1 epoch=1] Partition topic1-0 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 12:09:53,729] INFO [Controller id=1 epoch=1] Partition topic1-2 state changed to (Leader:2,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 12:09:53,734] INFO [Controller id=1 epoch=1] Partition topic1-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 12:09:53,734] INFO [Controller id=1 epoch=1] Partition topic1-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 12:09:53,734] INFO [Controller id=1 epoch=1] Partition topic1-2 state changed to (Leader:2,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:1) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 12:09:53,739] INFO [Controller id=1 epoch=1] Partition topic1-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:1) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 12:09:53,739] INFO [Controller id=1 epoch=1] Partition topic1-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:1) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 12:09:53,739] INFO [Controller id=1 epoch=1] Partition topic1-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:1) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 12:09:53,739] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 12:09:53,740] INFO [Controller id=1 epoch=1] Sending StopReplica request for 3 replicas to broker 0 (state.change.logger)
[2024-04-25 12:09:53,741] INFO [Controller id=1 epoch=1] Sending StopReplica request for 3 replicas to broker 1 (state.change.logger)
[2024-04-25 12:09:53,741] INFO [Controller id=1 epoch=1] Sending StopReplica request for 3 replicas to broker 2 (state.change.logger)
[2024-04-25 12:09:53,741] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 12:09:53,742] INFO [Controller id=1 epoch=1] Sending StopReplica request for 3 replicas to broker 0 (state.change.logger)
[2024-04-25 12:09:53,742] INFO [Broker id=1] Handling StopReplica request correlationId 6 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 12:09:53,742] INFO [Controller id=1 epoch=1] Sending StopReplica request for 3 replicas to broker 1 (state.change.logger)
[2024-04-25 12:09:53,742] INFO [Controller id=1 epoch=1] Sending StopReplica request for 3 replicas to broker 2 (state.change.logger)
[2024-04-25 12:09:53,742] INFO [Broker id=0] Handling StopReplica request correlationId 4 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 12:09:53,742] INFO [Broker id=2] Handling StopReplica request correlationId 5 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 12:09:53,753] INFO [Broker id=1] Handling StopReplica request correlationId 7 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 12:09:53,754] INFO [Broker id=0] Handling StopReplica request correlationId 5 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 12:09:53,755] INFO [Broker id=2] Handling StopReplica request correlationId 6 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 12:09:53,813] ERROR [Broker id=2] Ignoring StopReplica request (delete=true) from controller 1 with correlation id 6 epoch 1 for partition topic1-1 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 12:09:53,813] ERROR [Broker id=1] Ignoring StopReplica request (delete=true) from controller 1 with correlation id 7 epoch 1 for partition topic1-1 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 12:09:53,814] ERROR [Broker id=1] Ignoring StopReplica request (delete=true) from controller 1 with correlation id 7 epoch 1 for partition topic1-0 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 12:09:53,814] ERROR [Broker id=2] Ignoring StopReplica request (delete=true) from controller 1 with correlation id 6 epoch 1 for partition topic1-0 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 12:09:53,814] ERROR [Broker id=1] Ignoring StopReplica request (delete=true) from controller 1 with correlation id 7 epoch 1 for partition topic1-2 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 12:09:53,814] ERROR [Broker id=2] Ignoring StopReplica request (delete=true) from controller 1 with correlation id 6 epoch 1 for partition topic1-2 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 12:09:53,818] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 1 with correlation id 5 epoch 1 for partition topic1-1 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 12:09:53,818] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 1 with correlation id 5 epoch 1 for partition topic1-0 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 12:09:53,818] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 1 with correlation id 5 epoch 1 for partition topic1-2 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 12:09:53,819] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 12:09:53,821] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 12:09:53,822] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:38:08,282] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-04-25 14:38:08,330] INFO [Controller id=1 epoch=2] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-04-25 14:38:08,332] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(1) for 3 partitions (state.change.logger)
[2024-04-25 14:38:08,347] INFO [Controller id=1 epoch=2] Partition topic1-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:08,347] INFO [Controller id=1 epoch=2] Partition topic1-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:08,347] INFO [Controller id=1 epoch=2] Partition topic1-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:08,367] INFO [Controller id=1 epoch=2] Partition topic1-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:08,368] INFO [Controller id=1 epoch=2] Partition topic1-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:08,368] INFO [Controller id=1 epoch=2] Partition topic1-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:08,368] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:38:08,415] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 14:38:08,463] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition topic1-1 (last update controller epoch 1) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 14:38:08,467] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition topic1-2 (last update controller epoch 1) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 14:38:08,468] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition topic1-0 (last update controller epoch 1) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 14:38:08,471] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 2 with correlation id 1 for 0 partitions (state.change.logger)
[2024-04-25 14:38:08,480] INFO [Broker id=1] Finished LeaderAndIsr request in 66ms correlationId 1 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 14:38:08,489] INFO [Broker id=1] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 2 (state.change.logger)
[2024-04-25 14:38:11,633] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-04-25 14:38:11,634] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(2) for 0 partitions (state.change.logger)
[2024-04-25 14:38:11,637] INFO [Controller id=1 epoch=2] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-04-25 14:38:11,637] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(1, 2) for 3 partitions (state.change.logger)
[2024-04-25 14:38:11,640] INFO [Broker id=1] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 4 (state.change.logger)
[2024-04-25 14:38:11,653] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:38:11,653] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:38:11,654] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(1, 2) for 3 partitions (state.change.logger)
[2024-04-25 14:38:11,656] INFO [Broker id=1] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 5 (state.change.logger)
[2024-04-25 14:38:11,661] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:38:11,665] INFO [Controller id=1 epoch=2] Partition topic1-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:11,665] INFO [Controller id=1 epoch=2] Partition topic1-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:11,665] INFO [Controller id=1 epoch=2] Partition topic1-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:11,675] INFO [Controller id=1 epoch=2] Partition topic1-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:11,675] INFO [Controller id=1 epoch=2] Partition topic1-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:11,675] INFO [Controller id=1 epoch=2] Partition topic1-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:11,675] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:38:11,677] INFO [Controller id=1 epoch=2] Sending StopReplica request for 3 replicas to broker 1 (state.change.logger)
[2024-04-25 14:38:11,678] INFO [Controller id=1 epoch=2] Sending StopReplica request for 3 replicas to broker 2 (state.change.logger)
[2024-04-25 14:38:11,679] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:38:11,679] INFO [Controller id=1 epoch=2] Sending StopReplica request for 3 replicas to broker 1 (state.change.logger)
[2024-04-25 14:38:11,679] INFO [Controller id=1 epoch=2] Sending StopReplica request for 3 replicas to broker 2 (state.change.logger)
[2024-04-25 14:38:11,680] INFO [Broker id=1] Handling StopReplica request correlationId 6 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 14:38:11,693] INFO [Broker id=1] Handling StopReplica request correlationId 7 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 14:38:11,735] ERROR [Broker id=1] Ignoring StopReplica request (delete=true) from controller 1 with correlation id 7 epoch 2 for partition topic1-1 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 14:38:11,736] ERROR [Broker id=1] Ignoring StopReplica request (delete=true) from controller 1 with correlation id 7 epoch 2 for partition topic1-0 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 14:38:11,736] ERROR [Broker id=1] Ignoring StopReplica request (delete=true) from controller 1 with correlation id 7 epoch 2 for partition topic1-2 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 14:38:11,741] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:38:30,722] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 2) for 0 partitions (state.change.logger)
[2024-04-25 14:38:30,750] INFO [Controller id=2 epoch=3] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-04-25 14:38:30,751] INFO [Controller id=2 epoch=3] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-04-25 14:38:30,752] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 2) for 3 partitions (state.change.logger)
[2024-04-25 14:38:30,756] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 2 for 3 partitions (state.change.logger)
[2024-04-25 14:38:30,762] INFO [Controller id=2 epoch=3] Partition topic1-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:3) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:30,762] INFO [Controller id=2 epoch=3] Partition topic1-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:3) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:30,762] INFO [Controller id=2 epoch=3] Partition topic1-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:3) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:30,764] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:38:30,785] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 3 for partition topic1-1 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 14:38:30,788] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 2 for 3 partitions (state.change.logger)
[2024-04-25 14:38:30,789] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 3 for partition topic1-2 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 14:38:30,790] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 3 for partition topic1-0 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 14:38:30,792] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 2 epoch 3 with correlation id 1 for 0 partitions (state.change.logger)
[2024-04-25 14:38:30,806] INFO [Broker id=2] Finished LeaderAndIsr request in 51ms correlationId 1 from controller 2 for 3 partitions (state.change.logger)
[2024-04-25 14:38:30,814] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 3 for partition topic1-1 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 14:38:30,816] INFO [Broker id=2] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 3 with correlation id 2 (state.change.logger)
[2024-04-25 14:38:30,820] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 3 for partition topic1-2 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 14:38:30,821] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 3 for partition topic1-0 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 14:38:30,823] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 2 epoch 3 with correlation id 1 for 0 partitions (state.change.logger)
[2024-04-25 14:38:30,833] INFO [Broker id=0] Finished LeaderAndIsr request in 45ms correlationId 1 from controller 2 for 3 partitions (state.change.logger)
[2024-04-25 14:38:30,841] INFO [Broker id=0] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 3 with correlation id 2 (state.change.logger)
[2024-04-25 14:38:44,907] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 2) for 0 partitions (state.change.logger)
[2024-04-25 14:38:44,915] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-04-25 14:38:44,920] INFO [Controller id=2 epoch=3] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-04-25 14:38:44,921] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 3 partitions (state.change.logger)
[2024-04-25 14:38:44,923] INFO [Broker id=2] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 3 with correlation id 4 (state.change.logger)
[2024-04-25 14:38:44,923] INFO [Broker id=0] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 3 with correlation id 4 (state.change.logger)
[2024-04-25 14:38:44,929] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:38:44,929] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:38:44,930] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 3 partitions (state.change.logger)
[2024-04-25 14:38:44,933] INFO [Broker id=2] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 3 with correlation id 5 (state.change.logger)
[2024-04-25 14:38:44,938] INFO [Broker id=0] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 3 with correlation id 5 (state.change.logger)
[2024-04-25 14:38:44,946] INFO [Controller id=2 epoch=3] Partition topic1-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:44,946] INFO [Controller id=2 epoch=3] Partition topic1-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:44,946] INFO [Controller id=2 epoch=3] Partition topic1-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:44,950] INFO [Controller id=2 epoch=3] Partition topic1-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:3) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:44,950] INFO [Controller id=2 epoch=3] Partition topic1-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:3) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:44,950] INFO [Controller id=2 epoch=3] Partition topic1-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:3) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:44,960] INFO [Controller id=2 epoch=3] Partition topic1-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:44,960] INFO [Controller id=2 epoch=3] Partition topic1-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:44,960] INFO [Controller id=2 epoch=3] Partition topic1-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:38:44,960] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:38:44,960] INFO [Controller id=2 epoch=3] Sending StopReplica request for 3 replicas to broker 0 (state.change.logger)
[2024-04-25 14:38:44,960] INFO [Controller id=2 epoch=3] Sending StopReplica request for 3 replicas to broker 1 (state.change.logger)
[2024-04-25 14:38:44,960] INFO [Controller id=2 epoch=3] Sending StopReplica request for 3 replicas to broker 2 (state.change.logger)
[2024-04-25 14:38:44,967] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:38:44,967] INFO [Controller id=2 epoch=3] Sending StopReplica request for 3 replicas to broker 0 (state.change.logger)
[2024-04-25 14:38:44,967] INFO [Controller id=2 epoch=3] Sending StopReplica request for 3 replicas to broker 1 (state.change.logger)
[2024-04-25 14:38:44,967] INFO [Broker id=0] Handling StopReplica request correlationId 6 from controller 2 for 3 partitions (state.change.logger)
[2024-04-25 14:38:44,967] INFO [Controller id=2 epoch=3] Sending StopReplica request for 3 replicas to broker 2 (state.change.logger)
[2024-04-25 14:38:44,967] INFO [Broker id=2] Handling StopReplica request correlationId 6 from controller 2 for 3 partitions (state.change.logger)
[2024-04-25 14:38:44,978] INFO [Broker id=2] Handling StopReplica request correlationId 7 from controller 2 for 3 partitions (state.change.logger)
[2024-04-25 14:38:44,979] INFO [Broker id=0] Handling StopReplica request correlationId 7 from controller 2 for 3 partitions (state.change.logger)
[2024-04-25 14:38:45,023] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 2 with correlation id 7 epoch 3 for partition topic1-1 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 14:38:45,023] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 2 with correlation id 7 epoch 3 for partition topic1-0 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 14:38:45,023] ERROR [Broker id=0] Ignoring StopReplica request (delete=true) from controller 2 with correlation id 7 epoch 3 for partition topic1-2 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 14:38:45,024] ERROR [Broker id=2] Ignoring StopReplica request (delete=true) from controller 2 with correlation id 7 epoch 3 for partition topic1-1 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 14:38:45,024] ERROR [Broker id=2] Ignoring StopReplica request (delete=true) from controller 2 with correlation id 7 epoch 3 for partition topic1-0 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 14:38:45,024] ERROR [Broker id=2] Ignoring StopReplica request (delete=true) from controller 2 with correlation id 7 epoch 3 for partition topic1-2 as the local replica for the partition is in an offline log directory (state.change.logger)
[2024-04-25 14:38:45,030] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:38:45,033] INFO [Controller id=2 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:39:03,702] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-04-25 14:39:03,725] INFO [Controller id=1 epoch=4] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-04-25 14:39:03,726] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet(1) for 3 partitions (state.change.logger)
[2024-04-25 14:39:03,731] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 14:39:03,736] INFO [Controller id=1 epoch=4] Partition topic1-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:39:03,737] INFO [Controller id=1 epoch=4] Partition topic1-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:39:03,737] INFO [Controller id=1 epoch=4] Partition topic1-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:39:03,748] INFO [Controller id=1 epoch=4] Partition topic1-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:39:03,748] INFO [Controller id=1 epoch=4] Partition topic1-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:39:03,749] INFO [Controller id=1 epoch=4] Partition topic1-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:39:03,749] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:39:03,754] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 4 for partition topic1-1 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 14:39:03,758] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 4 for partition topic1-2 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 14:39:03,759] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 4 for partition topic1-0 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 14:39:03,762] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 4 with correlation id 1 for 0 partitions (state.change.logger)
[2024-04-25 14:39:03,771] INFO [Broker id=1] Finished LeaderAndIsr request in 41ms correlationId 1 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 14:39:03,781] INFO [Broker id=1] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 4 with correlation id 2 (state.change.logger)
[2024-04-25 14:39:37,347] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:40:06,714] INFO [Controller id=2 epoch=5] Sending UpdateMetadata request to brokers HashSet(2) for 0 partitions (state.change.logger)
[2024-04-25 14:40:06,745] INFO [Controller id=2 epoch=5] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-04-25 14:40:06,747] INFO [Controller id=2 epoch=5] Sending UpdateMetadata request to brokers HashSet(2) for 3 partitions (state.change.logger)
[2024-04-25 14:40:06,758] INFO [Controller id=2 epoch=5] Partition topic1-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:40:06,758] INFO [Controller id=2 epoch=5] Partition topic1-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:40:06,758] INFO [Controller id=2 epoch=5] Partition topic1-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:40:06,762] INFO [Controller id=2 epoch=5] Partition topic1-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:40:06,762] INFO [Controller id=2 epoch=5] Partition topic1-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:40:06,762] INFO [Controller id=2 epoch=5] Partition topic1-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 14:40:06,762] INFO [Controller id=2 epoch=5] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:40:06,792] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 2 for 3 partitions (state.change.logger)
[2024-04-25 14:40:06,818] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 5 for partition topic1-1 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 14:40:06,823] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 5 for partition topic1-2 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 14:40:06,824] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 5 for partition topic1-0 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-25 14:40:06,826] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 2 epoch 5 with correlation id 1 for 0 partitions (state.change.logger)
[2024-04-25 14:40:06,835] INFO [Broker id=2] Finished LeaderAndIsr request in 43ms correlationId 1 from controller 2 for 3 partitions (state.change.logger)
[2024-04-25 14:40:06,845] INFO [Broker id=2] Add 0 partitions and deleted 3 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 5 with correlation id 2 (state.change.logger)
[2024-04-25 14:40:44,615] INFO [Controller id=2 epoch=5] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:41:05,183] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-04-25 14:41:14,405] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-04-25 14:41:14,406] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(2) for 0 partitions (state.change.logger)
[2024-04-25 14:41:25,197] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(1, 2) for 0 partitions (state.change.logger)
[2024-04-25 14:41:25,198] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2024-04-25 14:41:37,977] INFO [Controller id=1 epoch=1] Changed partition topic2-0 state from NonExistentPartition to NewPartition with assigned replicas 1,0,2 (state.change.logger)
[2024-04-25 14:41:37,978] INFO [Controller id=1 epoch=1] Changed partition topic2-1 state from NonExistentPartition to NewPartition with assigned replicas 0,2,1 (state.change.logger)
[2024-04-25 14:41:37,978] INFO [Controller id=1 epoch=1] Changed partition topic2-2 state from NonExistentPartition to NewPartition with assigned replicas 2,1,0 (state.change.logger)
[2024-04-25 14:41:37,978] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:41:37,980] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:41:37,999] INFO [Controller id=1 epoch=1] Changed partition topic2-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1, 0, 2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:41:37,999] INFO [Controller id=1 epoch=1] Changed partition topic2-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 2, 1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:41:37,999] INFO [Controller id=1 epoch=1] Changed partition topic2-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2, 1, 0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:41:38,001] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-04-25 14:41:38,003] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-04-25 14:41:38,003] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-04-25 14:41:38,003] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 3 partitions (state.change.logger)
[2024-04-25 14:41:38,004] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:41:38,007] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 14:41:38,009] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 14:41:38,010] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 2 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 14:41:38,027] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-04-25 14:41:38,033] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 1 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-04-25 14:41:38,036] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 2 from controller 1 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-04-25 14:41:38,141] INFO [Broker id=1] Leader topic2-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1,0,2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:41:38,156] INFO [Broker id=2] Leader topic2-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2,1,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:41:38,164] INFO [Broker id=0] Leader topic2-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,2,1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:41:38,165] INFO [Broker id=1] Follower topic2-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:41:38,178] INFO [Broker id=1] Follower topic2-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:41:38,180] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 1 with correlation id 3 for 2 partitions (state.change.logger)
[2024-04-25 14:41:38,183] INFO [Broker id=2] Follower topic2-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:41:38,189] INFO [Broker id=0] Follower topic2-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:41:38,195] INFO [Broker id=2] Follower topic2-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:41:38,197] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 1 with correlation id 2 for 2 partitions (state.change.logger)
[2024-04-25 14:41:38,202] INFO [Broker id=0] Follower topic2-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:41:38,204] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 1 epoch 1 with correlation id 1 for 2 partitions (state.change.logger)
[2024-04-25 14:41:38,233] INFO [Broker id=1] Finished LeaderAndIsr request in 226ms correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 14:41:38,245] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 4 (state.change.logger)
[2024-04-25 14:41:38,383] INFO [Broker id=0] Finished LeaderAndIsr request in 372ms correlationId 1 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 14:41:38,384] INFO [Broker id=2] Finished LeaderAndIsr request in 376ms correlationId 2 from controller 1 for 3 partitions (state.change.logger)
[2024-04-25 14:41:38,404] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 3 (state.change.logger)
[2024-04-25 14:41:38,408] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 2 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-22 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-30 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-25 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-35 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-37 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-38 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-13 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-8 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-21 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-4 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-27 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-7 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-9 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-46 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-41 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-33 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-23 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-49 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-47 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-16 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-28 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-31 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-36 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-42 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-3 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-18 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-15 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-24 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-17 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-48 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-19 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-11 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-2 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-43 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-6 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-14 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-20 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-0 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-44 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-39 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-12 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-45 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-1 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-5 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-26 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-29 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-34 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-10 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-32 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-40 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-25 14:44:18,363] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:44:18,364] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-22 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-30 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-25 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-35 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-37 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-38 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-13 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-8 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-21 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-4 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-27 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-7 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-9 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-46 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-41 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-33 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-23 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-49 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-47 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-16 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-28 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-31 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-36 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-42 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-3 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-18 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-15 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-24 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-17 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-48 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-19 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-11 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-43 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-6 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-14 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-20 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-44 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-39 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-12 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,409] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-45 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,410] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,410] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-5 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,410] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-26 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,410] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-29 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,410] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-34 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,410] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-10 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,410] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-32 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,410] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-40 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-25 14:44:18,410] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 0 with 17 become-leader and 0 become-follower partitions (state.change.logger)
[2024-04-25 14:44:18,410] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 1 with 17 become-leader and 0 become-follower partitions (state.change.logger)
[2024-04-25 14:44:18,410] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 2 with 16 become-leader and 0 become-follower partitions (state.change.logger)
[2024-04-25 14:44:18,410] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 50 partitions (state.change.logger)
[2024-04-25 14:44:18,411] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 5 from controller 1 for 17 partitions (state.change.logger)
[2024-04-25 14:44:18,411] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 4 from controller 1 for 16 partitions (state.change.logger)
[2024-04-25 14:44:18,411] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 1 for 17 partitions (state.change.logger)
[2024-04-25 14:44:18,411] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 14:44:18,433] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 4 from controller 1 epoch 1 as part of the become-leader transition for 16 partitions (state.change.logger)
[2024-04-25 14:44:18,435] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 1 epoch 1 as part of the become-leader transition for 17 partitions (state.change.logger)
[2024-04-25 14:44:18,438] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 1 as part of the become-leader transition for 17 partitions (state.change.logger)
[2024-04-25 14:44:18,465] INFO [Broker id=0] Leader __consumer_offsets-37 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,468] INFO [Broker id=1] Leader __consumer_offsets-3 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,475] INFO [Broker id=2] Leader __consumer_offsets-35 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,495] INFO [Broker id=2] Leader __consumer_offsets-5 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,498] INFO [Broker id=0] Leader __consumer_offsets-7 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,502] INFO [Broker id=1] Leader __consumer_offsets-18 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,509] INFO [Broker id=2] Leader __consumer_offsets-20 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,523] INFO [Broker id=0] Leader __consumer_offsets-22 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,526] INFO [Broker id=1] Leader __consumer_offsets-39 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,530] INFO [Broker id=2] Leader __consumer_offsets-41 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,543] INFO [Broker id=0] Leader __consumer_offsets-10 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,544] INFO [Broker id=2] Leader __consumer_offsets-29 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,545] INFO [Broker id=1] Leader __consumer_offsets-9 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,557] INFO [Broker id=2] Leader __consumer_offsets-44 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,560] INFO [Broker id=0] Leader __consumer_offsets-31 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,562] INFO [Broker id=1] Leader __consumer_offsets-24 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,571] INFO [Broker id=2] Leader __consumer_offsets-14 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,579] INFO [Broker id=0] Leader __consumer_offsets-46 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,580] INFO [Broker id=1] Leader __consumer_offsets-27 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,620] INFO [Broker id=2] Leader __consumer_offsets-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,630] INFO [Broker id=1] Leader __consumer_offsets-42 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,634] INFO [Broker id=0] Leader __consumer_offsets-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,642] INFO [Broker id=2] Leader __consumer_offsets-23 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,647] INFO [Broker id=1] Leader __consumer_offsets-12 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,649] INFO [Broker id=0] Leader __consumer_offsets-16 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,658] INFO [Broker id=2] Leader __consumer_offsets-38 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,664] INFO [Broker id=1] Leader __consumer_offsets-33 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,664] INFO [Broker id=0] Leader __consumer_offsets-19 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,675] INFO [Broker id=2] Leader __consumer_offsets-8 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,680] INFO [Broker id=1] Leader __consumer_offsets-48 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,680] INFO [Broker id=0] Leader __consumer_offsets-34 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,689] INFO [Broker id=2] Leader __consumer_offsets-11 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,694] INFO [Broker id=1] Leader __consumer_offsets-21 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,695] INFO [Broker id=0] Leader __consumer_offsets-4 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,701] INFO [Broker id=2] Leader __consumer_offsets-26 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,708] INFO [Broker id=1] Leader __consumer_offsets-36 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,709] INFO [Broker id=0] Leader __consumer_offsets-25 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,714] INFO [Broker id=2] Leader __consumer_offsets-47 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,722] INFO [Broker id=0] Leader __consumer_offsets-40 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,722] INFO [Broker id=1] Leader __consumer_offsets-6 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,728] INFO [Broker id=2] Leader __consumer_offsets-17 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,739] INFO [Broker id=0] Leader __consumer_offsets-43 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,739] INFO [Broker id=1] Leader __consumer_offsets-45 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,747] INFO [Broker id=2] Leader __consumer_offsets-32 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,756] INFO [Broker id=1] Leader __consumer_offsets-15 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,759] INFO [Broker id=0] Leader __consumer_offsets-13 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,783] INFO [Broker id=1] Leader __consumer_offsets-30 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,787] INFO [Broker id=0] Leader __consumer_offsets-28 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,798] INFO [Broker id=2] Finished LeaderAndIsr request in 387ms correlationId 4 from controller 1 for 16 partitions (state.change.logger)
[2024-04-25 14:44:18,801] INFO [Broker id=2] Add 50 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 5 (state.change.logger)
[2024-04-25 14:44:18,804] INFO [Broker id=1] Leader __consumer_offsets-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,808] INFO [Broker id=0] Leader __consumer_offsets-49 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-25 14:44:18,839] INFO [Broker id=1] Finished LeaderAndIsr request in 428ms correlationId 5 from controller 1 for 17 partitions (state.change.logger)
[2024-04-25 14:44:18,842] INFO [Broker id=1] Add 50 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 6 (state.change.logger)
[2024-04-25 14:44:18,852] INFO [Broker id=0] Finished LeaderAndIsr request in 441ms correlationId 3 from controller 1 for 17 partitions (state.change.logger)
[2024-04-25 14:44:18,855] INFO [Broker id=0] Add 50 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 4 (state.change.logger)
[2024-04-25 15:17:36,891] INFO [Controller id=1 epoch=1] Changed partition topic2-0 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=1, isr=List(0, 2), leaderRecoveryState=RECOVERED, zkVersion=1) (state.change.logger)
[2024-04-25 15:17:36,891] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-04-25 15:17:36,891] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-04-25 15:17:36,891] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-04-25 15:17:36,891] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-04-25 15:17:36,900] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 15:17:36,901] INFO [Controller id=1 epoch=1] Sending StopReplica request for 2 replicas to broker 1 (state.change.logger)
[2024-04-25 15:17:36,903] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 7 from controller 1 for 1 partitions (state.change.logger)
[2024-04-25 15:17:36,903] INFO [Broker id=1] Follower topic2-0 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was 0. (state.change.logger)
[2024-04-25 15:17:36,903] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 6 from controller 1 for 1 partitions (state.change.logger)
[2024-04-25 15:17:36,902] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 5 from controller 1 for 1 partitions (state.change.logger)
[2024-04-25 15:17:36,905] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 1 with correlation id 7 for 1 partitions (state.change.logger)
[2024-04-25 15:17:36,906] INFO [Broker id=2] Follower topic2-0 starts at leader epoch 1 from offset 0 with high watermark 0. Previous leader epoch was 0. (state.change.logger)
[2024-04-25 15:17:36,908] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 1 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-04-25 15:17:36,909] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 1 with correlation id 6 for 1 partitions (state.change.logger)
[2024-04-25 15:17:36,909] INFO [Broker id=0] Leader topic2-0 starts at leader epoch 1 from offset 0 with high watermark 0 ISR [0,2] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2024-04-25 15:17:36,911] INFO [Broker id=1] Finished LeaderAndIsr request in 8ms correlationId 7 from controller 1 for 1 partitions (state.change.logger)
[2024-04-25 15:17:36,913] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 8 (state.change.logger)
[2024-04-25 15:17:36,921] INFO [Broker id=1] Handling StopReplica request correlationId 9 from controller 1 for 2 partitions (state.change.logger)
[2024-04-25 15:17:36,926] INFO [Broker id=2] Finished LeaderAndIsr request in 24ms correlationId 6 from controller 1 for 1 partitions (state.change.logger)
[2024-04-25 15:17:36,928] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 7 (state.change.logger)
[2024-04-25 15:17:36,929] INFO [Controller id=1 epoch=1] Partition topic2-2 state changed to (Leader:2,ISR:2,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:36,929] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 9 epoch 1 for partition topic2-2 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:36,931] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 9 epoch 1 for partition topic2-1 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:36,931] INFO [Controller id=1 epoch=1] Partition topic2-1 state changed to (Leader:0,ISR:0,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:1) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:36,934] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2024-04-25 15:17:36,934] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 1 become-follower partitions (state.change.logger)
[2024-04-25 15:17:36,935] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 2 partitions (state.change.logger)
[2024-04-25 15:17:36,935] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 8 from controller 1 for 2 partitions (state.change.logger)
[2024-04-25 15:17:36,935] INFO [Controller id=1 epoch=1] Sending StopReplica request for 2 replicas to broker 1 (state.change.logger)
[2024-04-25 15:17:36,936] INFO [Broker id=0] Finished LeaderAndIsr request in 34ms correlationId 5 from controller 1 for 1 partitions (state.change.logger)
[2024-04-25 15:17:36,936] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 8 from controller 1 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-04-25 15:17:36,937] INFO [Broker id=2] Leader topic2-2 starts at leader epoch 1 from offset 1 with high watermark 1 ISR [2,0] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2024-04-25 15:17:36,938] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 6 (state.change.logger)
[2024-04-25 15:17:36,940] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 7 from controller 1 for 2 partitions (state.change.logger)
[2024-04-25 15:17:36,941] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 10 (state.change.logger)
[2024-04-25 15:17:36,941] INFO [Broker id=1] Handling StopReplica request correlationId 11 from controller 1 for 2 partitions (state.change.logger)
[2024-04-25 15:17:36,941] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 11 epoch 1 for partition topic2-2 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:36,941] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 7 from controller 1 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-04-25 15:17:36,941] INFO [Broker id=1] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 11 epoch 1 for partition topic2-1 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:36,942] INFO [Broker id=0] Leader topic2-1 starts at leader epoch 1 from offset 1 with high watermark 1 ISR [0,2] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2024-04-25 15:17:36,946] INFO [Broker id=2] Skipped the become-leader state change after marking its partition as leader with correlation id 8 from controller 1 epoch 1 for partition topic2-2 (last update controller epoch 1) since it is already the leader for the partition. (state.change.logger)
[2024-04-25 15:17:36,946] INFO [Broker id=2] Follower topic2-1 starts at leader epoch 1 from offset 1 with high watermark 1. Previous leader epoch was 0. (state.change.logger)
[2024-04-25 15:17:36,948] INFO [Broker id=0] Skipped the become-leader state change after marking its partition as leader with correlation id 7 from controller 1 epoch 1 for partition topic2-1 (last update controller epoch 1) since it is already the leader for the partition. (state.change.logger)
[2024-04-25 15:17:36,948] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 1 with correlation id 8 for 1 partitions (state.change.logger)
[2024-04-25 15:17:36,952] INFO [Broker id=0] Follower topic2-2 starts at leader epoch 1 from offset 1 with high watermark 1. Previous leader epoch was 0. (state.change.logger)
[2024-04-25 15:17:36,955] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 1 epoch 1 with correlation id 7 for 1 partitions (state.change.logger)
[2024-04-25 15:17:36,960] INFO [Broker id=2] Finished LeaderAndIsr request in 25ms correlationId 8 from controller 1 for 2 partitions (state.change.logger)
[2024-04-25 15:17:36,961] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 9 (state.change.logger)
[2024-04-25 15:17:36,962] INFO [Broker id=0] Finished LeaderAndIsr request in 22ms correlationId 7 from controller 1 for 2 partitions (state.change.logger)
[2024-04-25 15:17:36,963] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 8 (state.change.logger)
[2024-04-25 15:17:37,147] INFO [Controller id=2 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 2) for 0 partitions (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Controller id=2 epoch=2] Sending LeaderAndIsr request to broker 0 with 19 become-leader and 1 become-follower partitions (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Controller id=2 epoch=2] Sending LeaderAndIsr request to broker 2 with 17 become-leader and 2 become-follower partitions (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Controller id=2 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 2) for 36 partitions (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 2 for 19 partitions (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 2 for 20 partitions (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition topic2-2 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition topic2-1 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition topic2-0 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-16 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-13 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-46 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-43 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-10 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-22 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-19 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-49 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-31 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-28 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-25 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-7 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-40 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-37 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition topic2-2 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-4 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-1 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-34 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition topic2-1 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition topic2-0 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-47 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-14 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-11 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-44 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-41 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-23 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-20 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=0] Finished LeaderAndIsr request in 0ms correlationId 1 from controller 2 for 20 partitions (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-17 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-32 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-29 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-26 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-8 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-5 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-38 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-35 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 1 epoch 2 for partition __consumer_offsets-2 since its associated leader epoch 0 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,167] INFO [Broker id=2] Finished LeaderAndIsr request in 0ms correlationId 1 from controller 2 for 19 partitions (state.change.logger)
[2024-04-25 15:17:37,176] INFO [Broker id=2] Add 36 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 2 with correlation id 2 (state.change.logger)
[2024-04-25 15:17:37,177] INFO [Broker id=0] Add 36 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 2 with correlation id 2 (state.change.logger)
[2024-04-25 15:17:37,198] INFO [Controller id=2 epoch=2] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,199] INFO [Controller id=2 epoch=2] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,199] INFO [Controller id=2 epoch=2] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,200] INFO [Controller id=2 epoch=2] Partition topic2-1 state changed to (Leader:0,ISR:0,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,200] INFO [Controller id=2 epoch=2] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,200] INFO [Controller id=2 epoch=2] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,200] INFO [Controller id=2 epoch=2] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,200] INFO [Controller id=2 epoch=2] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,201] INFO [Controller id=2 epoch=2] Partition topic2-2 state changed to (Leader:2,ISR:2,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,201] INFO [Controller id=2 epoch=2] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,201] INFO [Controller id=2 epoch=2] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,201] INFO [Controller id=2 epoch=2] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,201] INFO [Controller id=2 epoch=2] Partition topic2-0 state changed to (Leader:0,ISR:0,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,201] INFO [Controller id=2 epoch=2] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,201] INFO [Controller id=2 epoch=2] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,201] INFO [Controller id=2 epoch=2] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,201] INFO [Controller id=2 epoch=2] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,201] INFO [Controller id=2 epoch=2] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,201] INFO [Controller id=2 epoch=2] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,201] INFO [Controller id=2 epoch=2] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:17:37,204] INFO [Controller id=2 epoch=2] Sending LeaderAndIsr request to broker 0 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2024-04-25 15:17:37,204] INFO [Controller id=2 epoch=2] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-04-25 15:17:37,205] INFO [Controller id=2 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 2) for 20 partitions (state.change.logger)
[2024-04-25 15:17:37,205] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 2 for 3 partitions (state.change.logger)
[2024-04-25 15:17:37,205] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 2 for 3 partitions (state.change.logger)
[2024-04-25 15:17:37,205] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 3 epoch 2 for partition topic2-2 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,205] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 3 epoch 2 for partition topic2-1 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,205] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 2 with correlation id 3 epoch 2 for partition topic2-0 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,205] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 3 epoch 2 for partition topic2-2 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,205] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 3 epoch 2 for partition topic2-1 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,205] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 2 with correlation id 3 epoch 2 for partition topic2-0 since its associated leader epoch 1 matches the current leader epoch (state.change.logger)
[2024-04-25 15:17:37,205] INFO [Broker id=2] Finished LeaderAndIsr request in 0ms correlationId 3 from controller 2 for 3 partitions (state.change.logger)
[2024-04-25 15:17:37,205] INFO [Broker id=0] Finished LeaderAndIsr request in 0ms correlationId 3 from controller 2 for 3 partitions (state.change.logger)
[2024-04-25 15:17:37,206] INFO [Broker id=2] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 2 with correlation id 4 (state.change.logger)
[2024-04-25 15:17:37,207] INFO [Broker id=0] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 2 with correlation id 4 (state.change.logger)
[2024-04-25 15:17:37,232] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-25 15:17:37,232] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-25 15:17:37,233] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-25 15:17:37,233] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-25 15:17:37,233] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-25 15:17:37,233] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-25 15:17:37,234] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-25 15:17:37,234] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-25 15:17:37,234] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-25 15:17:37,234] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-25 15:17:37,235] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-25 15:17:37,235] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-25 15:17:37,236] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-25 15:17:37,236] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-25 15:17:37,236] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-25 15:17:37,236] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-25 15:17:37,236] ERROR [Controller id=2 epoch=2] Controller 2 epoch 2 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-25 15:17:37,238] INFO [Controller id=2 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 15:21:36,945] INFO [Controller id=2 epoch=2] Changed partition topic2-2 from OnlinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-25 15:21:36,945] INFO [Controller id=2 epoch=2] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-04-25 15:21:36,946] INFO [Controller id=2 epoch=2] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 1 become-follower partitions (state.change.logger)
[2024-04-25 15:21:36,946] INFO [Controller id=2 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 2) for 1 partitions (state.change.logger)
[2024-04-25 15:21:36,946] INFO [Controller id=2 epoch=2] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-25 15:21:36,949] INFO [Controller id=2 epoch=2] Sending StopReplica request for 2 replicas to broker 2 (state.change.logger)
[2024-04-25 15:21:36,957] INFO [Controller id=2 epoch=2] Partition topic2-1 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:21:36,957] INFO [Controller id=2 epoch=2] Partition topic2-0 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-25 15:21:36,958] INFO [Controller id=2 epoch=2] Sending LeaderAndIsr request to broker 0 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2024-04-25 15:21:36,958] INFO [Controller id=2 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 2) for 2 partitions (state.change.logger)
[2024-04-25 15:21:36,958] INFO [Controller id=2 epoch=2] Sending StopReplica request for 2 replicas to broker 2 (state.change.logger)
[2024-04-29 12:12:55,422] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-04-29 12:12:55,458] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 20 become-follower partitions (state.change.logger)
[2024-04-29 12:12:55,461] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(1) for 20 partitions (state.change.logger)
[2024-04-29 12:12:55,510] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,511] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,511] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,511] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,511] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,512] INFO [Controller id=1 epoch=3] Partition topic2-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,512] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,512] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,512] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,512] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,512] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,512] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,512] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,512] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,513] INFO [Controller id=1 epoch=3] Partition topic2-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,513] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,513] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,513] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,513] INFO [Controller id=1 epoch=3] Partition topic2-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,513] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,539] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,539] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,540] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,540] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,540] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,540] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,540] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,540] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,540] INFO [Controller id=1 epoch=3] Partition topic2-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,540] INFO [Controller id=1 epoch=3] Partition topic2-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,541] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,541] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,541] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,541] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,541] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,541] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,541] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,541] INFO [Controller id=1 epoch=3] Partition topic2-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,541] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-04-29 12:12:55,542] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-04-29 12:12:55,542] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(1) for 36 partitions (state.change.logger)
[2024-04-29 12:12:55,549] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 20 partitions (state.change.logger)
[2024-04-29 12:12:55,611] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-3 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,611] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,613] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,613] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,614] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,614] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,614] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,615] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,615] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,615] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,617] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,617] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,617] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition topic2-0 (last update controller epoch 2) but cannot become follower since the new leader 0 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,617] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,617] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition topic2-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,617] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-18 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,617] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,618] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,618] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-39 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,618] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,618] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,619] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition topic2-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,619] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-9 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,619] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,619] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,619] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition topic2-2 (last update controller epoch 2) but cannot become follower since the new leader 0 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,620] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,620] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-24 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,620] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,620] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,621] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-27 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,621] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,621] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,621] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-42 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,621] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,622] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,622] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-12 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,623] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,623] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,623] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,623] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-33 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,623] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,624] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,624] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-48 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,624] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,624] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition topic2-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,624] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,624] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition topic2-1 (last update controller epoch 2) but cannot become follower since the new leader 0 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,625] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:12:55,625] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-21 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,626] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-36 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,626] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-6 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,627] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-45 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,628] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-15 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,628] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-30 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:12:55,628] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-21 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:12:55,628] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-27 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:12:55,628] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-9 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:12:55,628] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-33 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:12:55,628] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-36 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:12:55,628] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-42 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:12:55,628] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:12:55,628] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-18 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:12:55,628] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-15 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:12:55,628] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-24 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:12:55,628] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-48 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:12:55,628] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-6 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:12:55,628] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:12:55,628] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-39 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:12:55,628] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-12 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:12:55,628] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-45 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:12:55,628] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-30 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,628] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 1 with 17 become-leader and 0 become-follower partitions (state.change.logger)
[2024-04-29 12:12:55,629] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(1) for 17 partitions (state.change.logger)
[2024-04-29 12:12:55,629] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-0 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,632] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 3 with correlation id 1 for 0 partitions (state.change.logger)
[2024-04-29 12:12:55,653] INFO [Broker id=1] Finished LeaderAndIsr request in 103ms correlationId 1 from controller 1 for 20 partitions (state.change.logger)
[2024-04-29 12:12:55,666] INFO [Broker id=1] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 2 (state.change.logger)
[2024-04-29 12:12:55,667] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-04-29 12:12:55,667] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 3 for partition topic2-0 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,668] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 3 for partition topic2-1 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,668] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 3 for partition topic2-2 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:12:55,668] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 3 with correlation id 3 for 0 partitions (state.change.logger)
[2024-04-29 12:12:55,668] INFO [Broker id=1] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-04-29 12:12:55,670] INFO [Broker id=1] Add 36 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 4 (state.change.logger)
[2024-04-29 12:12:55,671] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 5 from controller 1 for 17 partitions (state.change.logger)
[2024-04-29 12:12:55,676] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 1 epoch 3 as part of the become-leader transition for 17 partitions (state.change.logger)
[2024-04-29 12:12:55,681] INFO [Broker id=1] Leader __consumer_offsets-3 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:12:55,685] INFO [Broker id=1] Leader __consumer_offsets-18 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:12:55,688] INFO [Broker id=1] Leader __consumer_offsets-39 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:12:55,690] INFO [Broker id=1] Leader __consumer_offsets-9 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:12:55,692] INFO [Broker id=1] Leader __consumer_offsets-24 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:12:55,693] INFO [Broker id=1] Leader __consumer_offsets-27 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:12:55,695] INFO [Broker id=1] Leader __consumer_offsets-42 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:12:55,697] INFO [Broker id=1] Leader __consumer_offsets-12 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:12:55,699] INFO [Broker id=1] Leader __consumer_offsets-33 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:12:55,700] INFO [Broker id=1] Leader __consumer_offsets-48 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:12:55,702] INFO [Broker id=1] Leader __consumer_offsets-21 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:12:55,705] INFO [Broker id=1] Leader __consumer_offsets-36 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:12:55,706] INFO [Broker id=1] Leader __consumer_offsets-6 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:12:55,708] INFO [Broker id=1] Leader __consumer_offsets-45 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:12:55,710] INFO [Broker id=1] Leader __consumer_offsets-15 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:12:55,712] INFO [Broker id=1] Leader __consumer_offsets-30 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:12:55,713] INFO [Broker id=1] Leader __consumer_offsets-0 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:12:55,739] INFO [Broker id=1] Finished LeaderAndIsr request in 68ms correlationId 5 from controller 1 for 17 partitions (state.change.logger)
[2024-04-29 12:12:55,741] INFO [Broker id=1] Add 17 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 6 (state.change.logger)
[2024-04-29 12:13:31,844] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-04-29 12:13:31,846] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(2) for 53 partitions (state.change.logger)
[2024-04-29 12:13:31,849] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 19 become-follower partitions (state.change.logger)
[2024-04-29 12:13:31,849] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(1, 2) for 19 partitions (state.change.logger)
[2024-04-29 12:13:31,851] INFO [Broker id=1] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 8 (state.change.logger)
[2024-04-29 12:13:31,879] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,880] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,880] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,880] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,880] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,880] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,880] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,880] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,880] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,881] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition topic2-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,881] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,881] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,881] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition topic2-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,881] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,881] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,881] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,881] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,881] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,881] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition topic2-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,881] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-04-29 12:13:31,882] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-35 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:31,882] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-17 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:31,882] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-8 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:31,882] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-41 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:31,882] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-23 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:31,882] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-47 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:31,882] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-38 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:31,882] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-11 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:31,882] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:31,882] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-14 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:31,882] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-20 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:31,882] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-44 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:31,882] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:31,882] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-26 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:31,882] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-29 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:31,882] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-32 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:31,882] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 2 with 16 become-leader and 0 become-follower partitions (state.change.logger)
[2024-04-29 12:13:31,882] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(1, 2) for 16 partitions (state.change.logger)
[2024-04-29 12:13:31,884] INFO [Broker id=1] Add 16 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 9 (state.change.logger)
[2024-04-29 12:13:32,161] INFO [Broker id=2] Add 53 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 0 (state.change.logger)
[2024-04-29 12:13:32,175] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 1 for 19 partitions (state.change.logger)
[2024-04-29 12:13:32,200] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-35 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:32,204] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition topic2-0 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:32,205] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-5 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:32,206] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-20 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:32,206] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-41 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:32,207] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition topic2-2 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:32,207] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-29 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:32,207] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-44 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:32,208] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-14 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:32,208] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-2 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:32,209] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition topic2-1 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:32,209] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-23 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:32,210] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-38 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:32,210] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-8 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:32,211] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-11 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:32,211] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-26 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:32,211] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-47 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:32,212] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-17 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:32,212] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-32 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:32,214] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 3 with correlation id 1 for 0 partitions (state.change.logger)
[2024-04-29 12:13:32,226] INFO [Broker id=2] Finished LeaderAndIsr request in 49ms correlationId 1 from controller 1 for 19 partitions (state.change.logger)
[2024-04-29 12:13:32,231] INFO [Broker id=2] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 2 (state.change.logger)
[2024-04-29 12:13:32,233] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 1 for 16 partitions (state.change.logger)
[2024-04-29 12:13:32,238] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 3 as part of the become-leader transition for 16 partitions (state.change.logger)
[2024-04-29 12:13:32,246] INFO [Broker id=2] Leader __consumer_offsets-35 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:32,252] INFO [Broker id=2] Leader __consumer_offsets-5 starts at leader epoch 2 from offset 1 with high watermark 1 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:32,254] INFO [Broker id=2] Leader __consumer_offsets-20 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:32,257] INFO [Broker id=2] Leader __consumer_offsets-41 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:32,259] INFO [Broker id=2] Leader __consumer_offsets-29 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:32,261] INFO [Broker id=2] Leader __consumer_offsets-44 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:32,263] INFO [Broker id=2] Leader __consumer_offsets-14 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:32,265] INFO [Broker id=2] Leader __consumer_offsets-2 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:32,266] INFO [Broker id=2] Leader __consumer_offsets-23 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:32,268] INFO [Broker id=2] Leader __consumer_offsets-38 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:32,270] INFO [Broker id=2] Leader __consumer_offsets-8 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:32,273] INFO [Broker id=2] Leader __consumer_offsets-11 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:32,276] INFO [Broker id=2] Leader __consumer_offsets-26 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:32,278] INFO [Broker id=2] Leader __consumer_offsets-47 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:32,280] INFO [Broker id=2] Leader __consumer_offsets-17 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:32,282] INFO [Broker id=2] Leader __consumer_offsets-32 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:32,301] INFO [Broker id=2] Finished LeaderAndIsr request in 68ms correlationId 3 from controller 1 for 16 partitions (state.change.logger)
[2024-04-29 12:13:32,303] INFO [Broker id=2] Add 16 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 4 (state.change.logger)
[2024-04-29 12:13:49,028] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(1, 2) for 0 partitions (state.change.logger)
[2024-04-29 12:13:49,030] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(0) for 53 partitions (state.change.logger)
[2024-04-29 12:13:49,031] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 20 become-follower partitions (state.change.logger)
[2024-04-29 12:13:49,032] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 20 partitions (state.change.logger)
[2024-04-29 12:13:49,034] INFO [Broker id=1] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 11 (state.change.logger)
[2024-04-29 12:13:49,035] INFO [Broker id=2] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 6 (state.change.logger)
[2024-04-29 12:13:49,097] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-22 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:49,097] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:49,097] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-25 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:49,097] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-31 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:49,097] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-37 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:49,097] INFO [Controller id=1 epoch=3] Changed partition topic2-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-04-29 12:13:49,098] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-19 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:49,098] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-13 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:49,098] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-43 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:49,098] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:49,098] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-34 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:49,098] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-7 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:49,098] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-46 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:49,098] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-49 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:49,098] INFO [Controller id=1 epoch=3] Changed partition topic2-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-04-29 12:13:49,098] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-16 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:49,098] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-28 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:49,098] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-10 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:49,098] INFO [Controller id=1 epoch=3] Changed partition topic2-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-04-29 12:13:49,098] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-40 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-04-29 12:13:49,098] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 0 with 20 become-leader and 0 become-follower partitions (state.change.logger)
[2024-04-29 12:13:49,098] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-04-29 12:13:49,098] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-04-29 12:13:49,098] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 20 partitions (state.change.logger)
[2024-04-29 12:13:49,099] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 12 from controller 1 for 3 partitions (state.change.logger)
[2024-04-29 12:13:49,100] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 7 from controller 1 for 3 partitions (state.change.logger)
[2024-04-29 12:13:49,103] INFO [Broker id=2] Follower topic2-0 starts at leader epoch 4 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,104] INFO [Broker id=1] Follower topic2-0 starts at leader epoch 4 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,104] INFO [Broker id=2] Follower topic2-1 starts at leader epoch 4 from offset 1 with high watermark 1. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,104] INFO [Broker id=2] Follower topic2-2 starts at leader epoch 4 from offset 1 with high watermark 1. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,104] INFO [Broker id=1] Follower topic2-1 starts at leader epoch 4 from offset 1 with high watermark 1. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,105] INFO [Broker id=1] Follower topic2-2 starts at leader epoch 4 from offset 1 with high watermark 1. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,106] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 3 with correlation id 12 for 3 partitions (state.change.logger)
[2024-04-29 12:13:49,106] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 3 with correlation id 7 for 3 partitions (state.change.logger)
[2024-04-29 12:13:49,144] INFO [Broker id=1] Finished LeaderAndIsr request in 45ms correlationId 12 from controller 1 for 3 partitions (state.change.logger)
[2024-04-29 12:13:49,147] INFO [Broker id=1] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 13 (state.change.logger)
[2024-04-29 12:13:49,161] INFO [Broker id=2] Finished LeaderAndIsr request in 61ms correlationId 7 from controller 1 for 3 partitions (state.change.logger)
[2024-04-29 12:13:49,169] INFO [Broker id=2] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 8 (state.change.logger)
[2024-04-29 12:13:49,461] INFO [Broker id=0] Add 53 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 0 (state.change.logger)
[2024-04-29 12:13:49,484] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 1 for 20 partitions (state.change.logger)
[2024-04-29 12:13:49,538] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition topic2-0 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,547] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-37 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,548] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-7 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,549] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-22 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,549] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition topic2-2 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,550] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-10 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,551] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-31 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,551] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-46 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,551] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-1 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,552] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-16 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,553] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-19 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,554] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-34 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,555] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition topic2-1 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,557] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-4 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,558] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-25 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,559] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-40 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,560] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-43 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,560] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-13 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,560] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-28 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,561] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-49 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-04-29 12:13:49,564] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 1 epoch 3 with correlation id 1 for 0 partitions (state.change.logger)
[2024-04-29 12:13:49,577] INFO [Broker id=0] Finished LeaderAndIsr request in 92ms correlationId 1 from controller 1 for 20 partitions (state.change.logger)
[2024-04-29 12:13:49,582] INFO [Broker id=0] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 2 (state.change.logger)
[2024-04-29 12:13:49,585] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 1 for 20 partitions (state.change.logger)
[2024-04-29 12:13:49,590] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 3 as part of the become-leader transition for 20 partitions (state.change.logger)
[2024-04-29 12:13:49,599] INFO [Broker id=0] Leader topic2-0 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,607] INFO [Broker id=0] Leader __consumer_offsets-37 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,610] INFO [Broker id=0] Leader __consumer_offsets-7 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,613] INFO [Broker id=0] Leader __consumer_offsets-22 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,616] INFO [Broker id=0] Leader topic2-2 starts at leader epoch 4 from offset 1 with high watermark 1 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,618] INFO [Broker id=0] Leader __consumer_offsets-10 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,622] INFO [Broker id=0] Leader __consumer_offsets-31 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,624] INFO [Broker id=0] Leader __consumer_offsets-46 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,627] INFO [Broker id=0] Leader __consumer_offsets-1 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,630] INFO [Broker id=0] Leader __consumer_offsets-16 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,632] INFO [Broker id=0] Leader __consumer_offsets-19 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,634] INFO [Broker id=0] Leader __consumer_offsets-34 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,637] INFO [Broker id=0] Leader topic2-1 starts at leader epoch 4 from offset 1 with high watermark 1 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,640] INFO [Broker id=0] Leader __consumer_offsets-4 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,642] INFO [Broker id=0] Leader __consumer_offsets-25 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,644] INFO [Broker id=0] Leader __consumer_offsets-40 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,646] INFO [Broker id=0] Leader __consumer_offsets-43 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,648] INFO [Broker id=0] Leader __consumer_offsets-13 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,651] INFO [Broker id=0] Leader __consumer_offsets-28 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,653] INFO [Broker id=0] Leader __consumer_offsets-49 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:13:49,686] INFO [Broker id=0] Finished LeaderAndIsr request in 101ms correlationId 3 from controller 1 for 20 partitions (state.change.logger)
[2024-04-29 12:13:49,691] INFO [Broker id=0] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 4 (state.change.logger)
[2024-04-29 12:13:50,607] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-04-29 12:13:50,608] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 14 (state.change.logger)
[2024-04-29 12:13:50,609] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 5 (state.change.logger)
[2024-04-29 12:13:50,609] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 9 (state.change.logger)
[2024-04-29 12:13:50,620] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 2 partitions (state.change.logger)
[2024-04-29 12:13:50,621] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 15 (state.change.logger)
[2024-04-29 12:13:50,622] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 10 (state.change.logger)
[2024-04-29 12:13:50,622] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 6 (state.change.logger)
[2024-04-29 12:13:51,142] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 2 partitions (state.change.logger)
[2024-04-29 12:13:51,144] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 11 (state.change.logger)
[2024-04-29 12:13:51,144] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 16 (state.change.logger)
[2024-04-29 12:13:51,145] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 7 (state.change.logger)
[2024-04-29 12:13:51,151] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-04-29 12:13:51,153] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 8 (state.change.logger)
[2024-04-29 12:13:51,153] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 17 (state.change.logger)
[2024-04-29 12:13:51,155] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 12 (state.change.logger)
[2024-04-29 12:14:21,105] INFO [Controller id=1 epoch=3] Changed partition product-created-events-topics-0 state from NonExistentPartition to NewPartition with assigned replicas 1,2,0 (state.change.logger)
[2024-04-29 12:14:21,105] INFO [Controller id=1 epoch=3] Changed partition product-created-events-topics-1 state from NonExistentPartition to NewPartition with assigned replicas 0,1,2 (state.change.logger)
[2024-04-29 12:14:21,105] INFO [Controller id=1 epoch=3] Changed partition product-created-events-topics-2 state from NonExistentPartition to NewPartition with assigned replicas 2,0,1 (state.change.logger)
[2024-04-29 12:14:21,105] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-29 12:14:21,106] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-29 12:14:21,119] INFO [Controller id=1 epoch=3] Changed partition product-created-events-topics-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1, 2, 0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-29 12:14:21,119] INFO [Controller id=1 epoch=3] Changed partition product-created-events-topics-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 1, 2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-29 12:14:21,119] INFO [Controller id=1 epoch=3] Changed partition product-created-events-topics-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2, 0, 1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-29 12:14:21,119] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-04-29 12:14:21,119] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-04-29 12:14:21,119] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-04-29 12:14:21,119] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 3 partitions (state.change.logger)
[2024-04-29 12:14:21,120] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-29 12:14:21,120] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 18 from controller 1 for 3 partitions (state.change.logger)
[2024-04-29 12:14:21,120] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 13 from controller 1 for 3 partitions (state.change.logger)
[2024-04-29 12:14:21,120] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 9 from controller 1 for 3 partitions (state.change.logger)
[2024-04-29 12:14:21,124] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 18 from controller 1 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-04-29 12:14:21,124] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 9 from controller 1 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-04-29 12:14:21,124] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 13 from controller 1 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-04-29 12:14:21,147] INFO [Broker id=2] Leader product-created-events-topics-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2,0,1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:14:21,149] INFO [Broker id=0] Leader product-created-events-topics-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,1,2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:14:21,152] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1,2,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:14:21,167] INFO [Broker id=2] Follower product-created-events-topics-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:14:21,170] INFO [Broker id=0] Follower product-created-events-topics-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:14:21,172] INFO [Broker id=1] Follower product-created-events-topics-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:14:21,183] INFO [Broker id=2] Follower product-created-events-topics-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:14:21,184] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 3 with correlation id 13 for 2 partitions (state.change.logger)
[2024-04-29 12:14:21,186] INFO [Broker id=0] Follower product-created-events-topics-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:14:21,186] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 1 epoch 3 with correlation id 9 for 2 partitions (state.change.logger)
[2024-04-29 12:14:21,192] INFO [Broker id=1] Follower product-created-events-topics-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 12:14:21,194] INFO [Broker id=2] Finished LeaderAndIsr request in 73ms correlationId 13 from controller 1 for 3 partitions (state.change.logger)
[2024-04-29 12:14:21,194] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 3 with correlation id 18 for 2 partitions (state.change.logger)
[2024-04-29 12:14:21,196] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 14 (state.change.logger)
[2024-04-29 12:14:21,205] INFO [Broker id=1] Finished LeaderAndIsr request in 85ms correlationId 18 from controller 1 for 3 partitions (state.change.logger)
[2024-04-29 12:14:21,206] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 19 (state.change.logger)
[2024-04-29 12:14:21,246] INFO [Broker id=0] Finished LeaderAndIsr request in 126ms correlationId 9 from controller 1 for 3 partitions (state.change.logger)
[2024-04-29 12:14:21,252] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 10 (state.change.logger)
[2024-04-29 13:04:48,419] INFO [Controller id=1 epoch=3] Changed partition product-created-events-topic-0 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-29 13:04:48,421] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-29 13:04:48,421] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-29 13:04:48,431] INFO [Controller id=1 epoch=3] Changed partition product-created-events-topic-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-29 13:04:48,431] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-04-29 13:04:48,431] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-04-29 13:04:48,431] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-29 13:04:48,441] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 11 from controller 1 for 1 partitions (state.change.logger)
[2024-04-29 13:04:48,447] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 20 (state.change.logger)
[2024-04-29 13:04:48,445] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 15 (state.change.logger)
[2024-04-29 13:04:48,451] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 11 from controller 1 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-04-29 13:04:48,467] INFO [Broker id=0] Leader product-created-events-topic-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 13:04:48,470] INFO [Broker id=0] Finished LeaderAndIsr request in 29ms correlationId 11 from controller 1 for 1 partitions (state.change.logger)
[2024-04-29 13:04:48,471] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 12 (state.change.logger)
[2024-04-29 13:11:08,053] INFO [Controller id=1 epoch=3] Changed partition product-created-evnets-topic-0 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-04-29 13:11:08,053] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-29 13:11:08,053] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-29 13:11:08,058] INFO [Controller id=1 epoch=3] Changed partition product-created-evnets-topic-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-29 13:11:08,058] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-04-29 13:11:08,059] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-04-29 13:11:08,059] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-29 13:11:08,059] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 13 from controller 1 for 1 partitions (state.change.logger)
[2024-04-29 13:11:08,059] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 21 (state.change.logger)
[2024-04-29 13:11:08,059] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 16 (state.change.logger)
[2024-04-29 13:11:08,061] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 13 from controller 1 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-04-29 13:11:08,070] INFO [Broker id=0] Leader product-created-evnets-topic-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 13:11:08,073] INFO [Broker id=0] Finished LeaderAndIsr request in 14ms correlationId 13 from controller 1 for 1 partitions (state.change.logger)
[2024-04-29 13:11:08,074] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 14 (state.change.logger)
[2024-04-29 13:24:37,881] INFO [Controller id=1 epoch=3] Changed partition product-created-evnets-topics-0 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-04-29 13:24:37,881] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-29 13:24:37,881] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-29 13:24:37,887] INFO [Controller id=1 epoch=3] Changed partition product-created-evnets-topics-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-04-29 13:24:37,887] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-04-29 13:24:37,887] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-04-29 13:24:37,887] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-04-29 13:24:37,890] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 22 (state.change.logger)
[2024-04-29 13:24:37,890] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 17 from controller 1 for 1 partitions (state.change.logger)
[2024-04-29 13:24:37,891] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 15 (state.change.logger)
[2024-04-29 13:24:37,892] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 17 from controller 1 epoch 3 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-04-29 13:24:37,905] INFO [Broker id=2] Leader product-created-evnets-topics-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-04-29 13:24:37,908] INFO [Broker id=2] Finished LeaderAndIsr request in 18ms correlationId 17 from controller 1 for 1 partitions (state.change.logger)
[2024-04-29 13:24:37,910] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 18 (state.change.logger)
[2024-05-03 15:22:29,949] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-05-03 15:22:29,992] INFO [Controller id=1 epoch=4] Sending LeaderAndIsr request to broker 1 with 18 become-leader and 5 become-follower partitions (state.change.logger)
[2024-05-03 15:22:29,996] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet(1) for 23 partitions (state.change.logger)
[2024-05-03 15:22:30,069] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,070] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,070] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,070] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,070] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,070] INFO [Controller id=1 epoch=4] Partition product-created-events-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,070] INFO [Controller id=1 epoch=4] Partition topic2-1 state changed to (Leader:-1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:7,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,070] INFO [Controller id=1 epoch=4] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,070] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,070] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,070] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,070] INFO [Controller id=1 epoch=4] Partition product-created-events-topics-1 state changed to (Leader:-1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,070] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,070] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,070] INFO [Controller id=1 epoch=4] Partition product-created-evnets-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,071] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,071] INFO [Controller id=1 epoch=4] Partition product-created-events-topics-2 state changed to (Leader:2,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,071] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,071] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,071] INFO [Controller id=1 epoch=4] Partition topic2-0 state changed to (Leader:-1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:7,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,071] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,071] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,071] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,071] INFO [Controller id=1 epoch=4] Partition topic2-2 state changed to (Leader:-1,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:7,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,071] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,089] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 23 partitions (state.change.logger)
[2024-05-03 15:22:30,105] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,105] INFO [Controller id=1 epoch=4] Partition product-created-events-topics-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,106] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,106] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,106] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,106] INFO [Controller id=1 epoch=4] Partition product-created-evnets-topics-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,106] INFO [Controller id=1 epoch=4] Partition product-created-events-topics-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,106] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,106] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,106] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,106] INFO [Controller id=1 epoch=4] Partition topic2-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,106] INFO [Controller id=1 epoch=4] Partition topic2-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,106] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,107] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,107] INFO [Controller id=1 epoch=4] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,107] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,107] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,107] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,107] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,107] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,107] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,107] INFO [Controller id=1 epoch=4] Partition topic2-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:8,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,107] INFO [Controller id=1 epoch=4] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:4) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:22:30,107] INFO [Controller id=1 epoch=4] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 5 become-follower partitions (state.change.logger)
[2024-05-03 15:22:30,107] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet(1) for 42 partitions (state.change.logger)
[2024-05-03 15:22:30,151] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 1 epoch 4 as part of the become-leader transition for 18 partitions (state.change.logger)
[2024-05-03 15:22:30,169] INFO [Broker id=1] Leader __consumer_offsets-3 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,170] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,173] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,173] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,173] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,174] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,174] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition product-created-events-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,175] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,175] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition product-created-evnets-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-evnets-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,175] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,177] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,177] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,177] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,177] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,177] INFO [Broker id=1] Leader __consumer_offsets-18 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,177] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,177] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,178] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,178] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,178] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,179] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,181] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,182] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,185] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition product-created-evnets-topics-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-evnets-topics-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,191] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,191] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,194] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,196] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,198] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,199] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,199] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,201] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,201] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,201] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,201] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,201] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,201] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,201] ERROR [Controller id=1 epoch=4] Controller 1 epoch 4 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:22:30,206] INFO [Controller id=1 epoch=4] Changed partition product-created-events-topics-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=3, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=3) (state.change.logger)
[2024-05-03 15:22:30,206] INFO [Controller id=1 epoch=4] Changed partition product-created-events-topics-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=3, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=3) (state.change.logger)
[2024-05-03 15:22:30,206] INFO [Controller id=1 epoch=4] Changed partition topic2-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-05-03 15:22:30,206] INFO [Controller id=1 epoch=4] Changed partition topic2-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-05-03 15:22:30,206] INFO [Controller id=1 epoch=4] Changed partition topic2-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-05-03 15:22:30,206] INFO [Controller id=1 epoch=4] Sending LeaderAndIsr request to broker 1 with 5 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-03 15:22:30,208] INFO [Controller id=1 epoch=4] Sending UpdateMetadata request to brokers HashSet(1) for 5 partitions (state.change.logger)
[2024-05-03 15:22:30,187] INFO [Broker id=1] Leader __consumer_offsets-39 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,217] INFO [Broker id=1] Leader __consumer_offsets-9 starts at leader epoch 2 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,218] INFO [Broker id=1] Leader __consumer_offsets-24 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,231] INFO [Broker id=1] Leader __consumer_offsets-27 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,235] INFO [Broker id=1] Leader __consumer_offsets-42 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,237] INFO [Broker id=1] Leader __consumer_offsets-12 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,243] INFO [Broker id=1] Leader __consumer_offsets-33 starts at leader epoch 2 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,245] INFO [Broker id=1] Leader __consumer_offsets-48 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,248] INFO [Broker id=1] Leader __consumer_offsets-21 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,250] INFO [Broker id=1] Leader __consumer_offsets-36 starts at leader epoch 2 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,251] INFO [Broker id=1] Leader __consumer_offsets-6 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,255] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 0 from offset 7 with high watermark 7 ISR [1,2,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,258] INFO [Broker id=1] Leader __consumer_offsets-45 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,262] INFO [Broker id=1] Leader __consumer_offsets-15 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,266] INFO [Broker id=1] Leader __consumer_offsets-30 starts at leader epoch 2 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,267] INFO [Broker id=1] Leader __consumer_offsets-0 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,272] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 4 for partition topic2-0 (last update controller epoch 3) but cannot become follower since the new leader 0 is unavailable. (state.change.logger)
[2024-05-03 15:22:30,273] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 4 for partition topic2-1 (last update controller epoch 3) but cannot become follower since the new leader 0 is unavailable. (state.change.logger)
[2024-05-03 15:22:30,273] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 4 for partition topic2-2 (last update controller epoch 3) but cannot become follower since the new leader 0 is unavailable. (state.change.logger)
[2024-05-03 15:22:30,275] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 4 for partition product-created-events-topics-1 (last update controller epoch 3) but cannot become follower since the new leader 0 is unavailable. (state.change.logger)
[2024-05-03 15:22:30,276] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 4 for partition product-created-events-topics-2 (last update controller epoch 3) but cannot become follower since the new leader 2 is unavailable. (state.change.logger)
[2024-05-03 15:22:30,278] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 4 with correlation id 1 for 0 partitions (state.change.logger)
[2024-05-03 15:22:30,318] INFO [Broker id=1] Finished LeaderAndIsr request in 227ms correlationId 1 from controller 1 for 23 partitions (state.change.logger)
[2024-05-03 15:22:30,330] INFO [Broker id=1] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 4 with correlation id 2 (state.change.logger)
[2024-05-03 15:22:30,334] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 6 partitions (state.change.logger)
[2024-05-03 15:22:30,334] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 4 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-05-03 15:22:30,335] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 2 from offset 7 with high watermark 7 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2024-05-03 15:22:30,339] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 1 epoch 4 for partition product-created-events-topics-0 (last update controller epoch 4) since it is already the leader for the partition. (state.change.logger)
[2024-05-03 15:22:30,340] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 4 for partition topic2-0 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-03 15:22:30,340] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 4 for partition topic2-1 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-03 15:22:30,340] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 4 for partition topic2-2 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-03 15:22:30,340] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 4 for partition product-created-events-topics-1 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-03 15:22:30,340] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 4 for partition product-created-events-topics-2 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-03 15:22:30,340] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 4 with correlation id 3 for 0 partitions (state.change.logger)
[2024-05-03 15:22:30,340] INFO [Broker id=1] Finished LeaderAndIsr request in 6ms correlationId 3 from controller 1 for 6 partitions (state.change.logger)
[2024-05-03 15:22:30,345] INFO [Broker id=1] Add 42 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 4 with correlation id 4 (state.change.logger)
[2024-05-03 15:22:30,347] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 5 from controller 1 for 5 partitions (state.change.logger)
[2024-05-03 15:22:30,347] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 1 epoch 4 as part of the become-leader transition for 5 partitions (state.change.logger)
[2024-05-03 15:22:30,348] INFO [Broker id=1] Leader topic2-0 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,351] INFO [Broker id=1] Leader topic2-1 starts at leader epoch 7 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,352] INFO [Broker id=1] Leader topic2-2 starts at leader epoch 7 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,356] INFO [Broker id=1] Leader product-created-events-topics-1 starts at leader epoch 3 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,358] INFO [Broker id=1] Leader product-created-events-topics-2 starts at leader epoch 3 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:22:30,362] INFO [Broker id=1] Finished LeaderAndIsr request in 15ms correlationId 5 from controller 1 for 5 partitions (state.change.logger)
[2024-05-03 15:22:30,363] INFO [Broker id=1] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 4 with correlation id 6 (state.change.logger)
[2024-05-03 15:37:42,481] INFO [Controller id=1 epoch=5] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-05-03 15:37:42,521] INFO [Controller id=1 epoch=5] Sending LeaderAndIsr request to broker 1 with 23 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-03 15:37:42,525] INFO [Controller id=1 epoch=5] Sending UpdateMetadata request to brokers HashSet(1) for 23 partitions (state.change.logger)
[2024-05-03 15:37:42,572] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,573] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,573] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,573] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,573] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,573] INFO [Controller id=1 epoch=5] Partition product-created-events-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,573] INFO [Controller id=1 epoch=5] Partition topic2-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,574] INFO [Controller id=1 epoch=5] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,574] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,575] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,575] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,575] INFO [Controller id=1 epoch=5] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,575] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,575] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,576] INFO [Controller id=1 epoch=5] Partition product-created-evnets-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,576] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,576] INFO [Controller id=1 epoch=5] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,576] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,576] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,576] INFO [Controller id=1 epoch=5] Partition topic2-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,576] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,577] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,577] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,577] INFO [Controller id=1 epoch=5] Partition topic2-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,577] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,591] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 23 partitions (state.change.logger)
[2024-05-03 15:37:42,605] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,605] INFO [Controller id=1 epoch=5] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,606] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,606] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,606] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,606] INFO [Controller id=1 epoch=5] Partition product-created-evnets-topics-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,606] INFO [Controller id=1 epoch=5] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,606] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,606] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,606] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,606] INFO [Controller id=1 epoch=5] Partition topic2-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,606] INFO [Controller id=1 epoch=5] Partition topic2-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,607] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,607] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,607] INFO [Controller id=1 epoch=5] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,607] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,607] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,607] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,607] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,607] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,607] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,607] INFO [Controller id=1 epoch=5] Partition topic2-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,607] INFO [Controller id=1 epoch=5] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:37:42,608] INFO [Controller id=1 epoch=5] Sending LeaderAndIsr request to broker 1 with 6 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-03 15:37:42,608] INFO [Controller id=1 epoch=5] Sending UpdateMetadata request to brokers HashSet(1) for 42 partitions (state.change.logger)
[2024-05-03 15:37:42,650] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 1 epoch 5 as part of the become-leader transition for 23 partitions (state.change.logger)
[2024-05-03 15:37:42,662] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,665] INFO [Broker id=1] Leader __consumer_offsets-3 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,665] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,666] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,666] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,666] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,667] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition product-created-events-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,667] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,668] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,668] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition product-created-evnets-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-evnets-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,669] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,669] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,670] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,670] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,670] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,670] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,670] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,671] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,671] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,671] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,672] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,672] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,672] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition product-created-evnets-topics-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-evnets-topics-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,672] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,673] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,673] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,673] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,674] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,674] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,674] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,674] INFO [Broker id=1] Leader topic2-0 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,675] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,675] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,675] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,676] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,676] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,676] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,677] ERROR [Controller id=1 epoch=5] Controller 1 epoch 5 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:37:42,678] INFO [Controller id=1 epoch=5] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-03 15:37:42,678] INFO [Broker id=1] Leader __consumer_offsets-18 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,682] INFO [Broker id=1] Leader __consumer_offsets-39 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,686] INFO [Broker id=1] Leader __consumer_offsets-9 starts at leader epoch 2 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,687] INFO [Broker id=1] Leader topic2-2 starts at leader epoch 7 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,691] INFO [Broker id=1] Leader __consumer_offsets-24 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,694] INFO [Broker id=1] Leader __consumer_offsets-27 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,698] INFO [Broker id=1] Leader product-created-events-topics-1 starts at leader epoch 3 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,701] INFO [Broker id=1] Leader __consumer_offsets-42 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,704] INFO [Broker id=1] Leader __consumer_offsets-12 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,708] INFO [Broker id=1] Leader __consumer_offsets-33 starts at leader epoch 2 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,710] INFO [Broker id=1] Leader __consumer_offsets-48 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,713] INFO [Broker id=1] Leader topic2-1 starts at leader epoch 7 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,716] INFO [Broker id=1] Leader __consumer_offsets-21 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,719] INFO [Broker id=1] Leader __consumer_offsets-36 starts at leader epoch 2 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,720] INFO [Broker id=1] Leader __consumer_offsets-6 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,723] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 2 from offset 7 with high watermark 7 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,726] INFO [Broker id=1] Leader __consumer_offsets-45 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,728] INFO [Broker id=1] Leader product-created-events-topics-2 starts at leader epoch 3 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,730] INFO [Broker id=1] Leader __consumer_offsets-15 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,732] INFO [Broker id=1] Leader __consumer_offsets-30 starts at leader epoch 2 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,732] INFO [Broker id=1] Leader __consumer_offsets-0 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:37:42,765] INFO [Broker id=1] Finished LeaderAndIsr request in 177ms correlationId 1 from controller 1 for 23 partitions (state.change.logger)
[2024-05-03 15:37:42,780] INFO [Broker id=1] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 5 with correlation id 2 (state.change.logger)
[2024-05-03 15:37:42,782] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 6 partitions (state.change.logger)
[2024-05-03 15:37:42,784] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 5 for partition topic2-2 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2024-05-03 15:37:42,784] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 5 for partition topic2-1 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2024-05-03 15:37:42,784] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 5 for partition topic2-0 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2024-05-03 15:37:42,784] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 5 for partition product-created-events-topics-1 since its associated leader epoch 3 matches the current leader epoch (state.change.logger)
[2024-05-03 15:37:42,784] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 5 for partition product-created-events-topics-2 since its associated leader epoch 3 matches the current leader epoch (state.change.logger)
[2024-05-03 15:37:42,784] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 5 for partition product-created-events-topics-0 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2024-05-03 15:37:42,785] INFO [Broker id=1] Finished LeaderAndIsr request in 3ms correlationId 3 from controller 1 for 6 partitions (state.change.logger)
[2024-05-03 15:37:42,787] INFO [Broker id=1] Add 42 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 5 with correlation id 4 (state.change.logger)
[2024-05-03 15:38:04,615] INFO [Controller id=1 epoch=5] Changed partition insync-topic-0 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-03 15:38:04,615] INFO [Controller id=1 epoch=5] Changed partition insync-topic-1 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-03 15:38:04,615] INFO [Controller id=1 epoch=5] Changed partition insync-topic-2 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-03 15:38:04,615] INFO [Controller id=1 epoch=5] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-03 15:38:04,616] INFO [Controller id=1 epoch=5] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-03 15:38:04,625] INFO [Controller id=1 epoch=5] Changed partition insync-topic-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-03 15:38:04,625] INFO [Controller id=1 epoch=5] Changed partition insync-topic-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-03 15:38:04,625] INFO [Controller id=1 epoch=5] Changed partition insync-topic-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-03 15:38:04,626] INFO [Controller id=1 epoch=5] Sending LeaderAndIsr request to broker 1 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-03 15:38:04,626] INFO [Controller id=1 epoch=5] Sending UpdateMetadata request to brokers HashSet(1) for 3 partitions (state.change.logger)
[2024-05-03 15:38:04,626] INFO [Controller id=1 epoch=5] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-03 15:38:04,627] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 5 from controller 1 for 3 partitions (state.change.logger)
[2024-05-03 15:38:04,628] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 1 epoch 5 as part of the become-leader transition for 3 partitions (state.change.logger)
[2024-05-03 15:38:04,641] INFO [Broker id=1] Leader insync-topic-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:38:04,649] INFO [Broker id=1] Leader insync-topic-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:38:04,658] INFO [Broker id=1] Leader insync-topic-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:38:04,660] INFO [Broker id=1] Finished LeaderAndIsr request in 33ms correlationId 5 from controller 1 for 3 partitions (state.change.logger)
[2024-05-03 15:38:04,661] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 5 with correlation id 6 (state.change.logger)
[2024-05-03 15:45:04,691] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-05-03 15:45:04,727] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 1 with 26 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-03 15:45:04,731] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1) for 26 partitions (state.change.logger)
[2024-05-03 15:45:04,790] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,790] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,790] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,791] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,791] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,791] INFO [Controller id=1 epoch=6] Partition product-created-events-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,791] INFO [Controller id=1 epoch=6] Partition topic2-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,791] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,791] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,791] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,791] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,791] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,792] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,792] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,792] INFO [Controller id=1 epoch=6] Partition product-created-evnets-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,792] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,792] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,792] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,792] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,792] INFO [Controller id=1 epoch=6] Partition topic2-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,792] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,793] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,793] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,793] INFO [Controller id=1 epoch=6] Partition topic2-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,793] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,799] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 26 partitions (state.change.logger)
[2024-05-03 15:45:04,811] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,811] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,811] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,811] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,811] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,811] INFO [Controller id=1 epoch=6] Partition product-created-evnets-topics-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,811] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,812] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,812] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,812] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,812] INFO [Controller id=1 epoch=6] Partition topic2-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,812] INFO [Controller id=1 epoch=6] Partition topic2-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,812] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,812] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,812] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,812] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,813] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,813] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,813] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,813] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,813] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,813] INFO [Controller id=1 epoch=6] Partition topic2-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,813] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-03 15:45:04,813] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 1 with 6 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-03 15:45:04,813] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1) for 42 partitions (state.change.logger)
[2024-05-03 15:45:04,852] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 1 epoch 6 as part of the become-leader transition for 26 partitions (state.change.logger)
[2024-05-03 15:45:04,856] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,857] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,858] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,858] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,858] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,859] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition product-created-events-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,859] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,859] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,859] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition product-created-evnets-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-evnets-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,859] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,860] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,860] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,860] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,860] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,860] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,861] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,861] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,861] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,861] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,862] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,862] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,862] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition product-created-evnets-topics-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-evnets-topics-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,862] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,863] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,863] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,863] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,863] INFO [Broker id=1] Leader __consumer_offsets-3 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,863] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,864] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,864] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,864] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,864] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,865] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,865] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,865] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,865] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,865] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:45:04,866] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-03 15:45:04,873] INFO [Broker id=1] Leader topic2-0 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,877] INFO [Broker id=1] Leader __consumer_offsets-18 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,880] INFO [Broker id=1] Leader insync-topic-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,883] INFO [Broker id=1] Leader __consumer_offsets-33 starts at leader epoch 2 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,884] INFO [Broker id=1] Leader __consumer_offsets-48 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,888] INFO [Broker id=1] Leader topic2-1 starts at leader epoch 7 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,892] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 2 from offset 7 with high watermark 7 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,894] INFO [Broker id=1] Leader __consumer_offsets-45 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,897] INFO [Broker id=1] Leader __consumer_offsets-15 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,900] INFO [Broker id=1] Leader __consumer_offsets-30 starts at leader epoch 2 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,901] INFO [Broker id=1] Leader __consumer_offsets-0 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,904] INFO [Broker id=1] Leader insync-topic-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,908] INFO [Broker id=1] Leader __consumer_offsets-39 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,910] INFO [Broker id=1] Leader __consumer_offsets-9 starts at leader epoch 2 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,911] INFO [Broker id=1] Leader topic2-2 starts at leader epoch 7 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,914] INFO [Broker id=1] Leader __consumer_offsets-24 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,916] INFO [Broker id=1] Leader __consumer_offsets-27 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,919] INFO [Broker id=1] Leader product-created-events-topics-1 starts at leader epoch 3 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,923] INFO [Broker id=1] Leader __consumer_offsets-42 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,925] INFO [Broker id=1] Leader __consumer_offsets-12 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,928] INFO [Broker id=1] Leader insync-topic-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,930] INFO [Broker id=1] Leader __consumer_offsets-21 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,932] INFO [Broker id=1] Leader __consumer_offsets-36 starts at leader epoch 2 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,933] INFO [Broker id=1] Leader __consumer_offsets-6 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,935] INFO [Broker id=1] Leader product-created-events-topics-2 starts at leader epoch 3 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-03 15:45:04,967] INFO [Broker id=1] Finished LeaderAndIsr request in 169ms correlationId 1 from controller 1 for 26 partitions (state.change.logger)
[2024-05-03 15:45:04,980] INFO [Broker id=1] Add 26 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 2 (state.change.logger)
[2024-05-03 15:45:04,981] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 6 partitions (state.change.logger)
[2024-05-03 15:45:04,983] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 6 for partition topic2-2 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2024-05-03 15:45:04,983] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 6 for partition topic2-1 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2024-05-03 15:45:04,983] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 6 for partition topic2-0 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2024-05-03 15:45:04,983] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 6 for partition product-created-events-topics-1 since its associated leader epoch 3 matches the current leader epoch (state.change.logger)
[2024-05-03 15:45:04,983] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 6 for partition product-created-events-topics-2 since its associated leader epoch 3 matches the current leader epoch (state.change.logger)
[2024-05-03 15:45:04,983] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 6 for partition product-created-events-topics-0 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2024-05-03 15:45:04,983] INFO [Broker id=1] Finished LeaderAndIsr request in 2ms correlationId 3 from controller 1 for 6 partitions (state.change.logger)
[2024-05-03 15:45:04,986] INFO [Broker id=1] Add 42 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 4 (state.change.logger)
[2024-05-03 15:47:26,649] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition product-created-events-topics-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:47:26,650] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition topic2-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:47:26,654] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition topic2-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:47:26,654] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition product-created-events-topics-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:47:26,654] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition product-created-events-topics-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:47:26,654] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition topic2-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:47:26,655] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-03 15:47:26,656] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-03 15:47:31,691] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition product-created-events-topics-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:47:31,692] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition topic2-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:47:31,692] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition topic2-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:47:31,692] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition product-created-events-topics-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:47:31,692] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition product-created-events-topics-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:47:31,692] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition topic2-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:47:31,692] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-03 15:47:31,692] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-03 15:47:36,699] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition product-created-events-topics-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:47:36,699] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition topic2-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:47:36,699] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition topic2-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:47:36,699] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition product-created-events-topics-0 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-0 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:47:36,699] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition product-created-events-topics-1 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-1 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:47:36,699] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition topic2-2 from OnlinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-2 under strategy ControlledShutdownPartitionLeaderElectionStrategy
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.KafkaController.doControlledShutdown(KafkaController.scala:1352)
	at kafka.controller.KafkaController.$anonfun$processControlledShutdown$1(KafkaController.scala:1314)
	at scala.util.Try$.apply(Try.scala:210)
	at kafka.controller.KafkaController.processControlledShutdown(KafkaController.scala:1314)
	at kafka.controller.KafkaController.process(KafkaController.scala:2524)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-03 15:47:36,699] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-03 15:47:36,699] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-13 15:21:41,663] INFO [Controller id=1 epoch=7] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-05-13 15:21:41,721] INFO [Controller id=1 epoch=7] Sending LeaderAndIsr request to broker 1 with 26 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-13 15:21:41,725] INFO [Controller id=1 epoch=7] Sending UpdateMetadata request to brokers HashSet(1) for 26 partitions (state.change.logger)
[2024-05-13 15:21:41,791] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,792] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,792] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,792] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,792] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,792] INFO [Controller id=1 epoch=7] Partition product-created-events-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,792] INFO [Controller id=1 epoch=7] Partition topic2-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,793] INFO [Controller id=1 epoch=7] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,795] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,795] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,795] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,795] INFO [Controller id=1 epoch=7] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,796] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,796] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,796] INFO [Controller id=1 epoch=7] Partition product-created-evnets-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,796] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,796] INFO [Controller id=1 epoch=7] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,796] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,797] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,797] INFO [Controller id=1 epoch=7] Partition topic2-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,797] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,797] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,797] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,797] INFO [Controller id=1 epoch=7] Partition topic2-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,798] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,800] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 26 partitions (state.change.logger)
[2024-05-13 15:21:41,834] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,834] INFO [Controller id=1 epoch=7] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,835] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,835] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,835] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,835] INFO [Controller id=1 epoch=7] Partition product-created-evnets-topics-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,835] INFO [Controller id=1 epoch=7] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,835] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,835] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,836] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,836] INFO [Controller id=1 epoch=7] Partition topic2-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,836] INFO [Controller id=1 epoch=7] Partition topic2-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,836] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,836] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,836] INFO [Controller id=1 epoch=7] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,836] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,837] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,837] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,837] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,837] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,837] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,837] INFO [Controller id=1 epoch=7] Partition topic2-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,837] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:21:41,837] INFO [Controller id=1 epoch=7] Sending LeaderAndIsr request to broker 1 with 6 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-13 15:21:41,838] INFO [Controller id=1 epoch=7] Sending UpdateMetadata request to brokers HashSet(1) for 42 partitions (state.change.logger)
[2024-05-13 15:21:41,885] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 1 epoch 7 as part of the become-leader transition for 26 partitions (state.change.logger)
[2024-05-13 15:21:41,907] INFO [Broker id=1] Leader __consumer_offsets-3 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:41,913] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,917] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,916] INFO [Broker id=1] Leader topic2-0 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:41,920] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,921] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,922] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,923] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition product-created-events-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,923] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,924] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,924] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition product-created-evnets-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-evnets-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,925] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,925] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,926] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,926] INFO [Broker id=1] Leader __consumer_offsets-18 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:41,926] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,926] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,926] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,927] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,928] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,930] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,930] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,931] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,931] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,931] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition product-created-evnets-topics-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-evnets-topics-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,931] INFO [Broker id=1] Leader insync-topic-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:41,931] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,932] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,933] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,933] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,935] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,936] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,936] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,937] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,938] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,938] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,938] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,939] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,939] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,939] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:21:41,939] INFO [Broker id=1] Leader __consumer_offsets-33 starts at leader epoch 2 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:41,941] INFO [Broker id=1] Leader __consumer_offsets-48 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:41,942] INFO [Controller id=1 epoch=7] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-13 15:21:41,943] INFO [Broker id=1] Leader topic2-1 starts at leader epoch 7 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:41,948] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 2 from offset 7 with high watermark 7 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:41,954] INFO [Broker id=1] Leader __consumer_offsets-45 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:41,959] INFO [Broker id=1] Leader __consumer_offsets-15 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:41,965] INFO [Broker id=1] Leader __consumer_offsets-30 starts at leader epoch 2 from offset 2 with high watermark 2 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:41,966] INFO [Broker id=1] Leader __consumer_offsets-0 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:41,973] INFO [Broker id=1] Leader insync-topic-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:41,980] INFO [Broker id=1] Leader __consumer_offsets-39 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:41,986] INFO [Broker id=1] Leader __consumer_offsets-9 starts at leader epoch 2 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:41,988] INFO [Broker id=1] Leader topic2-2 starts at leader epoch 7 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:41,993] INFO [Broker id=1] Leader __consumer_offsets-24 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:41,997] INFO [Broker id=1] Leader __consumer_offsets-27 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:42,001] INFO [Broker id=1] Leader product-created-events-topics-1 starts at leader epoch 3 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:42,006] INFO [Broker id=1] Leader __consumer_offsets-42 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:42,010] INFO [Broker id=1] Leader __consumer_offsets-12 starts at leader epoch 2 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:42,011] INFO [Broker id=1] Leader insync-topic-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:42,015] INFO [Broker id=1] Leader __consumer_offsets-21 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:42,019] INFO [Broker id=1] Leader __consumer_offsets-36 starts at leader epoch 2 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:42,021] INFO [Broker id=1] Leader __consumer_offsets-6 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:42,024] INFO [Broker id=1] Leader product-created-events-topics-2 starts at leader epoch 3 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:21:42,066] INFO [Broker id=1] Finished LeaderAndIsr request in 267ms correlationId 1 from controller 1 for 26 partitions (state.change.logger)
[2024-05-13 15:21:42,083] INFO [Broker id=1] Add 26 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 7 with correlation id 2 (state.change.logger)
[2024-05-13 15:21:42,087] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 6 partitions (state.change.logger)
[2024-05-13 15:21:42,089] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 7 for partition topic2-2 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2024-05-13 15:21:42,089] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 7 for partition topic2-1 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2024-05-13 15:21:42,089] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 7 for partition topic2-0 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2024-05-13 15:21:42,089] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 7 for partition product-created-events-topics-1 since its associated leader epoch 3 matches the current leader epoch (state.change.logger)
[2024-05-13 15:21:42,089] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 7 for partition product-created-events-topics-2 since its associated leader epoch 3 matches the current leader epoch (state.change.logger)
[2024-05-13 15:21:42,089] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 3 epoch 7 for partition product-created-events-topics-0 since its associated leader epoch 2 matches the current leader epoch (state.change.logger)
[2024-05-13 15:21:42,089] INFO [Broker id=1] Finished LeaderAndIsr request in 2ms correlationId 3 from controller 1 for 6 partitions (state.change.logger)
[2024-05-13 15:21:42,092] INFO [Broker id=1] Add 42 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 7 with correlation id 4 (state.change.logger)
[2024-05-13 15:22:24,502] INFO [Controller id=2 epoch=8] Sending UpdateMetadata request to brokers HashSet(2) for 0 partitions (state.change.logger)
[2024-05-13 15:22:24,545] INFO [Controller id=2 epoch=8] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 23 become-follower partitions (state.change.logger)
[2024-05-13 15:22:24,548] INFO [Controller id=2 epoch=8] Sending UpdateMetadata request to brokers HashSet(2) for 23 partitions (state.change.logger)
[2024-05-13 15:22:24,591] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,592] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,592] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,592] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,592] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,592] INFO [Controller id=2 epoch=8] Partition product-created-events-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,592] INFO [Controller id=2 epoch=8] Partition topic2-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,593] INFO [Controller id=2 epoch=8] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,593] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,593] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,593] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,593] INFO [Controller id=2 epoch=8] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,594] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,594] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,594] INFO [Controller id=2 epoch=8] Partition product-created-evnets-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,594] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,594] INFO [Controller id=2 epoch=8] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,594] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,594] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,595] INFO [Controller id=2 epoch=8] Partition topic2-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,595] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,595] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,595] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,595] INFO [Controller id=2 epoch=8] Partition topic2-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:9,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,595] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,602] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 2 for 23 partitions (state.change.logger)
[2024-05-13 15:22:24,626] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,627] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,627] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,627] INFO [Controller id=2 epoch=8] Partition insync-topic-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,627] INFO [Controller id=2 epoch=8] Partition topic2-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,627] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,627] INFO [Controller id=2 epoch=8] Partition insync-topic-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,627] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,627] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,627] INFO [Controller id=2 epoch=8] Partition topic2-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,628] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,628] INFO [Controller id=2 epoch=8] Partition product-created-events-topics-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,628] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,628] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,628] INFO [Controller id=2 epoch=8] Partition insync-topic-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,628] INFO [Controller id=2 epoch=8] Partition topic2-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,628] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,628] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,629] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,629] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,629] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,629] INFO [Controller id=2 epoch=8] Partition product-created-events-topics-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,629] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,629] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,629] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,629] INFO [Controller id=2 epoch=8] Partition product-created-events-topics-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:22:24,630] INFO [Controller id=2 epoch=8] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 6 become-follower partitions (state.change.logger)
[2024-05-13 15:22:24,630] INFO [Controller id=2 epoch=8] Sending UpdateMetadata request to brokers HashSet(2) for 45 partitions (state.change.logger)
[2024-05-13 15:22:24,657] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-35 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,665] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition topic2-0 (last update controller epoch 4) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,665] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-5 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,666] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-20 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,666] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition product-created-evnets-topics-0 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,667] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-41 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,668] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition topic2-2 (last update controller epoch 4) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,668] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition product-created-events-topics-1 (last update controller epoch 4) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,668] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-29 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,669] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-44 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,669] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-14 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,670] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-2 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,671] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition topic2-1 (last update controller epoch 4) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,672] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-23 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,673] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-38 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,674] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-8 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,675] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-11 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,676] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-26 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,676] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition product-created-events-topics-0 (last update controller epoch 4) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,677] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition product-created-events-topics-2 (last update controller epoch 4) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,677] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-47 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,678] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-17 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,678] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-32 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,681] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 2 epoch 8 with correlation id 1 for 0 partitions (state.change.logger)
[2024-05-13 15:22:24,698] INFO [Broker id=2] Finished LeaderAndIsr request in 98ms correlationId 1 from controller 2 for 23 partitions (state.change.logger)
[2024-05-13 15:22:24,704] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,707] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,707] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,708] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,708] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition insync-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition insync-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,708] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-created-events-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,708] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition insync-topic-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition insync-topic-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,708] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-created-evnets-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-evnets-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,709] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,709] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,709] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,710] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,710] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-created-events-topics-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,710] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,710] INFO [Broker id=2] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 2 (state.change.logger)
[2024-05-13 15:22:24,710] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,711] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,711] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition insync-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition insync-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,711] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,711] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition topic2-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,712] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,712] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,712] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,712] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 2 for 6 partitions (state.change.logger)
[2024-05-13 15:22:24,712] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,712] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 3 from controller 2 epoch 8 for partition topic2-0 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,712] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,713] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,713] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,713] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 3 from controller 2 epoch 8 for partition topic2-1 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,713] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,713] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 3 from controller 2 epoch 8 for partition topic2-2 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,713] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,713] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 3 from controller 2 epoch 8 for partition product-created-events-topics-1 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,714] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition topic2-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,714] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 3 from controller 2 epoch 8 for partition product-created-events-topics-0 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,714] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-created-events-topics-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,714] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 3 from controller 2 epoch 8 for partition product-created-events-topics-2 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:24,714] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,714] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 2 epoch 8 with correlation id 3 for 0 partitions (state.change.logger)
[2024-05-13 15:22:24,714] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,715] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,715] INFO [Broker id=2] Finished LeaderAndIsr request in 3ms correlationId 3 from controller 2 for 6 partitions (state.change.logger)
[2024-05-13 15:22:24,715] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,715] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,715] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,715] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,715] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,716] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-created-events-topics-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,716] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,716] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,716] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,716] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,717] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition topic2-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,717] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:24,718] INFO [Broker id=2] Add 45 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 4 (state.change.logger)
[2024-05-13 15:22:24,718] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-35 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-05-13 15:22:24,718] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-8 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-05-13 15:22:24,718] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-41 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-05-13 15:22:24,718] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-23 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-05-13 15:22:24,718] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-47 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-05-13 15:22:24,718] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-38 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-05-13 15:22:24,719] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-17 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-05-13 15:22:24,719] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-11 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-05-13 15:22:24,719] INFO [Controller id=2 epoch=8] Changed partition product-created-evnets-topics-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=5, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=5) (state.change.logger)
[2024-05-13 15:22:24,719] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-05-13 15:22:24,719] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-14 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-05-13 15:22:24,719] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-20 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-05-13 15:22:24,719] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-44 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-05-13 15:22:24,719] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-05-13 15:22:24,719] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-26 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-05-13 15:22:24,719] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-29 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-05-13 15:22:24,719] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-32 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-05-13 15:22:24,719] INFO [Controller id=2 epoch=8] Sending LeaderAndIsr request to broker 2 with 17 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-13 15:22:24,719] INFO [Controller id=2 epoch=8] Sending UpdateMetadata request to brokers HashSet(2) for 17 partitions (state.change.logger)
[2024-05-13 15:22:24,720] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 5 from controller 2 for 17 partitions (state.change.logger)
[2024-05-13 15:22:24,725] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 2 epoch 8 as part of the become-leader transition for 17 partitions (state.change.logger)
[2024-05-13 15:22:24,735] INFO [Broker id=2] Leader __consumer_offsets-35 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:24,742] INFO [Broker id=2] Leader __consumer_offsets-5 starts at leader epoch 7 from offset 6 with high watermark 6 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:24,745] INFO [Broker id=2] Leader __consumer_offsets-20 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:24,747] INFO [Broker id=2] Leader product-created-evnets-topics-0 starts at leader epoch 5 from offset 1 with high watermark 1 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:24,750] INFO [Broker id=2] Leader __consumer_offsets-41 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:24,752] INFO [Broker id=2] Leader __consumer_offsets-29 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:24,755] INFO [Broker id=2] Leader __consumer_offsets-44 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:24,757] INFO [Broker id=2] Leader __consumer_offsets-14 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:24,759] INFO [Broker id=2] Leader __consumer_offsets-2 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:24,761] INFO [Broker id=2] Leader __consumer_offsets-23 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:24,763] INFO [Broker id=2] Leader __consumer_offsets-38 starts at leader epoch 7 from offset 3 with high watermark 3 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:24,766] INFO [Broker id=2] Leader __consumer_offsets-8 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:24,768] INFO [Broker id=2] Leader __consumer_offsets-11 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:24,770] INFO [Broker id=2] Leader __consumer_offsets-26 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:24,772] INFO [Broker id=2] Leader __consumer_offsets-47 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:24,774] INFO [Broker id=2] Leader __consumer_offsets-17 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:24,776] INFO [Broker id=2] Leader __consumer_offsets-32 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:24,794] INFO [Broker id=2] Finished LeaderAndIsr request in 74ms correlationId 5 from controller 2 for 17 partitions (state.change.logger)
[2024-05-13 15:22:24,796] INFO [Broker id=2] Add 17 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 6 (state.change.logger)
[2024-05-13 15:22:27,520] INFO [Controller id=2 epoch=8] Sending UpdateMetadata request to brokers HashSet(2) for 0 partitions (state.change.logger)
[2024-05-13 15:22:27,524] INFO [Controller id=2 epoch=8] Sending UpdateMetadata request to brokers HashSet(0) for 62 partitions (state.change.logger)
[2024-05-13 15:22:27,529] INFO [Controller id=2 epoch=8] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 25 become-follower partitions (state.change.logger)
[2024-05-13 15:22:27,530] INFO [Controller id=2 epoch=8] Sending UpdateMetadata request to brokers HashSet(0, 2) for 25 partitions (state.change.logger)
[2024-05-13 15:22:27,539] INFO [Broker id=2] Add 25 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 8 (state.change.logger)
[2024-05-13 15:22:27,588] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,588] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition insync-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition insync-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,589] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition topic2-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,590] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition insync-topic-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition insync-topic-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,590] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,590] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,591] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,591] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-created-events-topics-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,591] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,591] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,592] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition insync-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition insync-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,592] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition topic2-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,592] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,592] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,592] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,593] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,593] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,593] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,593] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-created-events-topics-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,593] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,594] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,594] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,594] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,594] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-created-events-topics-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,594] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,595] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition topic2-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-22 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-25 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-37 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Changed partition product-created-events-topic-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-19 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-13 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-34 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Changed partition product-created-evnets-topic-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-7 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-46 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-49 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-16 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-28 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-31 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-43 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-10 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-40 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:22:27,595] INFO [Controller id=2 epoch=8] Sending LeaderAndIsr request to broker 0 with 19 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-13 15:22:27,596] INFO [Controller id=2 epoch=8] Sending UpdateMetadata request to brokers HashSet(0, 2) for 19 partitions (state.change.logger)
[2024-05-13 15:22:27,598] INFO [Broker id=2] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 9 (state.change.logger)
[2024-05-13 15:22:27,854] INFO [Broker id=0] Add 62 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 0 (state.change.logger)
[2024-05-13 15:22:27,869] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 2 for 25 partitions (state.change.logger)
[2024-05-13 15:22:27,897] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition topic2-0 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,902] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-37 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,902] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-7 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,902] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-22 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,903] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-10 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,903] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition product-created-events-topic-0 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,903] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-19 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,904] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-34 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,904] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition topic2-1 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,904] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-4 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,905] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition product-created-events-topics-0 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,905] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-49 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,905] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition topic2-2 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,906] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition product-created-events-topics-1 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,906] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition product-created-evnets-topic-0 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,907] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-31 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,907] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-46 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,908] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-1 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,908] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-16 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,909] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-25 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,910] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-40 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,910] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-43 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,911] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-13 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,911] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-28 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,911] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition product-created-events-topics-2 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:22:27,913] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 2 epoch 8 with correlation id 1 for 0 partitions (state.change.logger)
[2024-05-13 15:22:27,923] INFO [Broker id=0] Finished LeaderAndIsr request in 54ms correlationId 1 from controller 2 for 25 partitions (state.change.logger)
[2024-05-13 15:22:27,929] INFO [Broker id=0] Add 25 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 2 (state.change.logger)
[2024-05-13 15:22:27,932] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 2 for 19 partitions (state.change.logger)
[2024-05-13 15:22:27,936] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 2 epoch 8 as part of the become-leader transition for 19 partitions (state.change.logger)
[2024-05-13 15:22:27,943] INFO [Broker id=0] Leader __consumer_offsets-37 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:27,949] INFO [Broker id=0] Leader __consumer_offsets-7 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:27,951] INFO [Broker id=0] Leader __consumer_offsets-22 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:27,954] INFO [Broker id=0] Leader __consumer_offsets-10 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:27,956] INFO [Broker id=0] Leader product-created-evnets-topic-0 starts at leader epoch 6 from offset 2 with high watermark 2 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:27,958] INFO [Broker id=0] Leader __consumer_offsets-31 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:27,960] INFO [Broker id=0] Leader __consumer_offsets-46 starts at leader epoch 8 from offset 3 with high watermark 3 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:27,962] INFO [Broker id=0] Leader __consumer_offsets-1 starts at leader epoch 8 from offset 3 with high watermark 3 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:27,965] INFO [Broker id=0] Leader product-created-events-topic-0 starts at leader epoch 6 from offset 5 with high watermark 5 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:27,968] INFO [Broker id=0] Leader __consumer_offsets-16 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:27,970] INFO [Broker id=0] Leader __consumer_offsets-19 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:27,972] INFO [Broker id=0] Leader __consumer_offsets-34 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:27,974] INFO [Broker id=0] Leader __consumer_offsets-4 starts at leader epoch 8 from offset 3 with high watermark 3 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:27,977] INFO [Broker id=0] Leader __consumer_offsets-25 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:27,980] INFO [Broker id=0] Leader __consumer_offsets-40 starts at leader epoch 8 from offset 3 with high watermark 3 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:27,982] INFO [Broker id=0] Leader __consumer_offsets-43 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:27,984] INFO [Broker id=0] Leader __consumer_offsets-13 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:27,985] INFO [Broker id=0] Leader __consumer_offsets-28 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:27,987] INFO [Broker id=0] Leader __consumer_offsets-49 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:22:28,008] INFO [Broker id=0] Finished LeaderAndIsr request in 76ms correlationId 3 from controller 2 for 19 partitions (state.change.logger)
[2024-05-13 15:22:28,013] INFO [Broker id=0] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 4 (state.change.logger)
[2024-05-13 15:23:43,597] INFO [Controller id=1 epoch=9] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-05-13 15:23:43,640] INFO [Controller id=1 epoch=9] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 26 become-follower partitions (state.change.logger)
[2024-05-13 15:23:43,643] INFO [Controller id=1 epoch=9] Sending UpdateMetadata request to brokers HashSet(1) for 26 partitions (state.change.logger)
[2024-05-13 15:23:43,691] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,691] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,692] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,692] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,692] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,692] INFO [Controller id=1 epoch=9] Partition product-created-events-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,692] INFO [Controller id=1 epoch=9] Partition topic2-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,692] INFO [Controller id=1 epoch=9] Partition product-created-events-topics-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,692] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,692] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,692] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,693] INFO [Controller id=1 epoch=9] Partition product-created-events-topics-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,693] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,693] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,693] INFO [Controller id=1 epoch=9] Partition product-created-evnets-topic-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,693] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,693] INFO [Controller id=1 epoch=9] Partition product-created-events-topics-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,693] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,693] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,693] INFO [Controller id=1 epoch=9] Partition topic2-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,694] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,694] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,694] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,694] INFO [Controller id=1 epoch=9] Partition topic2-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,694] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:9) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,715] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 26 partitions (state.change.logger)
[2024-05-13 15:23:43,715] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,716] INFO [Controller id=1 epoch=9] Partition product-created-events-topics-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,716] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,716] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,716] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,716] INFO [Controller id=1 epoch=9] Partition product-created-evnets-topics-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,716] INFO [Controller id=1 epoch=9] Partition product-created-events-topics-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,716] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,716] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,717] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,717] INFO [Controller id=1 epoch=9] Partition topic2-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,717] INFO [Controller id=1 epoch=9] Partition topic2-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,717] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,717] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,717] INFO [Controller id=1 epoch=9] Partition product-created-events-topics-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,717] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,717] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,717] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,717] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,717] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,717] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,718] INFO [Controller id=1 epoch=9] Partition topic2-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:10,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,718] INFO [Controller id=1 epoch=9] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:23:43,718] INFO [Controller id=1 epoch=9] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 6 become-follower partitions (state.change.logger)
[2024-05-13 15:23:43,718] INFO [Controller id=1 epoch=9] Sending UpdateMetadata request to brokers HashSet(1) for 42 partitions (state.change.logger)
[2024-05-13 15:23:43,763] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-3 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,768] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition topic2-0 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,769] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-18 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,769] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition insync-topic-2 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,770] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-33 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,771] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-48 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,773] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition topic2-1 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,774] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition product-created-events-topics-0 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,775] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-45 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,776] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-15 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,777] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-30 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,777] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-0 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,778] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition insync-topic-0 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,779] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-39 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,779] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-9 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,779] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition topic2-2 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,780] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-24 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,781] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-27 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,782] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition product-created-events-topics-1 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,784] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-42 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,785] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-12 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,785] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition insync-topic-1 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,785] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-21 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,786] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-36 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,786] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-6 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,787] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition product-created-events-topics-2 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,789] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,789] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 9 with correlation id 1 for 0 partitions (state.change.logger)
[2024-05-13 15:23:43,791] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,791] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,791] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,792] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition product-created-events-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,792] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition product-created-evnets-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-evnets-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,792] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,793] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,793] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,793] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,793] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,794] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,794] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,794] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,794] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,795] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,795] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,795] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,796] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,796] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,796] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,796] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition product-created-evnets-topics-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-evnets-topics-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,797] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,797] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,797] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,798] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,799] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,799] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,799] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,800] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,800] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,801] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,801] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,801] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,801] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,802] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:43,803] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-30 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-13 15:23:43,803] INFO [Controller id=1 epoch=9] Changed partition insync-topic-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-13 15:23:43,803] INFO [Controller id=1 epoch=9] Changed partition insync-topic-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-13 15:23:43,803] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-21 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-13 15:23:43,803] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-27 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-13 15:23:43,803] INFO [Controller id=1 epoch=9] Changed partition product-created-events-topics-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=5, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=5) (state.change.logger)
[2024-05-13 15:23:43,803] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-9 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-13 15:23:43,803] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-33 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-13 15:23:43,803] INFO [Controller id=1 epoch=9] Changed partition insync-topic-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-13 15:23:43,803] INFO [Controller id=1 epoch=9] Changed partition topic2-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=11) (state.change.logger)
[2024-05-13 15:23:43,803] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-36 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-13 15:23:43,804] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-42 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-13 15:23:43,804] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-13 15:23:43,804] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-18 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-13 15:23:43,804] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-15 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-13 15:23:43,804] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-24 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-13 15:23:43,804] INFO [Controller id=1 epoch=9] Changed partition topic2-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=11) (state.change.logger)
[2024-05-13 15:23:43,804] INFO [Controller id=1 epoch=9] Changed partition product-created-events-topics-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-13 15:23:43,804] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-48 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-13 15:23:43,804] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-6 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-13 15:23:43,804] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-13 15:23:43,804] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-39 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-13 15:23:43,804] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-12 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-13 15:23:43,804] INFO [Controller id=1 epoch=9] Changed partition product-created-events-topics-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=5, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=5) (state.change.logger)
[2024-05-13 15:23:43,804] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-45 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-13 15:23:43,804] INFO [Controller id=1 epoch=9] Changed partition topic2-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=11) (state.change.logger)
[2024-05-13 15:23:43,804] INFO [Controller id=1 epoch=9] Sending LeaderAndIsr request to broker 1 with 26 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-13 15:23:43,804] INFO [Controller id=1 epoch=9] Sending UpdateMetadata request to brokers HashSet(1) for 26 partitions (state.change.logger)
[2024-05-13 15:23:43,807] INFO [Broker id=1] Finished LeaderAndIsr request in 95ms correlationId 1 from controller 1 for 26 partitions (state.change.logger)
[2024-05-13 15:23:43,821] INFO [Broker id=1] Add 26 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 2 (state.change.logger)
[2024-05-13 15:23:43,823] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 6 partitions (state.change.logger)
[2024-05-13 15:23:43,823] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 9 for partition topic2-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,824] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 9 for partition topic2-1 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,824] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 9 for partition topic2-2 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,824] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 9 for partition product-created-events-topics-1 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,824] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 9 for partition product-created-events-topics-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,824] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 9 for partition product-created-events-topics-2 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:43,824] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 9 with correlation id 3 for 0 partitions (state.change.logger)
[2024-05-13 15:23:43,824] INFO [Broker id=1] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 1 for 6 partitions (state.change.logger)
[2024-05-13 15:23:43,827] INFO [Broker id=1] Add 42 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 4 (state.change.logger)
[2024-05-13 15:23:43,828] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 5 from controller 1 for 26 partitions (state.change.logger)
[2024-05-13 15:23:43,834] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 1 epoch 9 as part of the become-leader transition for 26 partitions (state.change.logger)
[2024-05-13 15:23:43,841] INFO [Broker id=1] Leader __consumer_offsets-3 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,848] INFO [Broker id=1] Leader topic2-0 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,851] INFO [Broker id=1] Leader __consumer_offsets-18 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,853] INFO [Broker id=1] Leader insync-topic-2 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,855] INFO [Broker id=1] Leader __consumer_offsets-33 starts at leader epoch 4 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,857] INFO [Broker id=1] Leader __consumer_offsets-48 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,859] INFO [Broker id=1] Leader topic2-1 starts at leader epoch 9 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,860] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 4 from offset 7 with high watermark 7 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,863] INFO [Broker id=1] Leader __consumer_offsets-45 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,865] INFO [Broker id=1] Leader __consumer_offsets-15 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,868] INFO [Broker id=1] Leader __consumer_offsets-30 starts at leader epoch 4 from offset 2 with high watermark 2 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,870] INFO [Broker id=1] Leader __consumer_offsets-0 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,871] INFO [Broker id=1] Leader insync-topic-0 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,873] INFO [Broker id=1] Leader __consumer_offsets-39 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,874] INFO [Broker id=1] Leader __consumer_offsets-9 starts at leader epoch 4 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,876] INFO [Broker id=1] Leader topic2-2 starts at leader epoch 9 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,877] INFO [Broker id=1] Leader __consumer_offsets-24 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,879] INFO [Broker id=1] Leader __consumer_offsets-27 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,881] INFO [Broker id=1] Leader product-created-events-topics-1 starts at leader epoch 5 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,883] INFO [Broker id=1] Leader __consumer_offsets-42 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,884] INFO [Broker id=1] Leader __consumer_offsets-12 starts at leader epoch 4 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,886] INFO [Broker id=1] Leader insync-topic-1 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,887] INFO [Broker id=1] Leader __consumer_offsets-21 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,888] INFO [Broker id=1] Leader __consumer_offsets-36 starts at leader epoch 4 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,890] INFO [Broker id=1] Leader __consumer_offsets-6 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,891] INFO [Broker id=1] Leader product-created-events-topics-2 starts at leader epoch 5 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:43,907] INFO [Broker id=1] Finished LeaderAndIsr request in 79ms correlationId 5 from controller 1 for 26 partitions (state.change.logger)
[2024-05-13 15:23:43,909] INFO [Broker id=1] Add 26 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 6 (state.change.logger)
[2024-05-13 15:23:56,675] INFO [Controller id=1 epoch=9] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-05-13 15:23:56,678] INFO [Controller id=1 epoch=9] Sending UpdateMetadata request to brokers HashSet(2) for 62 partitions (state.change.logger)
[2024-05-13 15:23:56,683] INFO [Controller id=1 epoch=9] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 23 become-follower partitions (state.change.logger)
[2024-05-13 15:23:56,683] INFO [Controller id=1 epoch=9] Sending UpdateMetadata request to brokers HashSet(1, 2) for 23 partitions (state.change.logger)
[2024-05-13 15:23:56,686] INFO [Broker id=1] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 8 (state.change.logger)
[2024-05-13 15:23:56,708] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:56,709] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:56,709] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:56,709] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:56,709] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition product-created-events-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:56,709] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition product-created-evnets-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-evnets-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:56,710] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:56,710] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:56,710] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:56,710] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:56,710] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:56,710] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:56,711] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:56,711] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:56,711] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:56,711] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:56,711] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:56,711] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:56,712] ERROR [Controller id=1 epoch=9] Controller 1 epoch 9 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:23:56,712] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-35 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=9, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-05-13 15:23:56,712] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-38 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=9, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-05-13 15:23:56,712] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-17 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=9, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-05-13 15:23:56,712] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-8 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=9, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-05-13 15:23:56,712] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-41 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=9, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-05-13 15:23:56,712] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-23 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=9, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-05-13 15:23:56,712] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-47 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=9, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-05-13 15:23:56,712] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-11 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=9, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-05-13 15:23:56,712] INFO [Controller id=1 epoch=9] Changed partition product-created-evnets-topics-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-05-13 15:23:56,712] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=9, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-05-13 15:23:56,712] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-14 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=9, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-05-13 15:23:56,712] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-20 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=9, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-05-13 15:23:56,712] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-44 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=9, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-05-13 15:23:56,712] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=9, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-05-13 15:23:56,712] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-26 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=9, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-05-13 15:23:56,712] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-29 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=9, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-05-13 15:23:56,712] INFO [Controller id=1 epoch=9] Changed partition __consumer_offsets-32 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=9, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-05-13 15:23:56,713] INFO [Controller id=1 epoch=9] Sending LeaderAndIsr request to broker 2 with 17 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-13 15:23:56,713] INFO [Controller id=1 epoch=9] Sending UpdateMetadata request to brokers HashSet(1, 2) for 17 partitions (state.change.logger)
[2024-05-13 15:23:56,715] INFO [Broker id=1] Add 17 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 9 (state.change.logger)
[2024-05-13 15:23:56,973] INFO [Broker id=2] Add 62 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 0 (state.change.logger)
[2024-05-13 15:23:56,986] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 1 for 23 partitions (state.change.logger)
[2024-05-13 15:23:57,008] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-35 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:57,015] INFO [Broker id=2] Follower topic2-0 starts at leader epoch 9 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,015] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-5 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:57,016] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-20 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:57,016] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition product-created-evnets-topics-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:57,017] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-41 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:57,017] INFO [Broker id=2] Follower topic2-2 starts at leader epoch 9 from offset 1 with high watermark 1. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,018] INFO [Broker id=2] Follower product-created-events-topics-1 starts at leader epoch 5 from offset 1 with high watermark 1. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,018] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-29 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:57,018] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-44 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:57,018] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-14 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:57,019] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-2 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:57,019] INFO [Broker id=2] Follower topic2-1 starts at leader epoch 9 from offset 1 with high watermark 1. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,019] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-23 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:57,020] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-38 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:57,020] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-8 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:57,020] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-11 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:57,021] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-26 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:57,021] INFO [Broker id=2] Follower product-created-events-topics-0 starts at leader epoch 4 from offset 7 with high watermark 7. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,022] INFO [Broker id=2] Follower product-created-events-topics-2 starts at leader epoch 5 from offset 3 with high watermark 3. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,022] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-47 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:57,022] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-17 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:57,023] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 9 for partition __consumer_offsets-32 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:23:57,025] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 9 with correlation id 1 for 6 partitions (state.change.logger)
[2024-05-13 15:23:57,075] INFO [Broker id=2] Finished LeaderAndIsr request in 89ms correlationId 1 from controller 1 for 23 partitions (state.change.logger)
[2024-05-13 15:23:57,080] INFO [Broker id=2] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 2 (state.change.logger)
[2024-05-13 15:23:57,082] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 1 for 17 partitions (state.change.logger)
[2024-05-13 15:23:57,088] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 9 as part of the become-leader transition for 17 partitions (state.change.logger)
[2024-05-13 15:23:57,090] INFO [Broker id=2] Leader __consumer_offsets-35 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,096] INFO [Broker id=2] Leader __consumer_offsets-5 starts at leader epoch 9 from offset 6 with high watermark 6 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,099] INFO [Broker id=2] Leader __consumer_offsets-20 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,101] INFO [Broker id=2] Leader product-created-evnets-topics-0 starts at leader epoch 7 from offset 1 with high watermark 1 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,104] INFO [Broker id=2] Leader __consumer_offsets-41 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,107] INFO [Broker id=2] Leader __consumer_offsets-29 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,109] INFO [Broker id=2] Leader __consumer_offsets-44 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,113] INFO [Broker id=2] Leader __consumer_offsets-14 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,117] INFO [Broker id=2] Leader __consumer_offsets-2 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,120] INFO [Broker id=2] Leader __consumer_offsets-23 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,123] INFO [Broker id=2] Leader __consumer_offsets-38 starts at leader epoch 9 from offset 3 with high watermark 3 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,126] INFO [Broker id=2] Leader __consumer_offsets-8 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,129] INFO [Broker id=2] Leader __consumer_offsets-11 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,130] INFO [Controller id=1 epoch=9] Sending UpdateMetadata request to brokers HashSet(1, 2) for 1 partitions (state.change.logger)
[2024-05-13 15:23:57,132] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 10 (state.change.logger)
[2024-05-13 15:23:57,136] INFO [Broker id=2] Leader __consumer_offsets-26 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,139] INFO [Broker id=2] Leader __consumer_offsets-47 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,143] INFO [Broker id=2] Leader __consumer_offsets-17 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,148] INFO [Broker id=2] Leader __consumer_offsets-32 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:23:57,172] INFO [Controller id=1 epoch=9] Sending UpdateMetadata request to brokers HashSet(1, 2) for 5 partitions (state.change.logger)
[2024-05-13 15:23:57,175] INFO [Broker id=1] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 11 (state.change.logger)
[2024-05-13 15:23:57,189] INFO [Broker id=2] Finished LeaderAndIsr request in 108ms correlationId 3 from controller 1 for 17 partitions (state.change.logger)
[2024-05-13 15:23:57,191] INFO [Broker id=2] Add 17 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 4 (state.change.logger)
[2024-05-13 15:23:57,193] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 5 (state.change.logger)
[2024-05-13 15:23:57,196] INFO [Broker id=2] Add 5 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 9 with correlation id 6 (state.change.logger)
[2024-05-13 15:24:27,498] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers HashSet(0, 2) for 0 partitions (state.change.logger)
[2024-05-13 15:24:27,536] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 25 become-follower partitions (state.change.logger)
[2024-05-13 15:24:27,538] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 2 with 17 become-leader and 6 become-follower partitions (state.change.logger)
[2024-05-13 15:24:27,538] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers HashSet(0, 2) for 42 partitions (state.change.logger)
[2024-05-13 15:24:27,577] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,578] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,578] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,578] INFO [Controller id=0 epoch=10] Partition insync-topic-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,578] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 25 partitions (state.change.logger)
[2024-05-13 15:24:27,578] INFO [Controller id=0 epoch=10] Partition topic2-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:13,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,579] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,579] INFO [Controller id=0 epoch=10] Partition insync-topic-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,579] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,579] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,579] INFO [Controller id=0 epoch=10] Partition topic2-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:13,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,579] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,579] INFO [Controller id=0 epoch=10] Partition product-created-events-topics-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:7,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,579] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,579] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,580] INFO [Controller id=0 epoch=10] Partition insync-topic-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,580] INFO [Controller id=0 epoch=10] Partition topic2-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:13,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,580] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,580] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,580] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,580] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,580] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,580] INFO [Controller id=0 epoch=10] Partition product-created-events-topics-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:6,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,580] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,581] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,581] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,581] INFO [Controller id=0 epoch=10] Partition product-created-events-topics-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:7,ControllerEpoch:10) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:27,583] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 6 become-follower partitions (state.change.logger)
[2024-05-13 15:24:27,583] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 6 become-follower partitions (state.change.logger)
[2024-05-13 15:24:27,583] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers HashSet(0, 2) for 26 partitions (state.change.logger)
[2024-05-13 15:24:27,622] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition topic2-0 (last update controller epoch 9) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,627] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition __consumer_offsets-37 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,628] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition __consumer_offsets-7 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,628] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition __consumer_offsets-22 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,629] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition __consumer_offsets-10 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,630] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition product-created-events-topic-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,630] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition __consumer_offsets-19 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,631] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition __consumer_offsets-34 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,631] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition topic2-1 (last update controller epoch 9) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,633] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition __consumer_offsets-4 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,635] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition product-created-events-topics-0 (last update controller epoch 9) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,636] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition __consumer_offsets-49 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,638] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition topic2-2 (last update controller epoch 9) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,641] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition product-created-events-topics-1 (last update controller epoch 9) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,643] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition product-created-evnets-topic-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,644] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition __consumer_offsets-31 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,645] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition __consumer_offsets-46 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,646] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition __consumer_offsets-1 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,646] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition __consumer_offsets-16 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,647] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition __consumer_offsets-25 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,647] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition __consumer_offsets-40 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,648] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition __consumer_offsets-43 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,648] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition __consumer_offsets-13 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,649] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition __consumer_offsets-28 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,650] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 10 for partition product-created-events-topics-2 (last update controller epoch 9) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,651] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,652] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition insync-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition insync-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,652] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 10 with correlation id 1 for 0 partitions (state.change.logger)
[2024-05-13 15:24:27,652] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition insync-topic-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition insync-topic-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,653] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,653] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,653] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,654] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,654] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,654] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition insync-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition insync-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,654] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,655] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,655] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,655] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,656] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,656] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,656] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,657] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,657] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,657] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,658] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition __consumer_offsets-22 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition __consumer_offsets-25 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition __consumer_offsets-37 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition product-created-events-topic-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition topic2-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=11, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition __consumer_offsets-19 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition __consumer_offsets-13 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition __consumer_offsets-34 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition product-created-evnets-topic-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition __consumer_offsets-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition __consumer_offsets-7 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition product-created-events-topics-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition __consumer_offsets-46 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition __consumer_offsets-49 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition topic2-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=11, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition __consumer_offsets-16 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition __consumer_offsets-28 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition __consumer_offsets-31 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition product-created-events-topics-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=6, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition __consumer_offsets-43 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition product-created-events-topics-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition __consumer_offsets-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition __consumer_offsets-10 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition topic2-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=11, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Changed partition __consumer_offsets-40 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-13 15:24:27,660] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 0 with 19 become-leader and 6 become-follower partitions (state.change.logger)
[2024-05-13 15:24:27,661] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 2 with 6 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-13 15:24:27,661] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers HashSet(0, 2) for 25 partitions (state.change.logger)
[2024-05-13 15:24:27,669] INFO [Broker id=0] Finished LeaderAndIsr request in 92ms correlationId 1 from controller 0 for 25 partitions (state.change.logger)
[2024-05-13 15:24:27,681] INFO [Broker id=0] Add 42 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 2 (state.change.logger)
[2024-05-13 15:24:27,683] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 6 partitions (state.change.logger)
[2024-05-13 15:24:27,683] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 10 for partition topic2-0 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,684] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 10 for partition topic2-1 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,684] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 10 for partition topic2-2 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,684] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 10 for partition product-created-events-topics-1 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,684] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 10 for partition product-created-events-topics-0 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,684] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 10 for partition product-created-events-topics-2 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:27,684] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 10 with correlation id 3 for 0 partitions (state.change.logger)
[2024-05-13 15:24:27,684] INFO [Broker id=0] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 0 for 6 partitions (state.change.logger)
[2024-05-13 15:24:27,687] INFO [Broker id=0] Add 26 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 4 (state.change.logger)
[2024-05-13 15:24:27,689] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 5 from controller 0 for 25 partitions (state.change.logger)
[2024-05-13 15:24:27,693] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 10 as part of the become-leader transition for 19 partitions (state.change.logger)
[2024-05-13 15:24:27,700] INFO [Broker id=0] Leader __consumer_offsets-37 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,705] INFO [Broker id=0] Leader __consumer_offsets-7 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,708] INFO [Broker id=0] Leader __consumer_offsets-22 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,711] INFO [Broker id=0] Leader __consumer_offsets-10 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,713] INFO [Broker id=0] Leader product-created-evnets-topic-0 starts at leader epoch 8 from offset 2 with high watermark 2 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,715] INFO [Broker id=0] Leader __consumer_offsets-31 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,717] INFO [Broker id=0] Leader __consumer_offsets-46 starts at leader epoch 10 from offset 3 with high watermark 3 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,719] INFO [Broker id=0] Leader __consumer_offsets-1 starts at leader epoch 10 from offset 3 with high watermark 3 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,721] INFO [Broker id=0] Leader product-created-events-topic-0 starts at leader epoch 8 from offset 5 with high watermark 5 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,723] INFO [Broker id=0] Leader __consumer_offsets-16 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,725] INFO [Broker id=0] Leader __consumer_offsets-19 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,727] INFO [Broker id=0] Leader __consumer_offsets-34 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,728] INFO [Broker id=0] Leader __consumer_offsets-4 starts at leader epoch 10 from offset 3 with high watermark 3 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,730] INFO [Broker id=0] Leader __consumer_offsets-25 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,732] INFO [Broker id=0] Leader __consumer_offsets-40 starts at leader epoch 10 from offset 3 with high watermark 3 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,734] INFO [Broker id=0] Leader __consumer_offsets-43 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,736] INFO [Broker id=0] Leader __consumer_offsets-13 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,738] INFO [Broker id=0] Leader __consumer_offsets-28 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,739] INFO [Broker id=0] Leader __consumer_offsets-49 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,745] INFO [Broker id=0] Follower topic2-0 starts at leader epoch 11 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,745] INFO [Broker id=0] Follower topic2-1 starts at leader epoch 11 from offset 1 with high watermark 1. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,745] INFO [Broker id=0] Follower topic2-2 starts at leader epoch 11 from offset 1 with high watermark 1. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,745] INFO [Broker id=0] Follower product-created-events-topics-1 starts at leader epoch 7 from offset 1 with high watermark 1. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,745] INFO [Broker id=0] Follower product-created-events-topics-0 starts at leader epoch 6 from offset 7 with high watermark 7. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,745] INFO [Broker id=0] Follower product-created-events-topics-2 starts at leader epoch 7 from offset 3 with high watermark 3. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 15:24:27,746] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 10 with correlation id 5 for 6 partitions (state.change.logger)
[2024-05-13 15:24:27,810] INFO [Broker id=0] Finished LeaderAndIsr request in 121ms correlationId 5 from controller 0 for 25 partitions (state.change.logger)
[2024-05-13 15:24:27,812] INFO [Broker id=0] Add 25 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 6 (state.change.logger)
[2024-05-13 15:24:39,426] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-13 15:24:39,444] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,444] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,444] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,444] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,444] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition insync-topic-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition insync-topic-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,444] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,445] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition product-created-evnets-topics-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-evnets-topics-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,445] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition insync-topic-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition insync-topic-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,445] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,445] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,445] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,445] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,445] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition product-created-events-topics-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,446] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,446] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,446] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,446] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition insync-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition insync-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,446] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,447] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition topic2-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,447] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,447] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,448] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,449] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,449] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,449] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition topic2-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,450] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,450] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,450] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition product-created-events-topics-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,450] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,450] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,450] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,450] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,450] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,451] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,451] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,451] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,451] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,451] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition product-created-events-topics-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,451] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,451] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,451] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,451] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition topic2-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,451] ERROR [Controller id=0 epoch=10] Controller 0 epoch 10 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-13 15:24:39,452] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-13 15:24:39,467] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,467] INFO [Controller id=0 epoch=10] Partition product-created-events-topics-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:9,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,467] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,467] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,468] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,468] INFO [Controller id=0 epoch=10] Partition product-created-evnets-topics-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,468] INFO [Controller id=0 epoch=10] Partition product-created-events-topics-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:9,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,468] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,468] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,468] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,468] INFO [Controller id=0 epoch=10] Partition topic2-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:15,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,468] INFO [Controller id=0 epoch=10] Partition topic2-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:15,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,468] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,468] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,468] INFO [Controller id=0 epoch=10] Partition product-created-events-topics-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:8,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,468] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,468] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,468] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,468] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,468] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,468] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,468] INFO [Controller id=0 epoch=10] Partition topic2-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:15,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,469] INFO [Controller id=0 epoch=10] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:10,ControllerEpoch:10) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-13 15:24:39,469] INFO [Controller id=0 epoch=10] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 6 become-follower partitions (state.change.logger)
[2024-05-13 15:24:39,469] INFO [Controller id=0 epoch=10] Sending UpdateMetadata request to brokers HashSet(0) for 23 partitions (state.change.logger)
[2024-05-13 15:24:39,470] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 7 from controller 0 for 6 partitions (state.change.logger)
[2024-05-13 15:24:39,470] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 7 from controller 0 epoch 10 for partition topic2-0 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:39,470] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 7 from controller 0 epoch 10 for partition topic2-1 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:39,470] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 7 from controller 0 epoch 10 for partition topic2-2 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:39,470] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 7 from controller 0 epoch 10 for partition product-created-events-topics-1 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:39,470] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 7 from controller 0 epoch 10 for partition product-created-events-topics-0 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:39,470] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 7 from controller 0 epoch 10 for partition product-created-events-topics-2 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-13 15:24:39,471] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 10 with correlation id 7 for 0 partitions (state.change.logger)
[2024-05-13 15:24:39,471] INFO [Broker id=0] Finished LeaderAndIsr request in 1ms correlationId 7 from controller 0 for 6 partitions (state.change.logger)
[2024-05-13 15:24:39,472] INFO [Broker id=0] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 10 with correlation id 8 (state.change.logger)
[2024-05-13 15:27:35,845] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-05-13 15:27:52,946] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-05-13 15:27:52,948] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(2) for 0 partitions (state.change.logger)
[2024-05-13 15:28:05,160] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(1, 2) for 0 partitions (state.change.logger)
[2024-05-13 15:28:05,160] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2024-05-13 16:18:38,505] INFO [Controller id=1 epoch=1] Changed partition product-created-events-topics-0 state from NonExistentPartition to NewPartition with assigned replicas 1,2,0 (state.change.logger)
[2024-05-13 16:18:38,506] INFO [Controller id=1 epoch=1] Changed partition product-created-events-topics-1 state from NonExistentPartition to NewPartition with assigned replicas 0,1,2 (state.change.logger)
[2024-05-13 16:18:38,506] INFO [Controller id=1 epoch=1] Changed partition product-created-events-topics-2 state from NonExistentPartition to NewPartition with assigned replicas 2,0,1 (state.change.logger)
[2024-05-13 16:18:38,506] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-13 16:18:38,509] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-13 16:18:38,527] INFO [Controller id=1 epoch=1] Changed partition product-created-events-topics-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1, 2, 0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:18:38,527] INFO [Controller id=1 epoch=1] Changed partition product-created-events-topics-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0, 1, 2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:18:38,527] INFO [Controller id=1 epoch=1] Changed partition product-created-events-topics-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2, 0, 1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:18:38,528] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-05-13 16:18:38,530] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-05-13 16:18:38,530] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-05-13 16:18:38,530] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 3 partitions (state.change.logger)
[2024-05-13 16:18:38,532] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-13 16:18:38,542] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-05-13 16:18:38,544] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 2 from controller 1 for 3 partitions (state.change.logger)
[2024-05-13 16:18:38,547] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 1 for 3 partitions (state.change.logger)
[2024-05-13 16:18:38,576] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-05-13 16:18:38,592] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 1 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-05-13 16:18:38,593] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 2 from controller 1 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-05-13 16:18:38,684] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1,2,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:18:38,706] INFO [Broker id=1] Follower product-created-events-topics-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:18:38,707] INFO [Broker id=2] Leader product-created-events-topics-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2,0,1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:18:38,707] INFO [Broker id=0] Leader product-created-events-topics-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0,1,2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:18:38,719] INFO [Broker id=1] Follower product-created-events-topics-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:18:38,762] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 1 with correlation id 3 for 2 partitions (state.change.logger)
[2024-05-13 16:18:38,767] INFO [Broker id=2] Follower product-created-events-topics-1 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:18:38,779] INFO [Broker id=0] Follower product-created-events-topics-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:18:38,788] INFO [Broker id=2] Follower product-created-events-topics-0 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:18:38,789] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 1 with correlation id 2 for 2 partitions (state.change.logger)
[2024-05-13 16:18:38,791] INFO [Broker id=0] Follower product-created-events-topics-2 starts at leader epoch 0 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:18:38,793] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 1 epoch 1 with correlation id 1 for 2 partitions (state.change.logger)
[2024-05-13 16:18:38,825] INFO [Broker id=1] Finished LeaderAndIsr request in 284ms correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-05-13 16:18:38,838] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 4 (state.change.logger)
[2024-05-13 16:18:38,871] INFO [Broker id=2] Finished LeaderAndIsr request in 329ms correlationId 2 from controller 1 for 3 partitions (state.change.logger)
[2024-05-13 16:18:38,885] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 3 (state.change.logger)
[2024-05-13 16:18:38,988] INFO [Broker id=0] Finished LeaderAndIsr request in 437ms correlationId 1 from controller 1 for 3 partitions (state.change.logger)
[2024-05-13 16:18:39,051] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 2 (state.change.logger)
[2024-05-13 16:24:23,320] INFO [Controller id=1 epoch=1] Changed partition product-created-events-topic-0 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-13 16:24:23,320] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-13 16:24:23,320] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-13 16:24:23,330] INFO [Controller id=1 epoch=1] Changed partition product-created-events-topic-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:24:23,330] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-13 16:24:23,330] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-05-13 16:24:23,331] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-13 16:24:23,331] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 5 from controller 1 for 1 partitions (state.change.logger)
[2024-05-13 16:24:23,332] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 3 (state.change.logger)
[2024-05-13 16:24:23,332] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 4 (state.change.logger)
[2024-05-13 16:24:23,333] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 1 epoch 1 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-05-13 16:24:23,344] INFO [Broker id=1] Leader product-created-events-topic-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:24:23,347] INFO [Broker id=1] Finished LeaderAndIsr request in 16ms correlationId 5 from controller 1 for 1 partitions (state.change.logger)
[2024-05-13 16:24:23,348] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 6 (state.change.logger)
[2024-05-13 16:25:28,905] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-22 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-30 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-25 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-35 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-37 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-38 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-13 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-8 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-21 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-4 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-27 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-7 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-9 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-46 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-41 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-33 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-23 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-49 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-47 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-16 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-28 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-31 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-36 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-42 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-3 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-18 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-15 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-24 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-17 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-48 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-19 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-11 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-2 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-43 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-6 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-14 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-05-13 16:25:28,906] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-20 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-05-13 16:25:28,907] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-0 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-05-13 16:25:28,907] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-44 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-05-13 16:25:28,907] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-39 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-05-13 16:25:28,907] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-12 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-05-13 16:25:28,907] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-45 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-05-13 16:25:28,907] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-1 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-13 16:25:28,907] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-5 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-05-13 16:25:28,907] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-26 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-05-13 16:25:28,907] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-29 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-05-13 16:25:28,907] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-34 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-13 16:25:28,907] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-10 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-13 16:25:28,907] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-32 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-05-13 16:25:28,907] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-40 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-13 16:25:28,907] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-13 16:25:28,908] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-22 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-30 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-25 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-35 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-37 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-38 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-13 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-8 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-21 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-4 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-27 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-7 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-9 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-46 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-41 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-33 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-23 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-49 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-47 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-16 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-28 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-31 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-36 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,948] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-42 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-3 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-18 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-15 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-24 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-17 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-48 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-19 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-11 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-2 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-43 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-6 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-14 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-20 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-44 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-39 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-12 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-45 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-1 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-5 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-26 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-29 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-34 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-10 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-32 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Changed partition __consumer_offsets-40 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 0 with 16 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 1 with 17 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Sending LeaderAndIsr request to broker 2 with 17 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-13 16:25:28,949] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 50 partitions (state.change.logger)
[2024-05-13 16:25:28,950] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 7 from controller 1 for 17 partitions (state.change.logger)
[2024-05-13 16:25:28,950] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 4 from controller 1 for 16 partitions (state.change.logger)
[2024-05-13 16:25:28,950] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 5 from controller 1 for 17 partitions (state.change.logger)
[2024-05-13 16:25:28,951] INFO [Controller id=1 epoch=1] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-13 16:25:28,959] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 7 from controller 1 epoch 1 as part of the become-leader transition for 17 partitions (state.change.logger)
[2024-05-13 16:25:28,961] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 4 from controller 1 epoch 1 as part of the become-leader transition for 16 partitions (state.change.logger)
[2024-05-13 16:25:28,963] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 1 epoch 1 as part of the become-leader transition for 17 partitions (state.change.logger)
[2024-05-13 16:25:28,972] INFO [Broker id=1] Leader __consumer_offsets-37 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:28,981] INFO [Broker id=2] Leader __consumer_offsets-3 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:28,983] INFO [Broker id=0] Leader __consumer_offsets-35 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,000] INFO [Broker id=2] Leader __consumer_offsets-18 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,001] INFO [Broker id=1] Leader __consumer_offsets-7 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,014] INFO [Broker id=0] Leader __consumer_offsets-5 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,018] INFO [Broker id=2] Leader __consumer_offsets-39 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,022] INFO [Broker id=1] Leader __consumer_offsets-22 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,033] INFO [Broker id=0] Leader __consumer_offsets-20 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,037] INFO [Broker id=2] Leader __consumer_offsets-9 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,039] INFO [Broker id=1] Leader __consumer_offsets-10 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,049] INFO [Broker id=0] Leader __consumer_offsets-41 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,052] INFO [Broker id=1] Leader __consumer_offsets-31 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,054] INFO [Broker id=2] Leader __consumer_offsets-24 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,069] INFO [Broker id=1] Leader __consumer_offsets-46 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,070] INFO [Broker id=0] Leader __consumer_offsets-29 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,070] INFO [Broker id=2] Leader __consumer_offsets-27 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,084] INFO [Broker id=1] Leader __consumer_offsets-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,084] INFO [Broker id=2] Leader __consumer_offsets-42 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,084] INFO [Broker id=0] Leader __consumer_offsets-44 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,096] INFO [Broker id=2] Leader __consumer_offsets-12 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,097] INFO [Broker id=0] Leader __consumer_offsets-14 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,097] INFO [Broker id=1] Leader __consumer_offsets-16 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,112] INFO [Broker id=0] Leader __consumer_offsets-2 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,112] INFO [Broker id=1] Leader __consumer_offsets-19 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,113] INFO [Broker id=2] Leader __consumer_offsets-33 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,126] INFO [Broker id=2] Leader __consumer_offsets-48 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,126] INFO [Broker id=1] Leader __consumer_offsets-34 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,127] INFO [Broker id=0] Leader __consumer_offsets-23 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,145] INFO [Broker id=2] Leader __consumer_offsets-21 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,146] INFO [Broker id=1] Leader __consumer_offsets-4 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,146] INFO [Broker id=0] Leader __consumer_offsets-38 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,173] INFO [Broker id=2] Leader __consumer_offsets-36 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,173] INFO [Broker id=1] Leader __consumer_offsets-25 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,186] INFO [Broker id=0] Leader __consumer_offsets-8 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,189] INFO [Broker id=1] Leader __consumer_offsets-40 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,189] INFO [Broker id=2] Leader __consumer_offsets-6 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,198] INFO [Broker id=0] Leader __consumer_offsets-11 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,202] INFO [Broker id=1] Leader __consumer_offsets-43 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,203] INFO [Broker id=2] Leader __consumer_offsets-45 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,213] INFO [Broker id=0] Leader __consumer_offsets-26 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,218] INFO [Broker id=1] Leader __consumer_offsets-13 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,219] INFO [Broker id=2] Leader __consumer_offsets-15 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,228] INFO [Broker id=0] Leader __consumer_offsets-47 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,232] INFO [Broker id=1] Leader __consumer_offsets-28 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,233] INFO [Broker id=2] Leader __consumer_offsets-30 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,241] INFO [Broker id=0] Leader __consumer_offsets-17 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,244] INFO [Broker id=1] Leader __consumer_offsets-49 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,244] INFO [Broker id=2] Leader __consumer_offsets-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,255] INFO [Broker id=0] Leader __consumer_offsets-32 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-13 16:25:29,269] INFO [Broker id=1] Finished LeaderAndIsr request in 319ms correlationId 7 from controller 1 for 17 partitions (state.change.logger)
[2024-05-13 16:25:29,271] INFO [Broker id=1] Add 50 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 8 (state.change.logger)
[2024-05-13 16:25:29,274] INFO [Broker id=2] Finished LeaderAndIsr request in 324ms correlationId 5 from controller 1 for 17 partitions (state.change.logger)
[2024-05-13 16:25:29,277] INFO [Broker id=2] Add 50 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 6 (state.change.logger)
[2024-05-13 16:25:29,288] INFO [Broker id=0] Finished LeaderAndIsr request in 338ms correlationId 4 from controller 1 for 16 partitions (state.change.logger)
[2024-05-13 16:25:29,290] INFO [Broker id=0] Add 50 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 1 with correlation id 5 (state.change.logger)
[2024-05-14 14:41:58,185] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-05-14 14:41:58,239] INFO [Controller id=1 epoch=2] Sending LeaderAndIsr request to broker 1 with 19 become-leader and 2 become-follower partitions (state.change.logger)
[2024-05-14 14:41:58,243] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(1) for 21 partitions (state.change.logger)
[2024-05-14 14:41:58,296] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,297] INFO [Controller id=1 epoch=2] Partition product-created-events-topics-2 state changed to (Leader:2,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,297] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,298] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,298] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,298] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,298] INFO [Controller id=1 epoch=2] Partition product-created-events-topics-1 state changed to (Leader:-1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,298] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,298] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,298] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,298] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,299] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,299] INFO [Controller id=1 epoch=2] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,299] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,299] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,299] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,299] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,299] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,299] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,332] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,332] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,332] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,332] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,332] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,333] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,333] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,333] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,333] INFO [Controller id=1 epoch=2] Partition product-created-events-topics-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,333] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,333] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,333] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,333] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,333] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,334] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,334] INFO [Controller id=1 epoch=2] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,334] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,334] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,334] INFO [Controller id=1 epoch=2] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,334] INFO [Controller id=1 epoch=2] Partition product-created-events-topics-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:2,ZkVersion:2,ControllerEpoch:2) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-14 14:41:58,335] INFO [Controller id=1 epoch=2] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-05-14 14:41:58,335] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(1) for 36 partitions (state.change.logger)
[2024-05-14 14:41:58,343] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 21 partitions (state.change.logger)
[2024-05-14 14:41:58,392] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,396] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,397] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,397] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,397] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,398] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 1 epoch 2 as part of the become-leader transition for 19 partitions (state.change.logger)
[2024-05-14 14:41:58,398] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,398] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,399] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,399] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,399] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,400] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,400] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,400] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,401] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,401] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,402] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,402] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,403] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,403] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,403] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,404] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,404] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,404] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,404] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,405] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,405] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,405] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,406] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,406] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,406] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,407] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,407] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,408] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:41:58,410] INFO [Controller id=1 epoch=2] Changed partition product-created-events-topics-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=3, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=3) (state.change.logger)
[2024-05-14 14:41:58,410] INFO [Controller id=1 epoch=2] Changed partition product-created-events-topics-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=3, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=3) (state.change.logger)
[2024-05-14 14:41:58,410] INFO [Controller id=1 epoch=2] Sending LeaderAndIsr request to broker 1 with 2 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-14 14:41:58,410] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(1) for 2 partitions (state.change.logger)
[2024-05-14 14:41:58,416] INFO [Broker id=1] Leader __consumer_offsets-37 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,424] INFO [Broker id=1] Leader __consumer_offsets-7 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,429] INFO [Broker id=1] Leader __consumer_offsets-22 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,432] INFO [Broker id=1] Leader __consumer_offsets-10 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,435] INFO [Broker id=1] Leader __consumer_offsets-31 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,438] INFO [Broker id=1] Leader __consumer_offsets-46 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,442] INFO [Broker id=1] Leader __consumer_offsets-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,446] INFO [Broker id=1] Leader product-created-events-topic-0 starts at leader epoch 0 from offset 2 with high watermark 2 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,447] INFO [Broker id=1] Leader __consumer_offsets-16 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,450] INFO [Broker id=1] Leader __consumer_offsets-19 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,452] INFO [Broker id=1] Leader __consumer_offsets-34 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,455] INFO [Broker id=1] Leader __consumer_offsets-4 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,459] INFO [Broker id=1] Leader __consumer_offsets-25 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,462] INFO [Broker id=1] Leader __consumer_offsets-40 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,464] INFO [Broker id=1] Leader __consumer_offsets-43 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,468] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1,2,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,471] INFO [Broker id=1] Leader __consumer_offsets-13 starts at leader epoch 0 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,472] INFO [Broker id=1] Leader __consumer_offsets-28 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,474] INFO [Broker id=1] Leader __consumer_offsets-49 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,480] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition product-created-events-topics-1 (last update controller epoch 1) but cannot become follower since the new leader 0 is unavailable. (state.change.logger)
[2024-05-14 14:41:58,480] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition product-created-events-topics-2 (last update controller epoch 1) but cannot become follower since the new leader 2 is unavailable. (state.change.logger)
[2024-05-14 14:41:58,481] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 2 with correlation id 1 for 0 partitions (state.change.logger)
[2024-05-14 14:41:58,519] INFO [Broker id=1] Finished LeaderAndIsr request in 176ms correlationId 1 from controller 1 for 21 partitions (state.change.logger)
[2024-05-14 14:41:58,530] INFO [Broker id=1] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 2 (state.change.logger)
[2024-05-14 14:41:58,532] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-05-14 14:41:58,533] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 2 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-05-14 14:41:58,534] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was 0. (state.change.logger)
[2024-05-14 14:41:58,540] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 1 epoch 2 for partition product-created-events-topics-0 (last update controller epoch 2) since it is already the leader for the partition. (state.change.logger)
[2024-05-14 14:41:58,540] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 2 for partition product-created-events-topics-1 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:41:58,540] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 2 for partition product-created-events-topics-2 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:41:58,540] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 2 with correlation id 3 for 0 partitions (state.change.logger)
[2024-05-14 14:41:58,541] INFO [Broker id=1] Finished LeaderAndIsr request in 8ms correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-05-14 14:41:58,543] INFO [Broker id=1] Add 36 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 4 (state.change.logger)
[2024-05-14 14:41:58,545] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 5 from controller 1 for 2 partitions (state.change.logger)
[2024-05-14 14:41:58,545] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 1 epoch 2 as part of the become-leader transition for 2 partitions (state.change.logger)
[2024-05-14 14:41:58,546] INFO [Broker id=1] Leader product-created-events-topics-1 starts at leader epoch 3 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,548] INFO [Broker id=1] Leader product-created-events-topics-2 starts at leader epoch 3 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:41:58,551] INFO [Broker id=1] Finished LeaderAndIsr request in 6ms correlationId 5 from controller 1 for 2 partitions (state.change.logger)
[2024-05-14 14:41:58,553] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 6 (state.change.logger)
[2024-05-14 14:42:05,835] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-05-14 14:42:05,837] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(2) for 54 partitions (state.change.logger)
[2024-05-14 14:42:05,842] INFO [Controller id=1 epoch=2] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 20 become-follower partitions (state.change.logger)
[2024-05-14 14:42:05,842] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(1, 2) for 20 partitions (state.change.logger)
[2024-05-14 14:42:05,847] INFO [Broker id=1] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 8 (state.change.logger)
[2024-05-14 14:42:05,885] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:42:05,886] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:42:05,886] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:42:05,886] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:42:05,887] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:42:05,887] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:42:05,887] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:42:05,887] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:42:05,887] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:42:05,887] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:42:05,887] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:42:05,887] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:42:05,887] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:42:05,888] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:42:05,888] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:42:05,888] ERROR [Controller id=1 epoch=2] Controller 1 epoch 2 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-14 14:42:05,888] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-30 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:05,888] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-36 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:05,888] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-21 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:05,888] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-27 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:05,888] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-9 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:05,888] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-33 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:05,888] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-42 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:05,888] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:05,888] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-18 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:05,889] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-15 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:05,889] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-24 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:05,889] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-48 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:05,889] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-6 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:05,889] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:05,889] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-39 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:05,889] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-12 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:05,889] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-45 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:05,889] INFO [Controller id=1 epoch=2] Sending LeaderAndIsr request to broker 2 with 17 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-14 14:42:05,889] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(1, 2) for 17 partitions (state.change.logger)
[2024-05-14 14:42:05,891] INFO [Broker id=1] Add 17 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 9 (state.change.logger)
[2024-05-14 14:42:06,150] INFO [Broker id=2] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 0 (state.change.logger)
[2024-05-14 14:42:06,164] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 1 for 20 partitions (state.change.logger)
[2024-05-14 14:42:06,192] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-3 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:06,197] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-18 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:06,197] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-39 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:06,198] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-9 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:06,198] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-24 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:06,199] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-27 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:06,205] INFO [Broker id=2] Follower product-created-events-topics-1 starts at leader epoch 3 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,205] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-42 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:06,206] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-12 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:06,207] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-33 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:06,207] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-48 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:06,207] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-21 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:06,208] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-36 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:06,208] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-6 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:06,209] INFO [Broker id=2] Follower product-created-events-topics-0 starts at leader epoch 2 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,209] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-45 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:06,210] INFO [Broker id=2] Follower product-created-events-topics-2 starts at leader epoch 3 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,210] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-15 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:06,211] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-30 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:06,211] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-0 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:06,214] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 2 with correlation id 1 for 3 partitions (state.change.logger)
[2024-05-14 14:42:06,276] INFO [Broker id=2] Finished LeaderAndIsr request in 113ms correlationId 1 from controller 1 for 20 partitions (state.change.logger)
[2024-05-14 14:42:06,280] INFO [Broker id=2] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 2 (state.change.logger)
[2024-05-14 14:42:06,282] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 1 for 17 partitions (state.change.logger)
[2024-05-14 14:42:06,287] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 2 as part of the become-leader transition for 17 partitions (state.change.logger)
[2024-05-14 14:42:06,290] INFO [Broker id=2] Leader __consumer_offsets-3 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,295] INFO [Broker id=2] Leader __consumer_offsets-18 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,297] INFO [Broker id=2] Leader __consumer_offsets-39 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,299] INFO [Broker id=2] Leader __consumer_offsets-9 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,303] INFO [Broker id=2] Leader __consumer_offsets-24 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,306] INFO [Broker id=2] Leader __consumer_offsets-27 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,308] INFO [Broker id=2] Leader __consumer_offsets-42 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,310] INFO [Broker id=2] Leader __consumer_offsets-12 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,312] INFO [Broker id=2] Leader __consumer_offsets-33 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,314] INFO [Broker id=2] Leader __consumer_offsets-48 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,316] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(1, 2) for 1 partitions (state.change.logger)
[2024-05-14 14:42:06,317] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 10 (state.change.logger)
[2024-05-14 14:42:06,317] INFO [Broker id=2] Leader __consumer_offsets-21 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,319] INFO [Broker id=2] Leader __consumer_offsets-36 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,321] INFO [Broker id=2] Leader __consumer_offsets-6 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,324] INFO [Broker id=2] Leader __consumer_offsets-45 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,326] INFO [Broker id=2] Leader __consumer_offsets-15 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,328] INFO [Broker id=2] Leader __consumer_offsets-30 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,328] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(1, 2) for 2 partitions (state.change.logger)
[2024-05-14 14:42:06,330] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 11 (state.change.logger)
[2024-05-14 14:42:06,331] INFO [Broker id=2] Leader __consumer_offsets-0 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:06,356] INFO [Broker id=2] Finished LeaderAndIsr request in 74ms correlationId 3 from controller 1 for 17 partitions (state.change.logger)
[2024-05-14 14:42:06,359] INFO [Broker id=2] Add 17 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 4 (state.change.logger)
[2024-05-14 14:42:06,362] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 5 (state.change.logger)
[2024-05-14 14:42:06,364] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 6 (state.change.logger)
[2024-05-14 14:42:12,972] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(1, 2) for 0 partitions (state.change.logger)
[2024-05-14 14:42:12,975] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(0) for 54 partitions (state.change.logger)
[2024-05-14 14:42:12,978] INFO [Controller id=1 epoch=2] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 19 become-follower partitions (state.change.logger)
[2024-05-14 14:42:12,979] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 19 partitions (state.change.logger)
[2024-05-14 14:42:12,981] INFO [Broker id=1] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 13 (state.change.logger)
[2024-05-14 14:42:12,982] INFO [Broker id=2] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 8 (state.change.logger)
[2024-05-14 14:42:13,007] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-8 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:13,007] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-35 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:13,007] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-47 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:13,007] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-38 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:13,007] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-17 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:13,007] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-11 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:13,007] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-29 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:13,007] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-32 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:13,007] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-41 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:13,007] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-23 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:13,007] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:13,007] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-14 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:13,007] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-20 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:13,007] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-44 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:13,007] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:13,007] INFO [Controller id=1 epoch=2] Changed partition __consumer_offsets-26 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-14 14:42:13,007] INFO [Controller id=1 epoch=2] Sending LeaderAndIsr request to broker 0 with 16 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-14 14:42:13,008] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 16 partitions (state.change.logger)
[2024-05-14 14:42:13,009] INFO [Broker id=2] Add 16 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 9 (state.change.logger)
[2024-05-14 14:42:13,010] INFO [Broker id=1] Add 16 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 14 (state.change.logger)
[2024-05-14 14:42:13,287] INFO [Broker id=0] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 0 (state.change.logger)
[2024-05-14 14:42:13,304] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 1 for 19 partitions (state.change.logger)
[2024-05-14 14:42:13,332] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-35 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:13,336] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-5 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:13,336] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-20 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:13,337] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-41 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:13,344] INFO [Broker id=0] Follower product-created-events-topics-1 starts at leader epoch 3 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:13,344] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-29 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:13,344] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-44 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:13,345] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-14 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:13,345] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-2 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:13,346] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-23 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:13,346] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-38 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:13,347] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-8 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:13,347] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-11 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:13,347] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-26 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:13,349] INFO [Broker id=0] Follower product-created-events-topics-0 starts at leader epoch 2 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:13,349] INFO [Broker id=0] Follower product-created-events-topics-2 starts at leader epoch 3 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:13,349] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-47 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:13,350] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-17 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:13,350] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 2 for partition __consumer_offsets-32 (last update controller epoch 2) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-14 14:42:13,354] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 1 epoch 2 with correlation id 1 for 3 partitions (state.change.logger)
[2024-05-14 14:42:13,408] INFO [Broker id=0] Finished LeaderAndIsr request in 104ms correlationId 1 from controller 1 for 19 partitions (state.change.logger)
[2024-05-14 14:42:13,415] INFO [Broker id=0] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 2 (state.change.logger)
[2024-05-14 14:42:13,416] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-05-14 14:42:13,416] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 1 for 16 partitions (state.change.logger)
[2024-05-14 14:42:13,418] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 10 (state.change.logger)
[2024-05-14 14:42:13,418] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 15 (state.change.logger)
[2024-05-14 14:42:13,424] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 2 as part of the become-leader transition for 16 partitions (state.change.logger)
[2024-05-14 14:42:13,425] INFO [Controller id=1 epoch=2] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 2 partitions (state.change.logger)
[2024-05-14 14:42:13,427] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 11 (state.change.logger)
[2024-05-14 14:42:13,428] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 16 (state.change.logger)
[2024-05-14 14:42:13,432] INFO [Broker id=0] Leader __consumer_offsets-35 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:13,436] INFO [Broker id=0] Leader __consumer_offsets-5 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:13,439] INFO [Broker id=0] Leader __consumer_offsets-20 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:13,441] INFO [Broker id=0] Leader __consumer_offsets-41 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:13,443] INFO [Broker id=0] Leader __consumer_offsets-29 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:13,446] INFO [Broker id=0] Leader __consumer_offsets-44 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:13,447] INFO [Broker id=0] Leader __consumer_offsets-14 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:13,449] INFO [Broker id=0] Leader __consumer_offsets-2 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:13,451] INFO [Broker id=0] Leader __consumer_offsets-23 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:13,452] INFO [Broker id=0] Leader __consumer_offsets-38 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:13,454] INFO [Broker id=0] Leader __consumer_offsets-8 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:13,456] INFO [Broker id=0] Leader __consumer_offsets-11 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:13,459] INFO [Broker id=0] Leader __consumer_offsets-26 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:13,461] INFO [Broker id=0] Leader __consumer_offsets-47 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:13,463] INFO [Broker id=0] Leader __consumer_offsets-17 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:13,465] INFO [Broker id=0] Leader __consumer_offsets-32 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-14 14:42:13,486] INFO [Broker id=0] Finished LeaderAndIsr request in 69ms correlationId 3 from controller 1 for 16 partitions (state.change.logger)
[2024-05-14 14:42:13,487] INFO [Broker id=0] Add 16 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 4 (state.change.logger)
[2024-05-14 14:42:13,489] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 5 (state.change.logger)
[2024-05-14 14:42:13,491] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 2 with correlation id 6 (state.change.logger)
[2024-05-15 15:06:46,791] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-05-15 15:06:46,827] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 1 with 21 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-15 15:06:46,829] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(1) for 21 partitions (state.change.logger)
[2024-05-15 15:06:46,873] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,874] INFO [Controller id=1 epoch=3] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,874] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,874] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,875] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,875] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,875] INFO [Controller id=1 epoch=3] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,875] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,875] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,875] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,875] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,875] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,875] INFO [Controller id=1 epoch=3] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:5,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,875] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,875] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,875] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,876] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,876] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,876] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,941] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,942] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,942] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,942] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,942] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,942] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,942] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,942] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,942] INFO [Controller id=1 epoch=3] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:7,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,942] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,942] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,942] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,943] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,943] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,943] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,943] INFO [Controller id=1 epoch=3] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:6,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,943] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,943] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,943] INFO [Controller id=1 epoch=3] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,943] INFO [Controller id=1 epoch=3] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:7,ControllerEpoch:3) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-15 15:06:46,943] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 1 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-15 15:06:46,943] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(1) for 36 partitions (state.change.logger)
[2024-05-15 15:06:46,956] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 21 partitions (state.change.logger)
[2024-05-15 15:06:46,991] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,994] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,994] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,995] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,995] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,995] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,995] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,995] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,996] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,996] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,996] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,997] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,997] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,998] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,998] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,998] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,998] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,999] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,999] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,999] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:46,999] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:47,000] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:47,000] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:47,001] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:47,001] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:47,001] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:47,001] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:47,002] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:47,002] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:47,002] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:47,002] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:47,003] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:47,003] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:47,004] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-15 15:06:47,006] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 1 epoch 3 as part of the become-leader transition for 21 partitions (state.change.logger)
[2024-05-15 15:06:47,025] INFO [Broker id=1] Leader __consumer_offsets-37 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,031] INFO [Broker id=1] Leader __consumer_offsets-7 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,035] INFO [Broker id=1] Leader __consumer_offsets-22 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,038] INFO [Broker id=1] Leader product-created-events-topics-1 starts at leader epoch 3 from offset 0 with high watermark 0 ISR [1,2,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,042] INFO [Broker id=1] Leader __consumer_offsets-10 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,045] INFO [Broker id=1] Leader __consumer_offsets-31 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,048] INFO [Broker id=1] Leader __consumer_offsets-46 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,050] INFO [Broker id=1] Leader __consumer_offsets-1 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,053] INFO [Broker id=1] Leader product-created-events-topic-0 starts at leader epoch 0 from offset 9 with high watermark 9 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,053] INFO [Broker id=1] Leader __consumer_offsets-16 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,055] INFO [Broker id=1] Leader __consumer_offsets-19 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,058] INFO [Broker id=1] Leader __consumer_offsets-34 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,061] INFO [Broker id=1] Leader __consumer_offsets-4 starts at leader epoch 0 from offset 1 with high watermark 1 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,061] INFO [Broker id=1] Leader __consumer_offsets-25 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,064] INFO [Broker id=1] Leader __consumer_offsets-40 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,066] INFO [Broker id=1] Leader __consumer_offsets-43 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,070] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1,2,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,072] INFO [Broker id=1] Leader __consumer_offsets-13 starts at leader epoch 0 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,073] INFO [Broker id=1] Leader __consumer_offsets-28 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,076] INFO [Broker id=1] Leader product-created-events-topics-2 starts at leader epoch 3 from offset 0 with high watermark 0 ISR [1,2,0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,079] INFO [Broker id=1] Leader __consumer_offsets-49 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:47,117] INFO [Broker id=1] Finished LeaderAndIsr request in 163ms correlationId 1 from controller 1 for 21 partitions (state.change.logger)
[2024-05-15 15:06:47,128] INFO [Broker id=1] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 2 (state.change.logger)
[2024-05-15 15:06:47,129] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-05-15 15:06:47,131] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 3 as part of the become-leader transition for 3 partitions (state.change.logger)
[2024-05-15 15:06:47,131] INFO [Broker id=1] Leader product-created-events-topics-1 starts at leader epoch 5 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was 3. (state.change.logger)
[2024-05-15 15:06:47,137] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 1 epoch 3 for partition product-created-events-topics-1 (last update controller epoch 3) since it is already the leader for the partition. (state.change.logger)
[2024-05-15 15:06:47,137] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was 2. (state.change.logger)
[2024-05-15 15:06:47,139] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 1 epoch 3 for partition product-created-events-topics-0 (last update controller epoch 3) since it is already the leader for the partition. (state.change.logger)
[2024-05-15 15:06:47,140] INFO [Broker id=1] Leader product-created-events-topics-2 starts at leader epoch 5 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was 3. (state.change.logger)
[2024-05-15 15:06:47,142] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 1 epoch 3 for partition product-created-events-topics-2 (last update controller epoch 3) since it is already the leader for the partition. (state.change.logger)
[2024-05-15 15:06:47,142] INFO [Broker id=1] Finished LeaderAndIsr request in 13ms correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-05-15 15:06:47,144] INFO [Broker id=1] Add 36 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 4 (state.change.logger)
[2024-05-15 15:06:54,618] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-05-15 15:06:54,621] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(2) for 54 partitions (state.change.logger)
[2024-05-15 15:06:54,629] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 20 become-follower partitions (state.change.logger)
[2024-05-15 15:06:54,629] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(1, 2) for 20 partitions (state.change.logger)
[2024-05-15 15:06:54,631] INFO [Broker id=1] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 6 (state.change.logger)
[2024-05-15 15:06:54,673] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:54,674] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:54,674] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:54,674] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:54,674] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:54,675] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:54,675] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:54,675] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:54,675] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:54,675] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:54,675] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:54,676] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:54,676] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:54,676] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:54,677] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:54,679] ERROR [Controller id=1 epoch=3] Controller 1 epoch 3 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-15 15:06:54,682] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-30 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=4, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:06:54,682] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-36 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=4, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:06:54,682] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-21 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=4, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:06:54,682] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-27 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=4, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:06:54,682] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-9 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=4, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:06:54,682] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-33 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=4, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:06:54,682] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-42 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=4, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:06:54,682] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=4, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:06:54,682] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-18 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=4, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:06:54,682] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-15 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=4, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:06:54,682] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-24 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=4, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:06:54,682] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-48 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=4, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:06:54,682] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-6 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=4, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:06:54,682] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=4, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:06:54,682] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-39 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=4, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:06:54,682] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-12 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=4, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:06:54,682] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-45 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=4, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:06:54,682] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 2 with 17 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-15 15:06:54,683] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(1, 2) for 17 partitions (state.change.logger)
[2024-05-15 15:06:54,685] INFO [Broker id=1] Add 17 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 7 (state.change.logger)
[2024-05-15 15:06:54,958] INFO [Broker id=2] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 0 (state.change.logger)
[2024-05-15 15:06:54,973] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 1 for 20 partitions (state.change.logger)
[2024-05-15 15:06:55,000] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-3 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:06:55,005] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-18 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:06:55,005] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-39 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:06:55,006] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-9 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:06:55,006] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-24 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:06:55,006] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-27 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:06:55,012] INFO [Broker id=2] Follower product-created-events-topics-1 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,012] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-42 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:06:55,013] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-12 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:06:55,014] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-33 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:06:55,014] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-48 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:06:55,014] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-21 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:06:55,016] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-36 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:06:55,017] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-6 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:06:55,018] INFO [Broker id=2] Follower product-created-events-topics-0 starts at leader epoch 4 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,018] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-45 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:06:55,019] INFO [Broker id=2] Follower product-created-events-topics-2 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,019] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-15 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:06:55,019] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-30 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:06:55,020] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-0 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:06:55,023] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 3 with correlation id 1 for 3 partitions (state.change.logger)
[2024-05-15 15:06:55,080] INFO [Broker id=2] Finished LeaderAndIsr request in 107ms correlationId 1 from controller 1 for 20 partitions (state.change.logger)
[2024-05-15 15:06:55,085] INFO [Broker id=2] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 2 (state.change.logger)
[2024-05-15 15:06:55,087] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 1 for 17 partitions (state.change.logger)
[2024-05-15 15:06:55,092] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 3 as part of the become-leader transition for 17 partitions (state.change.logger)
[2024-05-15 15:06:55,095] INFO [Broker id=2] Leader __consumer_offsets-3 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,101] INFO [Broker id=2] Leader __consumer_offsets-18 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,104] INFO [Broker id=2] Leader __consumer_offsets-39 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,106] INFO [Broker id=2] Leader __consumer_offsets-9 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,109] INFO [Broker id=2] Leader __consumer_offsets-24 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,112] INFO [Broker id=2] Leader __consumer_offsets-27 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,114] INFO [Broker id=2] Leader __consumer_offsets-42 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,117] INFO [Broker id=2] Leader __consumer_offsets-12 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,119] INFO [Broker id=2] Leader __consumer_offsets-33 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,121] INFO [Broker id=2] Leader __consumer_offsets-48 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,124] INFO [Broker id=2] Leader __consumer_offsets-21 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,126] INFO [Broker id=2] Leader __consumer_offsets-36 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,126] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(1, 2) for 1 partitions (state.change.logger)
[2024-05-15 15:06:55,127] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 8 (state.change.logger)
[2024-05-15 15:06:55,128] INFO [Broker id=2] Leader __consumer_offsets-6 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,130] INFO [Broker id=2] Leader __consumer_offsets-45 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,132] INFO [Broker id=2] Leader __consumer_offsets-15 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,134] INFO [Broker id=2] Leader __consumer_offsets-30 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,136] INFO [Broker id=2] Leader __consumer_offsets-0 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:06:55,141] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(1, 2) for 2 partitions (state.change.logger)
[2024-05-15 15:06:55,142] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 9 (state.change.logger)
[2024-05-15 15:06:55,157] INFO [Broker id=2] Finished LeaderAndIsr request in 70ms correlationId 3 from controller 1 for 17 partitions (state.change.logger)
[2024-05-15 15:06:55,160] INFO [Broker id=2] Add 17 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 4 (state.change.logger)
[2024-05-15 15:06:55,163] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 5 (state.change.logger)
[2024-05-15 15:06:55,166] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 6 (state.change.logger)
[2024-05-15 15:07:02,429] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(1, 2) for 0 partitions (state.change.logger)
[2024-05-15 15:07:02,430] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(0) for 54 partitions (state.change.logger)
[2024-05-15 15:07:02,432] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 19 become-follower partitions (state.change.logger)
[2024-05-15 15:07:02,432] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 19 partitions (state.change.logger)
[2024-05-15 15:07:02,435] INFO [Broker id=2] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 8 (state.change.logger)
[2024-05-15 15:07:02,439] INFO [Broker id=1] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 11 (state.change.logger)
[2024-05-15 15:07:02,460] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-8 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:07:02,461] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-35 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:07:02,461] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-47 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:07:02,461] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-38 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:07:02,461] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-17 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:07:02,461] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-11 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:07:02,461] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-29 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:07:02,461] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-32 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:07:02,461] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-41 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:07:02,461] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-23 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:07:02,461] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:07:02,461] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-14 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:07:02,461] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-20 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:07:02,461] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-44 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:07:02,461] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:07:02,461] INFO [Controller id=1 epoch=3] Changed partition __consumer_offsets-26 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-15 15:07:02,461] INFO [Controller id=1 epoch=3] Sending LeaderAndIsr request to broker 0 with 16 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-15 15:07:02,461] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 16 partitions (state.change.logger)
[2024-05-15 15:07:02,463] INFO [Broker id=1] Add 16 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 12 (state.change.logger)
[2024-05-15 15:07:02,464] INFO [Broker id=2] Add 16 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 9 (state.change.logger)
[2024-05-15 15:07:02,752] INFO [Broker id=0] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 0 (state.change.logger)
[2024-05-15 15:07:02,766] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 1 for 19 partitions (state.change.logger)
[2024-05-15 15:07:02,791] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-35 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:07:02,794] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-5 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:07:02,795] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-20 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:07:02,795] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-41 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:07:02,800] INFO [Broker id=0] Follower product-created-events-topics-1 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:07:02,800] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-29 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:07:02,800] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-44 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:07:02,801] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-14 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:07:02,801] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-2 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:07:02,802] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-23 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:07:02,802] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-38 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:07:02,802] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-8 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:07:02,803] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-11 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:07:02,803] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-26 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:07:02,804] INFO [Broker id=0] Follower product-created-events-topics-0 starts at leader epoch 4 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:07:02,804] INFO [Broker id=0] Follower product-created-events-topics-2 starts at leader epoch 5 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:07:02,804] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-47 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:07:02,804] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-17 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:07:02,805] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 3 for partition __consumer_offsets-32 (last update controller epoch 3) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-15 15:07:02,808] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 1 epoch 3 with correlation id 1 for 3 partitions (state.change.logger)
[2024-05-15 15:07:02,856] INFO [Broker id=0] Finished LeaderAndIsr request in 90ms correlationId 1 from controller 1 for 19 partitions (state.change.logger)
[2024-05-15 15:07:02,861] INFO [Broker id=0] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 2 (state.change.logger)
[2024-05-15 15:07:02,863] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 1 for 16 partitions (state.change.logger)
[2024-05-15 15:07:02,864] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-05-15 15:07:02,865] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 13 (state.change.logger)
[2024-05-15 15:07:02,866] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 10 (state.change.logger)
[2024-05-15 15:07:02,870] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 3 as part of the become-leader transition for 16 partitions (state.change.logger)
[2024-05-15 15:07:02,872] INFO [Controller id=1 epoch=3] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 2 partitions (state.change.logger)
[2024-05-15 15:07:02,874] INFO [Broker id=0] Leader __consumer_offsets-35 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:07:02,874] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 14 (state.change.logger)
[2024-05-15 15:07:02,874] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 11 (state.change.logger)
[2024-05-15 15:07:02,880] INFO [Broker id=0] Leader __consumer_offsets-5 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:07:02,882] INFO [Broker id=0] Leader __consumer_offsets-20 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:07:02,885] INFO [Broker id=0] Leader __consumer_offsets-41 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:07:02,886] INFO [Broker id=0] Leader __consumer_offsets-29 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:07:02,888] INFO [Broker id=0] Leader __consumer_offsets-44 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:07:02,890] INFO [Broker id=0] Leader __consumer_offsets-14 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:07:02,892] INFO [Broker id=0] Leader __consumer_offsets-2 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:07:02,894] INFO [Broker id=0] Leader __consumer_offsets-23 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:07:02,896] INFO [Broker id=0] Leader __consumer_offsets-38 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:07:02,898] INFO [Broker id=0] Leader __consumer_offsets-8 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:07:02,900] INFO [Broker id=0] Leader __consumer_offsets-11 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:07:02,902] INFO [Broker id=0] Leader __consumer_offsets-26 starts at leader epoch 4 from offset 37 with high watermark 37 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:07:02,903] INFO [Broker id=0] Leader __consumer_offsets-47 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:07:02,905] INFO [Broker id=0] Leader __consumer_offsets-17 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:07:02,907] INFO [Broker id=0] Leader __consumer_offsets-32 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-15 15:07:02,926] INFO [Broker id=0] Finished LeaderAndIsr request in 63ms correlationId 3 from controller 1 for 16 partitions (state.change.logger)
[2024-05-15 15:07:02,928] INFO [Broker id=0] Add 16 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 4 (state.change.logger)
[2024-05-15 15:07:02,930] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 5 (state.change.logger)
[2024-05-15 15:07:02,931] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 3 with correlation id 6 (state.change.logger)
[2024-05-16 14:01:01,011] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet(2) for 0 partitions (state.change.logger)
[2024-05-16 14:01:01,060] INFO [Controller id=2 epoch=4] Sending LeaderAndIsr request to broker 2 with 17 become-leader and 3 become-follower partitions (state.change.logger)
[2024-05-16 14:01:01,063] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet(2) for 20 partitions (state.change.logger)
[2024-05-16 14:01:01,115] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,115] INFO [Controller id=2 epoch=4] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:10,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,116] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,116] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,116] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,116] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,116] INFO [Controller id=2 epoch=4] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:10,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,116] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,116] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,117] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,117] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,117] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,117] INFO [Controller id=2 epoch=4] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:9,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,117] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,117] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,117] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,117] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,117] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,118] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:4) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,140] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,140] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,140] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,140] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,140] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,140] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,141] INFO [Controller id=2 epoch=4] Partition product-created-events-topic-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,141] INFO [Controller id=2 epoch=4] Partition product-created-events-topics-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:10,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,141] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,141] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,141] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,141] INFO [Controller id=2 epoch=4] Partition product-created-events-topics-1 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:11,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,141] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,141] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,141] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,141] INFO [Controller id=2 epoch=4] Partition product-created-events-topics-2 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:11,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,141] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,141] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,142] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,142] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,142] INFO [Controller id=2 epoch=4] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:4) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 14:01:01,142] INFO [Controller id=2 epoch=4] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-05-16 14:01:01,142] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet(2) for 37 partitions (state.change.logger)
[2024-05-16 14:01:01,153] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 2 for 20 partitions (state.change.logger)
[2024-05-16 14:01:01,193] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,196] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,196] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,196] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,196] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,197] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition product-created-events-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,197] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,197] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,197] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,198] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,198] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,198] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,199] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,199] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,199] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,199] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,200] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,200] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,200] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,200] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,200] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 2 epoch 4 as part of the become-leader transition for 17 partitions (state.change.logger)
[2024-05-16 14:01:01,201] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,201] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,201] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,201] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,202] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,202] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,202] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,202] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,203] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,203] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,203] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,203] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,204] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,204] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:01,205] INFO [Controller id=2 epoch=4] Changed partition product-created-events-topics-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-05-16 14:01:01,205] INFO [Controller id=2 epoch=4] Changed partition product-created-events-topics-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-05-16 14:01:01,206] INFO [Controller id=2 epoch=4] Changed partition product-created-events-topics-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=7, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=11) (state.change.logger)
[2024-05-16 14:01:01,206] INFO [Controller id=2 epoch=4] Sending LeaderAndIsr request to broker 2 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-16 14:01:01,206] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet(2) for 3 partitions (state.change.logger)
[2024-05-16 14:01:01,215] INFO [Broker id=2] Leader __consumer_offsets-3 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,222] INFO [Broker id=2] Leader __consumer_offsets-18 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,225] INFO [Broker id=2] Leader __consumer_offsets-39 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,227] INFO [Broker id=2] Leader __consumer_offsets-9 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,230] INFO [Broker id=2] Leader __consumer_offsets-24 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,232] INFO [Broker id=2] Leader __consumer_offsets-27 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,236] INFO [Broker id=2] Leader __consumer_offsets-42 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,239] INFO [Broker id=2] Leader __consumer_offsets-12 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,242] INFO [Broker id=2] Leader __consumer_offsets-33 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,245] INFO [Broker id=2] Leader __consumer_offsets-48 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,247] INFO [Broker id=2] Leader __consumer_offsets-21 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,250] INFO [Broker id=2] Leader __consumer_offsets-36 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,253] INFO [Broker id=2] Leader __consumer_offsets-6 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,255] INFO [Broker id=2] Leader __consumer_offsets-45 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,257] INFO [Broker id=2] Leader __consumer_offsets-15 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,261] INFO [Broker id=2] Leader __consumer_offsets-30 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,264] INFO [Broker id=2] Leader __consumer_offsets-0 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,268] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition product-created-events-topics-1 (last update controller epoch 3) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2024-05-16 14:01:01,269] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition product-created-events-topics-0 (last update controller epoch 3) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2024-05-16 14:01:01,269] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition product-created-events-topics-2 (last update controller epoch 3) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2024-05-16 14:01:01,271] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 2 epoch 4 with correlation id 1 for 0 partitions (state.change.logger)
[2024-05-16 14:01:01,339] INFO [Broker id=2] Finished LeaderAndIsr request in 186ms correlationId 1 from controller 2 for 20 partitions (state.change.logger)
[2024-05-16 14:01:01,350] INFO [Broker id=2] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 2 (state.change.logger)
[2024-05-16 14:01:01,352] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 2 for 3 partitions (state.change.logger)
[2024-05-16 14:01:01,352] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 3 from controller 2 epoch 4 for partition product-created-events-topics-1 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:01,353] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 3 from controller 2 epoch 4 for partition product-created-events-topics-0 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:01,353] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 3 from controller 2 epoch 4 for partition product-created-events-topics-2 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:01,353] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 2 epoch 4 with correlation id 3 for 0 partitions (state.change.logger)
[2024-05-16 14:01:01,353] INFO [Broker id=2] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 2 for 3 partitions (state.change.logger)
[2024-05-16 14:01:01,355] INFO [Broker id=2] Add 37 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 4 (state.change.logger)
[2024-05-16 14:01:01,357] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 5 from controller 2 for 3 partitions (state.change.logger)
[2024-05-16 14:01:01,358] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 2 epoch 4 as part of the become-leader transition for 3 partitions (state.change.logger)
[2024-05-16 14:01:01,359] INFO [Broker id=2] Leader product-created-events-topics-1 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,362] INFO [Broker id=2] Leader product-created-events-topics-0 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,365] INFO [Broker id=2] Leader product-created-events-topics-2 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:01,368] INFO [Broker id=2] Finished LeaderAndIsr request in 11ms correlationId 5 from controller 2 for 3 partitions (state.change.logger)
[2024-05-16 14:01:01,370] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 6 (state.change.logger)
[2024-05-16 14:01:07,945] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet(2) for 0 partitions (state.change.logger)
[2024-05-16 14:01:07,949] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet(0) for 54 partitions (state.change.logger)
[2024-05-16 14:01:07,954] INFO [Controller id=2 epoch=4] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 19 become-follower partitions (state.change.logger)
[2024-05-16 14:01:07,954] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet(0, 2) for 19 partitions (state.change.logger)
[2024-05-16 14:01:07,956] INFO [Broker id=2] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 8 (state.change.logger)
[2024-05-16 14:01:07,990] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:07,990] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:07,990] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:07,990] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:07,991] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition product-created-events-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:07,991] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:07,991] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:07,991] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:07,991] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:07,991] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:07,992] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:07,992] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:07,992] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:07,992] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:07,992] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:07,992] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:07,992] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:07,992] ERROR [Controller id=2 epoch=4] Controller 2 epoch 4 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 14:01:07,993] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-35 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 14:01:07,993] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-38 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 14:01:07,993] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-17 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 14:01:07,993] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-8 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 14:01:07,993] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-41 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 14:01:07,993] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-23 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 14:01:07,993] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-47 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 14:01:07,993] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-11 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 14:01:07,993] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 14:01:07,993] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-14 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 14:01:07,993] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-20 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 14:01:07,993] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-44 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 14:01:07,993] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 14:01:07,993] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-26 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 14:01:07,993] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-29 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 14:01:07,993] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-32 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=6, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 14:01:07,993] INFO [Controller id=2 epoch=4] Sending LeaderAndIsr request to broker 0 with 16 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-16 14:01:07,993] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet(0, 2) for 16 partitions (state.change.logger)
[2024-05-16 14:01:07,995] INFO [Broker id=2] Add 16 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 9 (state.change.logger)
[2024-05-16 14:01:08,324] INFO [Broker id=0] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 0 (state.change.logger)
[2024-05-16 14:01:08,344] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 2 for 19 partitions (state.change.logger)
[2024-05-16 14:01:08,373] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-35 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:08,379] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-5 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:08,379] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-20 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:08,379] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-41 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:08,387] INFO [Broker id=0] Follower product-created-events-topics-1 starts at leader epoch 8 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:08,387] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-29 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:08,388] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-44 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:08,389] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-14 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:08,390] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-2 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:08,391] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-23 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:08,392] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-38 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:08,393] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-8 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:08,393] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-11 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:08,394] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-26 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:08,395] INFO [Broker id=0] Follower product-created-events-topics-0 starts at leader epoch 7 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:08,395] INFO [Broker id=0] Follower product-created-events-topics-2 starts at leader epoch 8 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:08,395] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-47 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:08,396] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-17 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:08,396] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-32 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:08,400] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 2 epoch 4 with correlation id 1 for 3 partitions (state.change.logger)
[2024-05-16 14:01:08,474] INFO [Broker id=0] Finished LeaderAndIsr request in 130ms correlationId 1 from controller 2 for 19 partitions (state.change.logger)
[2024-05-16 14:01:08,480] INFO [Broker id=0] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 2 (state.change.logger)
[2024-05-16 14:01:08,482] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 2 for 16 partitions (state.change.logger)
[2024-05-16 14:01:08,487] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 2 epoch 4 as part of the become-leader transition for 16 partitions (state.change.logger)
[2024-05-16 14:01:08,493] INFO [Broker id=0] Leader __consumer_offsets-35 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:08,498] INFO [Broker id=0] Leader __consumer_offsets-5 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:08,501] INFO [Broker id=0] Leader __consumer_offsets-20 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:08,504] INFO [Broker id=0] Leader __consumer_offsets-41 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:08,506] INFO [Broker id=0] Leader __consumer_offsets-29 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:08,510] INFO [Broker id=0] Leader __consumer_offsets-44 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:08,513] INFO [Broker id=0] Leader __consumer_offsets-14 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:08,517] INFO [Broker id=0] Leader __consumer_offsets-2 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:08,521] INFO [Broker id=0] Leader __consumer_offsets-23 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:08,524] INFO [Broker id=0] Leader __consumer_offsets-38 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:08,526] INFO [Broker id=0] Leader __consumer_offsets-8 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:08,529] INFO [Broker id=0] Leader __consumer_offsets-11 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:08,531] INFO [Broker id=0] Leader __consumer_offsets-26 starts at leader epoch 6 from offset 62 with high watermark 62 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:08,534] INFO [Broker id=0] Leader __consumer_offsets-47 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:08,537] INFO [Broker id=0] Leader __consumer_offsets-17 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:08,537] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet(0, 2) for 1 partitions (state.change.logger)
[2024-05-16 14:01:08,538] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 10 (state.change.logger)
[2024-05-16 14:01:08,539] INFO [Broker id=0] Leader __consumer_offsets-32 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:08,551] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet(0, 2) for 2 partitions (state.change.logger)
[2024-05-16 14:01:08,552] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 11 (state.change.logger)
[2024-05-16 14:01:08,560] INFO [Broker id=0] Finished LeaderAndIsr request in 78ms correlationId 3 from controller 2 for 16 partitions (state.change.logger)
[2024-05-16 14:01:08,562] INFO [Broker id=0] Add 16 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 4 (state.change.logger)
[2024-05-16 14:01:08,563] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 5 (state.change.logger)
[2024-05-16 14:01:08,565] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 6 (state.change.logger)
[2024-05-16 14:01:25,109] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet(0, 2) for 0 partitions (state.change.logger)
[2024-05-16 14:01:25,110] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet(1) for 54 partitions (state.change.logger)
[2024-05-16 14:01:25,112] INFO [Controller id=2 epoch=4] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 21 become-follower partitions (state.change.logger)
[2024-05-16 14:01:25,112] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 21 partitions (state.change.logger)
[2024-05-16 14:01:25,114] INFO [Broker id=2] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 13 (state.change.logger)
[2024-05-16 14:01:25,116] INFO [Broker id=0] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 8 (state.change.logger)
[2024-05-16 14:01:25,139] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-22 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 14:01:25,139] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 14:01:25,139] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-25 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 14:01:25,139] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-49 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 14:01:25,140] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-31 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 14:01:25,140] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-37 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 14:01:25,140] INFO [Controller id=2 epoch=4] Changed partition product-created-events-topic-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 14:01:25,140] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-19 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 14:01:25,140] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-13 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 14:01:25,140] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-43 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 14:01:25,140] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 14:01:25,140] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-34 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 14:01:25,140] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-7 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 14:01:25,140] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-46 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 14:01:25,140] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-16 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 14:01:25,140] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-28 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 14:01:25,140] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-10 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 14:01:25,140] INFO [Controller id=2 epoch=4] Changed partition __consumer_offsets-40 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 14:01:25,140] INFO [Controller id=2 epoch=4] Sending LeaderAndIsr request to broker 1 with 18 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-16 14:01:25,140] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 18 partitions (state.change.logger)
[2024-05-16 14:01:25,142] INFO [Broker id=2] Add 18 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 14 (state.change.logger)
[2024-05-16 14:01:25,142] INFO [Broker id=0] Add 18 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 9 (state.change.logger)
[2024-05-16 14:01:25,409] INFO [Broker id=1] Add 54 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 0 (state.change.logger)
[2024-05-16 14:01:25,427] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 2 for 21 partitions (state.change.logger)
[2024-05-16 14:01:25,455] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-37 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:25,459] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-7 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:25,460] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-22 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:25,465] INFO [Broker id=1] Follower product-created-events-topics-1 starts at leader epoch 8 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,465] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-10 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:25,466] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-31 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:25,466] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-46 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:25,467] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-1 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:25,467] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition product-created-events-topic-0 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:25,468] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-16 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:25,469] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-19 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:25,469] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-34 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:25,469] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-4 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:25,470] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-25 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:25,470] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-40 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:25,470] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-43 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:25,471] INFO [Broker id=1] Follower product-created-events-topics-0 starts at leader epoch 7 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,471] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-13 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:25,471] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-28 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:25,472] INFO [Broker id=1] Follower product-created-events-topics-2 starts at leader epoch 8 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,472] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 4 for partition __consumer_offsets-49 (last update controller epoch 4) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 14:01:25,475] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 2 epoch 4 with correlation id 1 for 3 partitions (state.change.logger)
[2024-05-16 14:01:25,524] INFO [Broker id=1] Finished LeaderAndIsr request in 98ms correlationId 1 from controller 2 for 21 partitions (state.change.logger)
[2024-05-16 14:01:25,529] INFO [Broker id=1] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 2 (state.change.logger)
[2024-05-16 14:01:25,531] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 2 for 18 partitions (state.change.logger)
[2024-05-16 14:01:25,532] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-05-16 14:01:25,535] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 15 (state.change.logger)
[2024-05-16 14:01:25,536] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 10 (state.change.logger)
[2024-05-16 14:01:25,540] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 2 epoch 4 as part of the become-leader transition for 18 partitions (state.change.logger)
[2024-05-16 14:01:25,542] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 2 partitions (state.change.logger)
[2024-05-16 14:01:25,544] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 16 (state.change.logger)
[2024-05-16 14:01:25,544] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 11 (state.change.logger)
[2024-05-16 14:01:25,544] INFO [Broker id=1] Leader __consumer_offsets-37 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,550] INFO [Broker id=1] Leader __consumer_offsets-7 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,553] INFO [Broker id=1] Leader __consumer_offsets-22 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,555] INFO [Broker id=1] Leader __consumer_offsets-10 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,557] INFO [Broker id=1] Leader __consumer_offsets-31 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,559] INFO [Broker id=1] Leader __consumer_offsets-46 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,561] INFO [Broker id=1] Leader __consumer_offsets-1 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,563] INFO [Broker id=1] Leader product-created-events-topic-0 starts at leader epoch 2 from offset 13 with high watermark 13 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,565] INFO [Broker id=1] Leader __consumer_offsets-16 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,568] INFO [Broker id=1] Leader __consumer_offsets-19 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,569] INFO [Broker id=1] Leader __consumer_offsets-34 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,571] INFO [Broker id=1] Leader __consumer_offsets-4 starts at leader epoch 2 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,573] INFO [Broker id=1] Leader __consumer_offsets-25 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,575] INFO [Broker id=1] Leader __consumer_offsets-40 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,577] INFO [Broker id=1] Leader __consumer_offsets-43 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,579] INFO [Broker id=1] Leader __consumer_offsets-13 starts at leader epoch 2 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,581] INFO [Broker id=1] Leader __consumer_offsets-28 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,583] INFO [Broker id=1] Leader __consumer_offsets-49 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:01:25,601] INFO [Broker id=1] Finished LeaderAndIsr request in 70ms correlationId 3 from controller 2 for 18 partitions (state.change.logger)
[2024-05-16 14:01:25,604] INFO [Broker id=1] Add 18 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 4 (state.change.logger)
[2024-05-16 14:01:25,607] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 5 (state.change.logger)
[2024-05-16 14:01:25,609] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 6 (state.change.logger)
[2024-05-16 14:37:55,662] INFO [Controller id=2 epoch=4] Changed partition product-created-events-topic.DLT-0 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-16 14:37:55,662] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-16 14:37:55,664] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-16 14:37:55,676] INFO [Controller id=2 epoch=4] Changed partition product-created-events-topic.DLT-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-16 14:37:55,676] INFO [Controller id=2 epoch=4] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-16 14:37:55,677] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-05-16 14:37:55,677] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-16 14:37:55,680] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 7 from controller 2 for 1 partitions (state.change.logger)
[2024-05-16 14:37:55,681] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 17 (state.change.logger)
[2024-05-16 14:37:55,681] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 12 (state.change.logger)
[2024-05-16 14:37:55,683] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 7 from controller 2 epoch 4 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-05-16 14:37:55,699] INFO [Broker id=1] Leader product-created-events-topic.DLT-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:37:55,704] INFO [Broker id=1] Finished LeaderAndIsr request in 24ms correlationId 7 from controller 2 for 1 partitions (state.change.logger)
[2024-05-16 14:37:55,706] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 8 (state.change.logger)
[2024-05-16 14:40:50,772] INFO [Controller id=2 epoch=4] Changed partition product-List-evnt-0 state from NonExistentPartition to NewPartition with assigned replicas 1 (state.change.logger)
[2024-05-16 14:40:50,772] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-16 14:40:50,772] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-16 14:40:50,780] INFO [Controller id=2 epoch=4] Changed partition product-List-evnt-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=0, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-16 14:40:50,780] INFO [Controller id=2 epoch=4] Sending LeaderAndIsr request to broker 1 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-16 14:40:50,780] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-05-16 14:40:50,781] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-16 14:40:50,781] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 9 from controller 2 for 1 partitions (state.change.logger)
[2024-05-16 14:40:50,782] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 18 (state.change.logger)
[2024-05-16 14:40:50,782] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 13 (state.change.logger)
[2024-05-16 14:40:50,783] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 9 from controller 2 epoch 4 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-05-16 14:40:50,792] INFO [Broker id=1] Leader product-List-evnt-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 14:40:50,795] INFO [Broker id=1] Finished LeaderAndIsr request in 14ms correlationId 9 from controller 2 for 1 partitions (state.change.logger)
[2024-05-16 14:40:50,796] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 10 (state.change.logger)
[2024-05-16 15:53:23,280] INFO [Controller id=2 epoch=4] Changed partition product-List-event-0 state from NonExistentPartition to NewPartition with assigned replicas 2 (state.change.logger)
[2024-05-16 15:53:23,281] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-16 15:53:23,281] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-16 15:53:23,288] INFO [Controller id=2 epoch=4] Changed partition product-List-event-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=0, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-05-16 15:53:23,289] INFO [Controller id=2 epoch=4] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-16 15:53:23,289] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-05-16 15:53:23,289] INFO [Controller id=2 epoch=4] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-16 15:53:23,292] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 19 from controller 2 for 1 partitions (state.change.logger)
[2024-05-16 15:53:23,294] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 19 from controller 2 epoch 4 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-05-16 15:53:23,293] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 14 (state.change.logger)
[2024-05-16 15:53:23,294] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 11 (state.change.logger)
[2024-05-16 15:53:23,312] INFO [Broker id=2] Leader product-List-event-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 15:53:23,316] INFO [Broker id=2] Finished LeaderAndIsr request in 23ms correlationId 19 from controller 2 for 1 partitions (state.change.logger)
[2024-05-16 15:53:23,317] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 4 with correlation id 20 (state.change.logger)
[2024-05-16 18:29:39,428] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2024-05-16 18:29:39,471] INFO [Controller id=0 epoch=5] Sending LeaderAndIsr request to broker 0 with 16 become-leader and 3 become-follower partitions (state.change.logger)
[2024-05-16 18:29:39,473] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers HashSet(0) for 19 partitions (state.change.logger)
[2024-05-16 18:29:39,545] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 19 partitions (state.change.logger)
[2024-05-16 18:29:39,552] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,553] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,553] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,553] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,553] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,553] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,553] INFO [Controller id=0 epoch=5] Partition product-created-events-topic-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,553] INFO [Controller id=0 epoch=5] Partition product-created-events-topics-0 state changed to (Leader:2,ISR:2,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:14,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,553] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,553] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,554] INFO [Controller id=0 epoch=5] Partition product-created-events-topics-1 state changed to (Leader:2,ISR:2,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:15,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,554] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,554] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,554] INFO [Controller id=0 epoch=5] Partition product-created-events-topics-2 state changed to (Leader:2,ISR:2,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:15,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,554] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,554] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,554] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,554] INFO [Controller id=0 epoch=5] Partition product-created-events-topic.DLT-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,554] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,554] INFO [Controller id=0 epoch=5] Partition product-List-evnt-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,554] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,554] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,554] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:5) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,576] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,576] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,577] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,577] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,577] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,577] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,577] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,577] INFO [Controller id=0 epoch=5] Partition product-List-event-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,577] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,577] INFO [Controller id=0 epoch=5] Partition product-created-events-topics-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:16,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,578] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,578] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,578] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,578] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,578] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,578] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,578] INFO [Controller id=0 epoch=5] Partition product-created-events-topics-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:15,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,578] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,578] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,578] INFO [Controller id=0 epoch=5] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,578] INFO [Controller id=0 epoch=5] Partition product-created-events-topics-1 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:10,ZkVersion:16,ControllerEpoch:5) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-16 18:29:39,578] INFO [Controller id=0 epoch=5] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-05-16 18:29:39,579] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers HashSet(0) for 41 partitions (state.change.logger)
[2024-05-16 18:29:39,589] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 0 epoch 5 as part of the become-leader transition for 16 partitions (state.change.logger)
[2024-05-16 18:29:39,609] INFO [Broker id=0] Leader __consumer_offsets-35 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:39,617] INFO [Broker id=0] Leader __consumer_offsets-5 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:39,620] INFO [Broker id=0] Leader __consumer_offsets-20 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:39,624] INFO [Broker id=0] Leader __consumer_offsets-41 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:39,628] INFO [Broker id=0] Leader __consumer_offsets-29 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:39,632] INFO [Broker id=0] Leader __consumer_offsets-44 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:39,632] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,634] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,634] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,635] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,635] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition product-created-events-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,635] INFO [Broker id=0] Leader __consumer_offsets-14 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:39,635] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,636] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,636] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,637] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,637] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition product-List-event-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-List-event-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,637] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,637] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,638] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,638] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,639] INFO [Broker id=0] Leader __consumer_offsets-2 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:39,639] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,639] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,639] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,640] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,640] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,640] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,640] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,641] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,641] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,641] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,641] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,642] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,642] INFO [Broker id=0] Leader __consumer_offsets-23 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:39,642] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,642] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition product-created-events-topic.DLT-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic.DLT-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,642] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,643] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,643] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,643] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,643] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,643] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,643] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition product-List-evnt-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-List-evnt-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,644] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,644] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,644] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:39,645] INFO [Broker id=0] Leader __consumer_offsets-38 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:39,645] INFO [Controller id=0 epoch=5] Changed partition product-created-events-topics-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=17) (state.change.logger)
[2024-05-16 18:29:39,645] INFO [Controller id=0 epoch=5] Changed partition product-created-events-topics-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=16) (state.change.logger)
[2024-05-16 18:29:39,645] INFO [Controller id=0 epoch=5] Changed partition product-created-events-topics-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=11, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=17) (state.change.logger)
[2024-05-16 18:29:39,645] INFO [Controller id=0 epoch=5] Sending LeaderAndIsr request to broker 0 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-16 18:29:39,646] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers HashSet(0) for 3 partitions (state.change.logger)
[2024-05-16 18:29:39,649] INFO [Broker id=0] Leader __consumer_offsets-8 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:39,652] INFO [Broker id=0] Leader __consumer_offsets-11 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:39,656] INFO [Broker id=0] Leader __consumer_offsets-26 starts at leader epoch 6 from offset 110 with high watermark 110 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:39,656] INFO [Broker id=0] Leader __consumer_offsets-47 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:39,660] INFO [Broker id=0] Leader __consumer_offsets-17 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:39,663] INFO [Broker id=0] Leader __consumer_offsets-32 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:39,670] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition product-created-events-topics-1 (last update controller epoch 4) but cannot become follower since the new leader 2 is unavailable. (state.change.logger)
[2024-05-16 18:29:39,671] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition product-created-events-topics-0 (last update controller epoch 4) but cannot become follower since the new leader 2 is unavailable. (state.change.logger)
[2024-05-16 18:29:39,672] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition product-created-events-topics-2 (last update controller epoch 4) but cannot become follower since the new leader 2 is unavailable. (state.change.logger)
[2024-05-16 18:29:39,673] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 5 with correlation id 1 for 0 partitions (state.change.logger)
[2024-05-16 18:29:39,708] INFO [Broker id=0] Finished LeaderAndIsr request in 166ms correlationId 1 from controller 0 for 19 partitions (state.change.logger)
[2024-05-16 18:29:39,720] INFO [Broker id=0] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 2 (state.change.logger)
[2024-05-16 18:29:39,721] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2024-05-16 18:29:39,722] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 5 for partition product-created-events-topics-1 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:39,722] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 5 for partition product-created-events-topics-0 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:39,722] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 5 for partition product-created-events-topics-2 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:39,723] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 5 with correlation id 3 for 0 partitions (state.change.logger)
[2024-05-16 18:29:39,723] INFO [Broker id=0] Finished LeaderAndIsr request in 2ms correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2024-05-16 18:29:39,725] INFO [Broker id=0] Add 41 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 4 (state.change.logger)
[2024-05-16 18:29:39,726] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 5 from controller 0 for 3 partitions (state.change.logger)
[2024-05-16 18:29:39,727] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 5 as part of the become-leader transition for 3 partitions (state.change.logger)
[2024-05-16 18:29:39,728] INFO [Broker id=0] Leader product-created-events-topics-1 starts at leader epoch 11 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:39,732] INFO [Broker id=0] Leader product-created-events-topics-0 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:39,734] INFO [Broker id=0] Leader product-created-events-topics-2 starts at leader epoch 11 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:39,737] INFO [Broker id=0] Finished LeaderAndIsr request in 11ms correlationId 5 from controller 0 for 3 partitions (state.change.logger)
[2024-05-16 18:29:39,739] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 6 (state.change.logger)
[2024-05-16 18:29:45,699] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2024-05-16 18:29:45,700] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers HashSet(2) for 57 partitions (state.change.logger)
[2024-05-16 18:29:45,704] INFO [Controller id=0 epoch=5] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 21 become-follower partitions (state.change.logger)
[2024-05-16 18:29:45,704] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers HashSet(0, 2) for 21 partitions (state.change.logger)
[2024-05-16 18:29:45,707] INFO [Broker id=0] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 8 (state.change.logger)
[2024-05-16 18:29:45,753] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,753] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,753] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,753] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition product-created-events-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,754] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,754] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,754] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,754] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,754] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,754] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,755] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,755] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,756] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,756] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition product-created-events-topic.DLT-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic.DLT-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,756] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,756] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,756] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition product-List-evnt-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-List-evnt-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,756] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,757] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,757] ERROR [Controller id=0 epoch=5] Controller 0 epoch 5 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-16 18:29:45,758] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-30 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=6, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 18:29:45,758] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-48 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=6, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 18:29:45,758] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=6, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 18:29:45,758] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-21 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=6, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 18:29:45,758] INFO [Controller id=0 epoch=5] Changed partition product-List-event-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=2, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 18:29:45,758] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-27 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=6, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 18:29:45,758] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-9 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=6, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 18:29:45,758] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-33 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=6, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 18:29:45,758] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-36 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=6, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 18:29:45,758] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-42 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=6, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 18:29:45,758] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=6, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 18:29:45,758] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-18 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=6, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 18:29:45,758] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-15 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=6, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 18:29:45,758] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-24 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=6, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 18:29:45,758] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-6 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=6, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 18:29:45,758] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-39 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=6, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 18:29:45,758] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-12 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=6, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 18:29:45,758] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-45 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=6, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-16 18:29:45,758] INFO [Controller id=0 epoch=5] Sending LeaderAndIsr request to broker 2 with 18 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-16 18:29:45,759] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers HashSet(0, 2) for 18 partitions (state.change.logger)
[2024-05-16 18:29:45,761] INFO [Broker id=0] Add 18 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 9 (state.change.logger)
[2024-05-16 18:29:46,071] INFO [Broker id=2] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 0 (state.change.logger)
[2024-05-16 18:29:46,085] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 0 for 21 partitions (state.change.logger)
[2024-05-16 18:29:46,108] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-3 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:46,112] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-18 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:46,113] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-39 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:46,113] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-9 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:46,114] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-24 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:46,114] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-27 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:46,121] INFO [Broker id=2] Follower product-created-events-topics-1 starts at leader epoch 11 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,121] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-42 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:46,122] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-12 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:46,122] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-33 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:46,122] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-48 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:46,123] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-21 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:46,123] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-36 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:46,123] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-6 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:46,124] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition product-List-event-0 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:46,125] INFO [Broker id=2] Follower product-created-events-topics-0 starts at leader epoch 10 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,125] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-45 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:46,126] INFO [Broker id=2] Follower product-created-events-topics-2 starts at leader epoch 11 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,126] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-15 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:46,127] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-30 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:46,128] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-0 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:29:46,132] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 0 epoch 5 with correlation id 1 for 3 partitions (state.change.logger)
[2024-05-16 18:29:46,191] INFO [Broker id=2] Finished LeaderAndIsr request in 106ms correlationId 1 from controller 0 for 21 partitions (state.change.logger)
[2024-05-16 18:29:46,198] INFO [Broker id=2] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 2 (state.change.logger)
[2024-05-16 18:29:46,200] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 0 for 18 partitions (state.change.logger)
[2024-05-16 18:29:46,205] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 5 as part of the become-leader transition for 18 partitions (state.change.logger)
[2024-05-16 18:29:46,208] INFO [Broker id=2] Leader __consumer_offsets-3 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,215] INFO [Broker id=2] Leader __consumer_offsets-18 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,218] INFO [Broker id=2] Leader __consumer_offsets-39 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,221] INFO [Broker id=2] Leader __consumer_offsets-9 starts at leader epoch 6 from offset 7 with high watermark 7 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,224] INFO [Broker id=2] Leader __consumer_offsets-24 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,226] INFO [Broker id=2] Leader __consumer_offsets-27 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,230] INFO [Broker id=2] Leader __consumer_offsets-42 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,236] INFO [Broker id=2] Leader __consumer_offsets-12 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,238] INFO [Broker id=2] Leader __consumer_offsets-33 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,242] INFO [Broker id=2] Leader __consumer_offsets-48 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,244] INFO [Broker id=2] Leader __consumer_offsets-21 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,246] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers HashSet(0, 2) for 1 partitions (state.change.logger)
[2024-05-16 18:29:46,247] INFO [Broker id=2] Leader __consumer_offsets-36 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,247] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 10 (state.change.logger)
[2024-05-16 18:29:46,250] INFO [Broker id=2] Leader __consumer_offsets-6 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,252] INFO [Broker id=2] Leader product-List-event-0 starts at leader epoch 2 from offset 11 with high watermark 11 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,254] INFO [Broker id=2] Leader __consumer_offsets-45 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,258] INFO [Broker id=2] Leader __consumer_offsets-15 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,262] INFO [Broker id=2] Leader __consumer_offsets-30 starts at leader epoch 6 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,264] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers HashSet(0, 2) for 2 partitions (state.change.logger)
[2024-05-16 18:29:46,265] INFO [Broker id=2] Leader __consumer_offsets-0 starts at leader epoch 6 from offset 1 with high watermark 1 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:29:46,266] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 11 (state.change.logger)
[2024-05-16 18:29:46,293] INFO [Broker id=2] Finished LeaderAndIsr request in 93ms correlationId 3 from controller 0 for 18 partitions (state.change.logger)
[2024-05-16 18:29:46,296] INFO [Broker id=2] Add 18 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 4 (state.change.logger)
[2024-05-16 18:29:46,300] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 5 (state.change.logger)
[2024-05-16 18:29:46,304] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 6 (state.change.logger)
[2024-05-16 18:30:49,294] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers HashSet(0, 2) for 0 partitions (state.change.logger)
[2024-05-16 18:30:49,297] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers HashSet(1) for 57 partitions (state.change.logger)
[2024-05-16 18:30:49,301] INFO [Controller id=0 epoch=5] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 23 become-follower partitions (state.change.logger)
[2024-05-16 18:30:49,301] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 23 partitions (state.change.logger)
[2024-05-16 18:30:49,303] INFO [Broker id=0] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 13 (state.change.logger)
[2024-05-16 18:30:49,303] INFO [Broker id=2] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 8 (state.change.logger)
[2024-05-16 18:30:49,322] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-22 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-16 18:30:49,322] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-16 18:30:49,322] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-25 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-16 18:30:49,322] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-49 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-16 18:30:49,322] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-31 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-16 18:30:49,322] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-37 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-16 18:30:49,322] INFO [Controller id=0 epoch=5] Changed partition product-created-events-topic-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-16 18:30:49,322] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-19 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-16 18:30:49,322] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-13 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-16 18:30:49,322] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-16 18:30:49,322] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-7 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-16 18:30:49,323] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-46 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-16 18:30:49,323] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-16 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-16 18:30:49,323] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-28 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-16 18:30:49,323] INFO [Controller id=0 epoch=5] Changed partition product-created-events-topic.DLT-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 18:30:49,323] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-43 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-16 18:30:49,323] INFO [Controller id=0 epoch=5] Changed partition product-List-evnt-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=2, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-05-16 18:30:49,323] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-34 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-16 18:30:49,323] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-10 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-16 18:30:49,323] INFO [Controller id=0 epoch=5] Changed partition __consumer_offsets-40 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=4, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-16 18:30:49,323] INFO [Controller id=0 epoch=5] Sending LeaderAndIsr request to broker 1 with 20 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-16 18:30:49,323] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 20 partitions (state.change.logger)
[2024-05-16 18:30:49,325] INFO [Broker id=0] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 14 (state.change.logger)
[2024-05-16 18:30:49,325] INFO [Broker id=2] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 9 (state.change.logger)
[2024-05-16 18:30:49,611] INFO [Broker id=1] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 0 (state.change.logger)
[2024-05-16 18:30:49,624] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 0 for 23 partitions (state.change.logger)
[2024-05-16 18:30:49,657] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-37 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,662] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-7 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,663] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-22 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,670] INFO [Broker id=1] Follower product-created-events-topics-1 starts at leader epoch 11 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,670] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-10 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,671] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-31 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,671] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-46 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,672] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-1 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,672] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition product-created-events-topic-0 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,672] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition product-created-events-topic.DLT-0 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,673] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-16 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,673] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-19 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,673] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-34 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,674] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-4 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,674] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-25 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,674] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-40 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,675] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-43 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,676] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition product-List-evnt-0 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,676] INFO [Broker id=1] Follower product-created-events-topics-0 starts at leader epoch 10 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,677] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-13 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,677] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-28 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,678] INFO [Broker id=1] Follower product-created-events-topics-2 starts at leader epoch 11 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,678] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 5 for partition __consumer_offsets-49 (last update controller epoch 5) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-16 18:30:49,682] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 5 with correlation id 1 for 3 partitions (state.change.logger)
[2024-05-16 18:30:49,755] INFO [Broker id=1] Finished LeaderAndIsr request in 129ms correlationId 1 from controller 0 for 23 partitions (state.change.logger)
[2024-05-16 18:30:49,762] INFO [Broker id=1] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 2 (state.change.logger)
[2024-05-16 18:30:49,765] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 0 for 20 partitions (state.change.logger)
[2024-05-16 18:30:49,770] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-05-16 18:30:49,772] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 15 (state.change.logger)
[2024-05-16 18:30:49,773] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 10 (state.change.logger)
[2024-05-16 18:30:49,777] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 5 as part of the become-leader transition for 20 partitions (state.change.logger)
[2024-05-16 18:30:49,785] INFO [Broker id=1] Leader __consumer_offsets-37 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,787] INFO [Controller id=0 epoch=5] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 2 partitions (state.change.logger)
[2024-05-16 18:30:49,790] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 16 (state.change.logger)
[2024-05-16 18:30:49,791] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 11 (state.change.logger)
[2024-05-16 18:30:49,796] INFO [Broker id=1] Leader __consumer_offsets-7 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,800] INFO [Broker id=1] Leader __consumer_offsets-22 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,804] INFO [Broker id=1] Leader __consumer_offsets-10 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,807] INFO [Broker id=1] Leader __consumer_offsets-31 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,809] INFO [Broker id=1] Leader __consumer_offsets-46 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,812] INFO [Broker id=1] Leader __consumer_offsets-1 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,815] INFO [Broker id=1] Leader product-created-events-topic-0 starts at leader epoch 4 from offset 33 with high watermark 33 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,818] INFO [Broker id=1] Leader product-created-events-topic.DLT-0 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,821] INFO [Broker id=1] Leader __consumer_offsets-16 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,823] INFO [Broker id=1] Leader __consumer_offsets-19 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,825] INFO [Broker id=1] Leader __consumer_offsets-34 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,827] INFO [Broker id=1] Leader __consumer_offsets-4 starts at leader epoch 4 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,829] INFO [Broker id=1] Leader __consumer_offsets-25 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,831] INFO [Broker id=1] Leader __consumer_offsets-40 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,833] INFO [Broker id=1] Leader __consumer_offsets-43 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,836] INFO [Broker id=1] Leader product-List-evnt-0 starts at leader epoch 2 from offset 18 with high watermark 18 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,838] INFO [Broker id=1] Leader __consumer_offsets-13 starts at leader epoch 4 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,840] INFO [Broker id=1] Leader __consumer_offsets-28 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,842] INFO [Broker id=1] Leader __consumer_offsets-49 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-16 18:30:49,909] INFO [Broker id=1] Finished LeaderAndIsr request in 144ms correlationId 3 from controller 0 for 20 partitions (state.change.logger)
[2024-05-16 18:30:49,912] INFO [Broker id=1] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 4 (state.change.logger)
[2024-05-16 18:30:49,915] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 5 (state.change.logger)
[2024-05-16 18:30:49,919] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 5 with correlation id 6 (state.change.logger)
[2024-05-17 14:02:28,941] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-05-17 14:02:28,994] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 1 with 20 become-leader and 3 become-follower partitions (state.change.logger)
[2024-05-17 14:02:28,999] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1) for 23 partitions (state.change.logger)
[2024-05-17 14:02:29,059] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,059] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-2 state changed to (Leader:-1,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:20,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,059] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,059] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,060] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,060] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,060] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-1 state changed to (Leader:-1,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:20,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,060] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,060] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,060] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,060] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,060] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,061] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-0 state changed to (Leader:-1,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:19,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,061] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,061] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,061] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,061] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,061] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,061] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,078] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 23 partitions (state.change.logger)
[2024-05-17 14:02:29,096] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,097] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,098] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,099] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,099] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,099] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,100] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,100] INFO [Controller id=1 epoch=6] Partition product-List-event-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,100] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,100] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:21,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,100] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,100] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,100] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,100] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,101] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,101] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,101] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:20,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,101] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,101] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,101] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,101] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:21,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:02:29,101] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-05-17 14:02:29,101] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1) for 37 partitions (state.change.logger)
[2024-05-17 14:02:29,134] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 1 epoch 6 as part of the become-leader transition for 20 partitions (state.change.logger)
[2024-05-17 14:02:29,145] INFO [Broker id=1] Leader __consumer_offsets-37 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,153] INFO [Broker id=1] Leader __consumer_offsets-7 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,155] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,157] INFO [Broker id=1] Leader __consumer_offsets-22 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,158] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,158] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,159] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,159] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,159] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,159] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,160] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,160] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,160] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,161] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition product-List-event-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-List-event-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,161] INFO [Broker id=1] Leader __consumer_offsets-10 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,161] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,161] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,162] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,162] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,162] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,162] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,163] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,163] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,163] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,165] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,166] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,166] INFO [Broker id=1] Leader __consumer_offsets-31 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,166] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,167] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,167] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,167] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,168] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,168] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,168] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,168] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,169] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,169] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,169] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,169] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:02:29,170] INFO [Broker id=1] Leader __consumer_offsets-46 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,172] INFO [Controller id=1 epoch=6] Changed partition product-created-events-topics-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=14, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=22) (state.change.logger)
[2024-05-17 14:02:29,172] INFO [Controller id=1 epoch=6] Changed partition product-created-events-topics-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=13, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=21) (state.change.logger)
[2024-05-17 14:02:29,172] INFO [Controller id=1 epoch=6] Changed partition product-created-events-topics-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=14, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=22) (state.change.logger)
[2024-05-17 14:02:29,172] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 1 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-17 14:02:29,172] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1) for 3 partitions (state.change.logger)
[2024-05-17 14:02:29,174] INFO [Broker id=1] Leader __consumer_offsets-1 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,177] INFO [Broker id=1] Leader product-created-events-topic-0 starts at leader epoch 4 from offset 47 with high watermark 47 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,178] INFO [Broker id=1] Leader product-created-events-topic.DLT-0 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,182] INFO [Broker id=1] Leader __consumer_offsets-16 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,186] INFO [Broker id=1] Leader __consumer_offsets-19 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,190] INFO [Broker id=1] Leader __consumer_offsets-34 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,194] INFO [Broker id=1] Leader __consumer_offsets-4 starts at leader epoch 4 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,198] INFO [Broker id=1] Leader __consumer_offsets-25 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,203] INFO [Broker id=1] Leader __consumer_offsets-40 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,206] INFO [Broker id=1] Leader __consumer_offsets-43 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,209] INFO [Broker id=1] Leader product-List-evnt-0 starts at leader epoch 2 from offset 18 with high watermark 18 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,212] INFO [Broker id=1] Leader __consumer_offsets-13 starts at leader epoch 4 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,217] INFO [Broker id=1] Leader __consumer_offsets-28 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,220] INFO [Broker id=1] Leader __consumer_offsets-49 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,225] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition product-created-events-topics-1 (last update controller epoch 5) but cannot become follower since the new leader 0 is unavailable. (state.change.logger)
[2024-05-17 14:02:29,225] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition product-created-events-topics-0 (last update controller epoch 5) but cannot become follower since the new leader 0 is unavailable. (state.change.logger)
[2024-05-17 14:02:29,226] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition product-created-events-topics-2 (last update controller epoch 5) but cannot become follower since the new leader 0 is unavailable. (state.change.logger)
[2024-05-17 14:02:29,227] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 6 with correlation id 1 for 0 partitions (state.change.logger)
[2024-05-17 14:02:29,269] INFO [Broker id=1] Finished LeaderAndIsr request in 190ms correlationId 1 from controller 1 for 23 partitions (state.change.logger)
[2024-05-17 14:02:29,279] INFO [Broker id=1] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 2 (state.change.logger)
[2024-05-17 14:02:29,281] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:02:29,281] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 6 for partition product-created-events-topics-1 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:02:29,282] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 6 for partition product-created-events-topics-0 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:02:29,282] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 6 for partition product-created-events-topics-2 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:02:29,282] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 6 with correlation id 3 for 0 partitions (state.change.logger)
[2024-05-17 14:02:29,283] INFO [Broker id=1] Finished LeaderAndIsr request in 2ms correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:02:29,285] INFO [Broker id=1] Add 37 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 4 (state.change.logger)
[2024-05-17 14:02:29,286] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 5 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:02:29,288] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 1 epoch 6 as part of the become-leader transition for 3 partitions (state.change.logger)
[2024-05-17 14:02:29,289] INFO [Broker id=1] Leader product-created-events-topics-1 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,291] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 13 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,293] INFO [Broker id=1] Leader product-created-events-topics-2 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:02:29,297] INFO [Broker id=1] Finished LeaderAndIsr request in 11ms correlationId 5 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:02:29,301] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 6 (state.change.logger)
[2024-05-17 14:03:15,713] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-05-17 14:03:15,715] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(2) for 57 partitions (state.change.logger)
[2024-05-17 14:03:15,722] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 21 become-follower partitions (state.change.logger)
[2024-05-17 14:03:15,722] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1, 2) for 21 partitions (state.change.logger)
[2024-05-17 14:03:15,724] INFO [Broker id=1] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 8 (state.change.logger)
[2024-05-17 14:03:15,761] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:03:15,762] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:03:15,763] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:03:15,763] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:03:15,763] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:03:15,763] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:03:15,763] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:03:15,763] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:03:15,764] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:03:15,764] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:03:15,764] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:03:15,764] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:03:15,764] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:03:15,764] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:03:15,765] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:03:15,765] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:03:15,765] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-30 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:15,765] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-36 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:15,765] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-21 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:15,765] INFO [Controller id=1 epoch=6] Changed partition product-List-event-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=4, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-05-17 14:03:15,765] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-27 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:15,765] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-9 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:15,765] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-33 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:15,765] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-42 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:15,765] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:15,765] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-18 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:15,765] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-15 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:15,765] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-24 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:15,765] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-48 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:15,765] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-6 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:15,765] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:15,765] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-39 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:15,765] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-12 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:15,765] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-45 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:15,766] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 2 with 18 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-17 14:03:15,766] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1, 2) for 18 partitions (state.change.logger)
[2024-05-17 14:03:15,767] INFO [Broker id=1] Add 18 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 9 (state.change.logger)
[2024-05-17 14:03:16,037] INFO [Broker id=2] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 0 (state.change.logger)
[2024-05-17 14:03:16,052] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 1 for 21 partitions (state.change.logger)
[2024-05-17 14:03:16,076] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-3 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:16,080] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-18 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:16,080] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-39 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:16,081] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-9 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:16,081] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-24 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:16,081] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-27 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:16,086] INFO [Broker id=2] Follower product-created-events-topics-1 starts at leader epoch 14 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,086] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-42 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:16,087] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-12 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:16,087] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-33 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:16,088] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-48 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:16,088] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-21 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:16,088] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-36 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:16,089] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-6 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:16,089] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition product-List-event-0 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:16,091] INFO [Broker id=2] Follower product-created-events-topics-0 starts at leader epoch 13 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,092] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-45 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:16,094] INFO [Broker id=2] Follower product-created-events-topics-2 starts at leader epoch 14 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,094] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-15 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:16,094] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-30 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:16,095] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-0 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:16,098] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 6 with correlation id 1 for 3 partitions (state.change.logger)
[2024-05-17 14:03:16,195] INFO [Broker id=2] Finished LeaderAndIsr request in 143ms correlationId 1 from controller 1 for 21 partitions (state.change.logger)
[2024-05-17 14:03:16,202] INFO [Broker id=2] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 2 (state.change.logger)
[2024-05-17 14:03:16,204] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 1 for 18 partitions (state.change.logger)
[2024-05-17 14:03:16,209] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 6 as part of the become-leader transition for 18 partitions (state.change.logger)
[2024-05-17 14:03:16,213] INFO [Broker id=2] Leader __consumer_offsets-3 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,220] INFO [Broker id=2] Leader __consumer_offsets-18 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,222] INFO [Broker id=2] Leader __consumer_offsets-39 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,225] INFO [Broker id=2] Leader __consumer_offsets-9 starts at leader epoch 8 from offset 31 with high watermark 31 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,228] INFO [Broker id=2] Leader __consumer_offsets-24 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,231] INFO [Broker id=2] Leader __consumer_offsets-27 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,235] INFO [Broker id=2] Leader __consumer_offsets-42 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,237] INFO [Broker id=2] Leader __consumer_offsets-12 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,240] INFO [Broker id=2] Leader __consumer_offsets-33 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,244] INFO [Broker id=2] Leader __consumer_offsets-48 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,248] INFO [Broker id=2] Leader __consumer_offsets-21 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,250] INFO [Broker id=2] Leader __consumer_offsets-36 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,253] INFO [Broker id=2] Leader __consumer_offsets-6 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,253] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1, 2) for 1 partitions (state.change.logger)
[2024-05-17 14:03:16,254] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 10 (state.change.logger)
[2024-05-17 14:03:16,256] INFO [Broker id=2] Leader product-List-event-0 starts at leader epoch 4 from offset 11 with high watermark 11 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,259] INFO [Broker id=2] Leader __consumer_offsets-45 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,262] INFO [Broker id=2] Leader __consumer_offsets-15 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,265] INFO [Broker id=2] Leader __consumer_offsets-30 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,267] INFO [Broker id=2] Leader __consumer_offsets-0 starts at leader epoch 8 from offset 3 with high watermark 3 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:16,269] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1, 2) for 2 partitions (state.change.logger)
[2024-05-17 14:03:16,270] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 11 (state.change.logger)
[2024-05-17 14:03:16,288] INFO [Broker id=2] Finished LeaderAndIsr request in 84ms correlationId 3 from controller 1 for 18 partitions (state.change.logger)
[2024-05-17 14:03:16,290] INFO [Broker id=2] Add 18 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 4 (state.change.logger)
[2024-05-17 14:03:16,292] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 5 (state.change.logger)
[2024-05-17 14:03:16,294] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 6 (state.change.logger)
[2024-05-17 14:03:26,822] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1, 2) for 0 partitions (state.change.logger)
[2024-05-17 14:03:26,824] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(0) for 57 partitions (state.change.logger)
[2024-05-17 14:03:26,826] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 19 become-follower partitions (state.change.logger)
[2024-05-17 14:03:26,826] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 19 partitions (state.change.logger)
[2024-05-17 14:03:26,830] INFO [Broker id=1] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 13 (state.change.logger)
[2024-05-17 14:03:26,830] INFO [Broker id=2] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 8 (state.change.logger)
[2024-05-17 14:03:26,853] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-8 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:26,853] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-35 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:26,853] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-47 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:26,853] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-38 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:26,853] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-17 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:26,853] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-11 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:26,853] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-29 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:26,853] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-32 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:26,853] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-41 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:26,853] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-23 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:26,853] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:26,853] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-14 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:26,853] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-20 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:26,853] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-44 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:26,853] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:26,853] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-26 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=8, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:03:26,853] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 0 with 16 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-17 14:03:26,854] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 16 partitions (state.change.logger)
[2024-05-17 14:03:26,855] INFO [Broker id=1] Add 16 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 14 (state.change.logger)
[2024-05-17 14:03:26,856] INFO [Broker id=2] Add 16 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 9 (state.change.logger)
[2024-05-17 14:03:27,155] INFO [Broker id=0] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 0 (state.change.logger)
[2024-05-17 14:03:27,170] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 1 for 19 partitions (state.change.logger)
[2024-05-17 14:03:27,196] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-35 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:27,201] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-5 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:27,201] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-20 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:27,202] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-41 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:27,207] INFO [Broker id=0] Follower product-created-events-topics-1 starts at leader epoch 14 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:27,208] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-29 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:27,208] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-44 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:27,209] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-14 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:27,210] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-2 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:27,210] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-23 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:27,211] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-38 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:27,211] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-8 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:27,211] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-11 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:27,212] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-26 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:27,213] INFO [Broker id=0] Follower product-created-events-topics-0 starts at leader epoch 13 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:27,214] INFO [Broker id=0] Follower product-created-events-topics-2 starts at leader epoch 14 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:27,214] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-47 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:27,215] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-17 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:27,216] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-32 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:03:27,219] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 1 epoch 6 with correlation id 1 for 3 partitions (state.change.logger)
[2024-05-17 14:03:27,276] INFO [Broker id=0] Finished LeaderAndIsr request in 106ms correlationId 1 from controller 1 for 19 partitions (state.change.logger)
[2024-05-17 14:03:27,282] INFO [Broker id=0] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 2 (state.change.logger)
[2024-05-17 14:03:27,284] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 1 for 16 partitions (state.change.logger)
[2024-05-17 14:03:27,285] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-05-17 14:03:27,287] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 15 (state.change.logger)
[2024-05-17 14:03:27,287] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 10 (state.change.logger)
[2024-05-17 14:03:27,292] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 6 as part of the become-leader transition for 16 partitions (state.change.logger)
[2024-05-17 14:03:27,295] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 2 partitions (state.change.logger)
[2024-05-17 14:03:27,295] INFO [Broker id=0] Leader __consumer_offsets-35 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:27,298] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 16 (state.change.logger)
[2024-05-17 14:03:27,299] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 11 (state.change.logger)
[2024-05-17 14:03:27,306] INFO [Broker id=0] Leader __consumer_offsets-5 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:27,308] INFO [Broker id=0] Leader __consumer_offsets-20 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:27,309] INFO [Broker id=0] Leader __consumer_offsets-41 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:27,312] INFO [Broker id=0] Leader __consumer_offsets-29 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:27,315] INFO [Broker id=0] Leader __consumer_offsets-44 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:27,317] INFO [Broker id=0] Leader __consumer_offsets-14 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:27,319] INFO [Broker id=0] Leader __consumer_offsets-2 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:27,321] INFO [Broker id=0] Leader __consumer_offsets-23 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:27,323] INFO [Broker id=0] Leader __consumer_offsets-38 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:27,325] INFO [Broker id=0] Leader __consumer_offsets-8 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:27,328] INFO [Broker id=0] Leader __consumer_offsets-11 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:27,330] INFO [Broker id=0] Leader __consumer_offsets-26 starts at leader epoch 8 from offset 125 with high watermark 125 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:27,331] INFO [Broker id=0] Leader __consumer_offsets-47 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:27,333] INFO [Broker id=0] Leader __consumer_offsets-17 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:27,335] INFO [Broker id=0] Leader __consumer_offsets-32 starts at leader epoch 8 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:03:27,355] INFO [Broker id=0] Finished LeaderAndIsr request in 71ms correlationId 3 from controller 1 for 16 partitions (state.change.logger)
[2024-05-17 14:03:27,358] INFO [Broker id=0] Add 16 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 4 (state.change.logger)
[2024-05-17 14:03:27,360] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 5 (state.change.logger)
[2024-05-17 14:03:27,363] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 6 (state.change.logger)
[2024-05-17 14:07:20,660] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-17 14:07:20,661] INFO [Controller id=1 epoch=6] Sending StopReplica request for 3 replicas to broker 0 (state.change.logger)
[2024-05-17 14:07:20,663] INFO [Broker id=0] Handling StopReplica request correlationId 7 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:07:20,666] INFO [Broker id=0] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 7 epoch 6 for partition product-created-events-topics-1 since its associated leader epoch 14 matches the current leader epoch (state.change.logger)
[2024-05-17 14:07:20,666] INFO [Broker id=0] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 7 epoch 6 for partition product-created-events-topics-2 since its associated leader epoch 14 matches the current leader epoch (state.change.logger)
[2024-05-17 14:07:20,666] INFO [Broker id=0] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 7 epoch 6 for partition product-created-events-topics-0 since its associated leader epoch 13 matches the current leader epoch (state.change.logger)
[2024-05-17 14:07:20,667] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:25,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,668] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:25,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,668] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:24,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,668] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 1 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-17 14:07:20,668] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-05-17 14:07:20,668] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 3 partitions (state.change.logger)
[2024-05-17 14:07:20,669] INFO [Controller id=1 epoch=6] Sending StopReplica request for 3 replicas to broker 0 (state.change.logger)
[2024-05-17 14:07:20,669] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 17 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:07:20,669] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 12 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:07:20,670] INFO [Broker id=2] Follower product-created-events-topics-1 starts at leader epoch 15 from offset 0 with high watermark 0. Previous leader epoch was 14. (state.change.logger)
[2024-05-17 14:07:20,670] INFO [Broker id=2] Follower product-created-events-topics-0 starts at leader epoch 14 from offset 0 with high watermark 0. Previous leader epoch was 13. (state.change.logger)
[2024-05-17 14:07:20,670] INFO [Broker id=2] Follower product-created-events-topics-2 starts at leader epoch 15 from offset 0 with high watermark 0. Previous leader epoch was 14. (state.change.logger)
[2024-05-17 14:07:20,672] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 17 from controller 1 epoch 6 as part of the become-leader transition for 3 partitions (state.change.logger)
[2024-05-17 14:07:20,672] INFO [Broker id=1] Leader product-created-events-topics-1 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [1,2] addingReplicas [] removingReplicas []. Previous leader epoch was 14. (state.change.logger)
[2024-05-17 14:07:20,673] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 6 with correlation id 12 for 3 partitions (state.change.logger)
[2024-05-17 14:07:20,674] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 8 (state.change.logger)
[2024-05-17 14:07:20,676] INFO [Broker id=0] Handling StopReplica request correlationId 9 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:07:20,676] INFO [Broker id=2] Finished LeaderAndIsr request in 7ms correlationId 12 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:07:20,676] INFO [Broker id=0] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 9 epoch 6 for partition product-created-events-topics-1 since its associated leader epoch 14 matches the current leader epoch (state.change.logger)
[2024-05-17 14:07:20,676] INFO [Broker id=0] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 9 epoch 6 for partition product-created-events-topics-2 since its associated leader epoch 14 matches the current leader epoch (state.change.logger)
[2024-05-17 14:07:20,676] INFO [Broker id=0] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 9 epoch 6 for partition product-created-events-topics-0 since its associated leader epoch 13 matches the current leader epoch (state.change.logger)
[2024-05-17 14:07:20,677] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 13 (state.change.logger)
[2024-05-17 14:07:20,679] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 17 from controller 1 epoch 6 for partition product-created-events-topics-1 (last update controller epoch 6) since it is already the leader for the partition. (state.change.logger)
[2024-05-17 14:07:20,680] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [1,2] addingReplicas [] removingReplicas []. Previous leader epoch was 13. (state.change.logger)
[2024-05-17 14:07:20,684] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 17 from controller 1 epoch 6 for partition product-created-events-topics-0 (last update controller epoch 6) since it is already the leader for the partition. (state.change.logger)
[2024-05-17 14:07:20,684] INFO [Broker id=1] Leader product-created-events-topics-2 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [1,2] addingReplicas [] removingReplicas []. Previous leader epoch was 14. (state.change.logger)
[2024-05-17 14:07:20,686] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 17 from controller 1 epoch 6 for partition product-created-events-topics-2 (last update controller epoch 6) since it is already the leader for the partition. (state.change.logger)
[2024-05-17 14:07:20,687] INFO [Broker id=1] Finished LeaderAndIsr request in 18ms correlationId 17 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:07:20,689] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 18 (state.change.logger)
[2024-05-17 14:07:20,811] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-17 14:07:20,817] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:07:20,817] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:07:20,818] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:07:20,818] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:07:20,818] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:07:20,818] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:07:20,818] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:07:20,818] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:07:20,818] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:07:20,819] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:07:20,819] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:07:20,819] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:07:20,819] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:07:20,819] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:07:20,820] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:07:20,820] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:07:20,820] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-17 14:07:20,834] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,834] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:25,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,834] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,834] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,834] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,834] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,834] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:25,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,834] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,834] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,834] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,834] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,834] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,835] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:24,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,835] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,835] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,835] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,835] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,835] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,835] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:07:20,835] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 1 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-17 14:07:20,835] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-05-17 14:07:20,835] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1, 2) for 19 partitions (state.change.logger)
[2024-05-17 14:07:20,835] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 19 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:07:20,836] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 14 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:07:20,837] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 19 epoch 6 for partition product-created-events-topics-1 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2024-05-17 14:07:20,837] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 19 epoch 6 for partition product-created-events-topics-2 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2024-05-17 14:07:20,837] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 19 epoch 6 for partition product-created-events-topics-0 since its associated leader epoch 14 matches the current leader epoch (state.change.logger)
[2024-05-17 14:07:20,837] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 14 epoch 6 for partition product-created-events-topics-1 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2024-05-17 14:07:20,837] INFO [Broker id=1] Finished LeaderAndIsr request in 2ms correlationId 19 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:07:20,837] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 14 epoch 6 for partition product-created-events-topics-2 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2024-05-17 14:07:20,837] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 14 epoch 6 for partition product-created-events-topics-0 since its associated leader epoch 14 matches the current leader epoch (state.change.logger)
[2024-05-17 14:07:20,838] INFO [Broker id=2] Finished LeaderAndIsr request in 2ms correlationId 14 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:07:20,839] INFO [Broker id=1] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 20 (state.change.logger)
[2024-05-17 14:07:20,839] INFO [Broker id=2] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 15 (state.change.logger)
[2024-05-17 14:08:53,298] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-17 14:08:53,298] INFO [Controller id=1 epoch=6] Sending StopReplica request for 3 replicas to broker 2 (state.change.logger)
[2024-05-17 14:08:53,302] INFO [Broker id=2] Handling StopReplica request correlationId 16 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:08:53,311] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 16 epoch 6 for partition product-created-events-topics-1 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2024-05-17 14:08:53,311] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 16 epoch 6 for partition product-created-events-topics-2 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2024-05-17 14:08:53,311] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 16 epoch 6 for partition product-created-events-topics-0 since its associated leader epoch 14 matches the current leader epoch (state.change.logger)
[2024-05-17 14:08:53,314] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:26,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,314] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:26,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,314] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:25,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,315] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 1 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-17 14:08:53,315] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1, 2) for 3 partitions (state.change.logger)
[2024-05-17 14:08:53,315] INFO [Controller id=1 epoch=6] Sending StopReplica request for 3 replicas to broker 2 (state.change.logger)
[2024-05-17 14:08:53,315] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 21 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:08:53,316] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 21 from controller 1 epoch 6 as part of the become-leader transition for 3 partitions (state.change.logger)
[2024-05-17 14:08:53,317] INFO [Broker id=1] Leader product-created-events-topics-1 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was 15. (state.change.logger)
[2024-05-17 14:08:53,318] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 17 (state.change.logger)
[2024-05-17 14:08:53,319] INFO [Broker id=2] Handling StopReplica request correlationId 18 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:08:53,319] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 18 epoch 6 for partition product-created-events-topics-1 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2024-05-17 14:08:53,319] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 18 epoch 6 for partition product-created-events-topics-2 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2024-05-17 14:08:53,319] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 18 epoch 6 for partition product-created-events-topics-0 since its associated leader epoch 14 matches the current leader epoch (state.change.logger)
[2024-05-17 14:08:53,320] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 21 from controller 1 epoch 6 for partition product-created-events-topics-1 (last update controller epoch 6) since it is already the leader for the partition. (state.change.logger)
[2024-05-17 14:08:53,320] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was 14. (state.change.logger)
[2024-05-17 14:08:53,324] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 21 from controller 1 epoch 6 for partition product-created-events-topics-0 (last update controller epoch 6) since it is already the leader for the partition. (state.change.logger)
[2024-05-17 14:08:53,324] INFO [Broker id=1] Leader product-created-events-topics-2 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was 15. (state.change.logger)
[2024-05-17 14:08:53,326] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 21 from controller 1 epoch 6 for partition product-created-events-topics-2 (last update controller epoch 6) since it is already the leader for the partition. (state.change.logger)
[2024-05-17 14:08:53,327] INFO [Broker id=1] Finished LeaderAndIsr request in 12ms correlationId 21 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:08:53,328] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 22 (state.change.logger)
[2024-05-17 14:08:53,461] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-17 14:08:53,470] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,471] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,471] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,471] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,471] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,471] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,471] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,471] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,471] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,471] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,471] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition product-List-event-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-List-event-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,471] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,472] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,472] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,472] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,472] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,472] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,472] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,472] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,472] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,472] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,472] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,472] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,472] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,472] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,472] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,473] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,473] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,473] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,473] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,473] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,473] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,473] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,473] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:08:53,473] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-17 14:08:53,486] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,486] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,486] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,486] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,486] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,486] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,486] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,486] INFO [Controller id=1 epoch=6] Partition product-List-event-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,486] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,487] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:26,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,487] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,487] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,487] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,487] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,487] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,487] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,487] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:25,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,487] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,487] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,487] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,487] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:26,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:08:53,488] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 1 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-17 14:08:53,488] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1) for 21 partitions (state.change.logger)
[2024-05-17 14:08:53,488] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 23 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:08:53,488] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 23 epoch 6 for partition product-created-events-topics-1 since its associated leader epoch 16 matches the current leader epoch (state.change.logger)
[2024-05-17 14:08:53,488] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 23 epoch 6 for partition product-created-events-topics-2 since its associated leader epoch 16 matches the current leader epoch (state.change.logger)
[2024-05-17 14:08:53,488] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 23 epoch 6 for partition product-created-events-topics-0 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2024-05-17 14:08:53,489] INFO [Broker id=1] Finished LeaderAndIsr request in 1ms correlationId 23 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:08:53,489] INFO [Broker id=1] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 24 (state.change.logger)
[2024-05-17 14:10:19,723] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-05-17 14:10:19,724] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(2) for 57 partitions (state.change.logger)
[2024-05-17 14:10:19,727] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 21 become-follower partitions (state.change.logger)
[2024-05-17 14:10:19,727] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1, 2) for 21 partitions (state.change.logger)
[2024-05-17 14:10:19,728] INFO [Broker id=1] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 26 (state.change.logger)
[2024-05-17 14:10:19,750] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:10:19,751] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:10:19,751] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:10:19,751] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:10:19,751] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:10:19,751] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:10:19,751] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:10:19,751] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:10:19,752] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:10:19,752] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:10:19,752] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:10:19,753] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:10:19,753] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:10:19,753] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:10:19,753] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:10:19,753] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:10:19,753] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-30 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=10, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:19,753] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-36 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=10, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:19,753] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-21 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=10, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:19,753] INFO [Controller id=1 epoch=6] Changed partition product-List-event-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=6, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=6) (state.change.logger)
[2024-05-17 14:10:19,754] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-27 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=10, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:19,754] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-9 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=10, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:19,754] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-33 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=10, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:19,754] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-42 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=10, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:19,754] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=10, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:19,754] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-18 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=10, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:19,754] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-15 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=10, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:19,754] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-24 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=10, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:19,754] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-48 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=10, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:19,754] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-6 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=10, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:19,754] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=10, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:19,754] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-39 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=10, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:19,754] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-12 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=10, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:19,754] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-45 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=10, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:19,754] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 2 with 18 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-17 14:10:19,754] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1, 2) for 18 partitions (state.change.logger)
[2024-05-17 14:10:19,756] INFO [Broker id=1] Add 18 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 27 (state.change.logger)
[2024-05-17 14:10:20,063] INFO [Broker id=2] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 0 (state.change.logger)
[2024-05-17 14:10:20,081] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 1 for 21 partitions (state.change.logger)
[2024-05-17 14:10:20,109] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-3 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:20,113] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-18 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:20,114] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-39 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:20,114] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-9 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:20,115] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-24 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:20,115] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-27 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:20,121] INFO [Broker id=2] Follower product-created-events-topics-1 starts at leader epoch 16 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,121] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-42 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:20,121] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-12 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:20,122] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-33 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:20,122] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-48 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:20,123] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-21 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:20,123] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-36 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:20,124] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-6 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:20,125] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition product-List-event-0 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:20,126] INFO [Broker id=2] Follower product-created-events-topics-0 starts at leader epoch 15 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,126] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-45 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:20,127] INFO [Broker id=2] Follower product-created-events-topics-2 starts at leader epoch 16 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,127] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-15 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:20,127] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-30 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:20,127] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-0 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:20,130] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 6 with correlation id 1 for 3 partitions (state.change.logger)
[2024-05-17 14:10:20,188] INFO [Broker id=2] Finished LeaderAndIsr request in 107ms correlationId 1 from controller 1 for 21 partitions (state.change.logger)
[2024-05-17 14:10:20,195] INFO [Broker id=2] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 2 (state.change.logger)
[2024-05-17 14:10:20,196] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1, 2) for 1 partitions (state.change.logger)
[2024-05-17 14:10:20,197] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 1 for 18 partitions (state.change.logger)
[2024-05-17 14:10:20,198] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 28 (state.change.logger)
[2024-05-17 14:10:20,202] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1, 2) for 2 partitions (state.change.logger)
[2024-05-17 14:10:20,202] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 6 as part of the become-leader transition for 18 partitions (state.change.logger)
[2024-05-17 14:10:20,203] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 29 (state.change.logger)
[2024-05-17 14:10:20,210] INFO [Broker id=2] Leader __consumer_offsets-3 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,217] INFO [Broker id=2] Leader __consumer_offsets-18 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,219] INFO [Broker id=2] Leader __consumer_offsets-39 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,221] INFO [Broker id=2] Leader __consumer_offsets-9 starts at leader epoch 10 from offset 34 with high watermark 34 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,224] INFO [Broker id=2] Leader __consumer_offsets-24 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,227] INFO [Broker id=2] Leader __consumer_offsets-27 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,229] INFO [Broker id=2] Leader __consumer_offsets-42 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,231] INFO [Broker id=2] Leader __consumer_offsets-12 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,233] INFO [Broker id=2] Leader __consumer_offsets-33 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,234] INFO [Broker id=2] Leader __consumer_offsets-48 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,236] INFO [Broker id=2] Leader __consumer_offsets-21 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,238] INFO [Broker id=2] Leader __consumer_offsets-36 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,241] INFO [Broker id=2] Leader __consumer_offsets-6 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,243] INFO [Broker id=2] Leader product-List-event-0 starts at leader epoch 6 from offset 11 with high watermark 11 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,245] INFO [Broker id=2] Leader __consumer_offsets-45 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,247] INFO [Broker id=2] Leader __consumer_offsets-15 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,248] INFO [Broker id=2] Leader __consumer_offsets-30 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,250] INFO [Broker id=2] Leader __consumer_offsets-0 starts at leader epoch 10 from offset 3 with high watermark 3 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:20,267] INFO [Broker id=2] Finished LeaderAndIsr request in 70ms correlationId 3 from controller 1 for 18 partitions (state.change.logger)
[2024-05-17 14:10:20,269] INFO [Broker id=2] Add 18 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 4 (state.change.logger)
[2024-05-17 14:10:20,270] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 5 (state.change.logger)
[2024-05-17 14:10:20,272] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 6 (state.change.logger)
[2024-05-17 14:10:58,999] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(1, 2) for 0 partitions (state.change.logger)
[2024-05-17 14:10:59,000] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(0) for 57 partitions (state.change.logger)
[2024-05-17 14:10:59,003] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 19 become-follower partitions (state.change.logger)
[2024-05-17 14:10:59,003] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 19 partitions (state.change.logger)
[2024-05-17 14:10:59,006] INFO [Broker id=1] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 31 (state.change.logger)
[2024-05-17 14:10:59,006] INFO [Broker id=2] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 8 (state.change.logger)
[2024-05-17 14:10:59,020] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-8 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:59,020] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-35 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:59,020] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-47 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:59,020] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-38 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:59,020] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-17 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:59,020] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-11 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:59,020] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-29 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:59,021] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-32 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:59,021] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-41 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:59,021] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-23 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:59,021] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:59,021] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-14 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:59,021] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-20 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:59,021] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-44 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:59,021] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:59,021] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-26 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=10, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-05-17 14:10:59,021] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 0 with 16 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-17 14:10:59,021] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 16 partitions (state.change.logger)
[2024-05-17 14:10:59,022] INFO [Broker id=1] Add 16 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 32 (state.change.logger)
[2024-05-17 14:10:59,023] INFO [Broker id=2] Add 16 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 9 (state.change.logger)
[2024-05-17 14:10:59,347] INFO [Broker id=0] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 0 (state.change.logger)
[2024-05-17 14:10:59,360] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 1 for 19 partitions (state.change.logger)
[2024-05-17 14:10:59,404] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-35 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:59,411] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-5 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:59,412] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-20 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:59,413] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-41 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:59,424] INFO [Broker id=0] Follower product-created-events-topics-1 starts at leader epoch 16 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:59,424] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-29 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:59,425] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-44 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:59,426] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-14 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:59,427] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-2 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:59,428] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-23 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:59,429] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-38 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:59,429] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-8 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:59,430] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-11 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:59,431] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-26 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:59,437] INFO [Broker id=0] Follower product-created-events-topics-0 starts at leader epoch 15 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:59,439] INFO [Broker id=0] Follower product-created-events-topics-2 starts at leader epoch 16 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:59,439] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-47 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:59,440] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-17 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:59,441] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-32 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:10:59,446] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 1 epoch 6 with correlation id 1 for 3 partitions (state.change.logger)
[2024-05-17 14:10:59,547] INFO [Broker id=0] Finished LeaderAndIsr request in 187ms correlationId 1 from controller 1 for 19 partitions (state.change.logger)
[2024-05-17 14:10:59,555] INFO [Broker id=0] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 2 (state.change.logger)
[2024-05-17 14:10:59,556] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 1 for 16 partitions (state.change.logger)
[2024-05-17 14:10:59,560] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-05-17 14:10:59,561] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 33 (state.change.logger)
[2024-05-17 14:10:59,561] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 10 (state.change.logger)
[2024-05-17 14:10:59,564] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 6 as part of the become-leader transition for 16 partitions (state.change.logger)
[2024-05-17 14:10:59,570] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 2 partitions (state.change.logger)
[2024-05-17 14:10:59,570] INFO [Broker id=0] Leader __consumer_offsets-35 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:59,571] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 34 (state.change.logger)
[2024-05-17 14:10:59,572] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 11 (state.change.logger)
[2024-05-17 14:10:59,579] INFO [Broker id=0] Leader __consumer_offsets-5 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:59,582] INFO [Broker id=0] Leader __consumer_offsets-20 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:59,585] INFO [Broker id=0] Leader __consumer_offsets-41 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:59,589] INFO [Broker id=0] Leader __consumer_offsets-29 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:59,592] INFO [Broker id=0] Leader __consumer_offsets-44 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:59,596] INFO [Broker id=0] Leader __consumer_offsets-14 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:59,598] INFO [Broker id=0] Leader __consumer_offsets-2 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:59,602] INFO [Broker id=0] Leader __consumer_offsets-23 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:59,605] INFO [Broker id=0] Leader __consumer_offsets-38 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:59,607] INFO [Broker id=0] Leader __consumer_offsets-8 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:59,610] INFO [Broker id=0] Leader __consumer_offsets-11 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:59,613] INFO [Broker id=0] Leader __consumer_offsets-26 starts at leader epoch 10 from offset 127 with high watermark 127 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:59,615] INFO [Broker id=0] Leader __consumer_offsets-47 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:59,617] INFO [Broker id=0] Leader __consumer_offsets-17 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:59,620] INFO [Broker id=0] Leader __consumer_offsets-32 starts at leader epoch 10 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:10:59,649] INFO [Broker id=0] Finished LeaderAndIsr request in 93ms correlationId 3 from controller 1 for 16 partitions (state.change.logger)
[2024-05-17 14:10:59,654] INFO [Broker id=0] Add 16 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 4 (state.change.logger)
[2024-05-17 14:10:59,656] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 5 (state.change.logger)
[2024-05-17 14:10:59,657] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 6 (state.change.logger)
[2024-05-17 14:12:24,483] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-17 14:12:24,483] INFO [Controller id=1 epoch=6] Sending StopReplica request for 3 replicas to broker 2 (state.change.logger)
[2024-05-17 14:12:24,485] INFO [Broker id=2] Handling StopReplica request correlationId 12 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:12:24,487] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:29,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,487] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:29,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,488] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:28,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,488] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-05-17 14:12:24,488] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 12 epoch 6 for partition product-created-events-topics-1 since its associated leader epoch 16 matches the current leader epoch (state.change.logger)
[2024-05-17 14:12:24,488] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 12 epoch 6 for partition product-created-events-topics-2 since its associated leader epoch 16 matches the current leader epoch (state.change.logger)
[2024-05-17 14:12:24,488] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 1 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-17 14:12:24,488] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 12 epoch 6 for partition product-created-events-topics-0 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2024-05-17 14:12:24,488] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 3 partitions (state.change.logger)
[2024-05-17 14:12:24,488] INFO [Controller id=1 epoch=6] Sending StopReplica request for 3 replicas to broker 2 (state.change.logger)
[2024-05-17 14:12:24,489] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 35 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:12:24,491] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 35 from controller 1 epoch 6 as part of the become-leader transition for 3 partitions (state.change.logger)
[2024-05-17 14:12:24,491] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 7 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:12:24,491] INFO [Broker id=1] Leader product-created-events-topics-1 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [1,0] addingReplicas [] removingReplicas []. Previous leader epoch was 16. (state.change.logger)
[2024-05-17 14:12:24,492] INFO [Broker id=0] Follower product-created-events-topics-1 starts at leader epoch 17 from offset 0 with high watermark 0. Previous leader epoch was 16. (state.change.logger)
[2024-05-17 14:12:24,492] INFO [Broker id=0] Follower product-created-events-topics-0 starts at leader epoch 16 from offset 0 with high watermark 0. Previous leader epoch was 15. (state.change.logger)
[2024-05-17 14:12:24,492] INFO [Broker id=0] Follower product-created-events-topics-2 starts at leader epoch 17 from offset 0 with high watermark 0. Previous leader epoch was 16. (state.change.logger)
[2024-05-17 14:12:24,494] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 1 epoch 6 with correlation id 7 for 3 partitions (state.change.logger)
[2024-05-17 14:12:24,495] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 35 from controller 1 epoch 6 for partition product-created-events-topics-1 (last update controller epoch 6) since it is already the leader for the partition. (state.change.logger)
[2024-05-17 14:12:24,495] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [1,0] addingReplicas [] removingReplicas []. Previous leader epoch was 15. (state.change.logger)
[2024-05-17 14:12:24,496] INFO [Broker id=0] Finished LeaderAndIsr request in 5ms correlationId 7 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:12:24,499] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 35 from controller 1 epoch 6 for partition product-created-events-topics-0 (last update controller epoch 6) since it is already the leader for the partition. (state.change.logger)
[2024-05-17 14:12:24,499] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 8 (state.change.logger)
[2024-05-17 14:12:24,499] INFO [Broker id=1] Leader product-created-events-topics-2 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [1,0] addingReplicas [] removingReplicas []. Previous leader epoch was 16. (state.change.logger)
[2024-05-17 14:12:24,499] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 13 (state.change.logger)
[2024-05-17 14:12:24,501] INFO [Broker id=2] Handling StopReplica request correlationId 14 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:12:24,501] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 14 epoch 6 for partition product-created-events-topics-1 since its associated leader epoch 16 matches the current leader epoch (state.change.logger)
[2024-05-17 14:12:24,501] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 14 epoch 6 for partition product-created-events-topics-2 since its associated leader epoch 16 matches the current leader epoch (state.change.logger)
[2024-05-17 14:12:24,501] INFO [Broker id=2] Ignoring StopReplica request (delete=false) from controller 1 with correlation id 14 epoch 6 for partition product-created-events-topics-0 since its associated leader epoch 15 matches the current leader epoch (state.change.logger)
[2024-05-17 14:12:24,503] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 35 from controller 1 epoch 6 for partition product-created-events-topics-2 (last update controller epoch 6) since it is already the leader for the partition. (state.change.logger)
[2024-05-17 14:12:24,503] INFO [Broker id=1] Finished LeaderAndIsr request in 14ms correlationId 35 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:12:24,504] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 36 (state.change.logger)
[2024-05-17 14:12:24,634] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-17 14:12:24,642] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:12:24,642] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:12:24,643] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:12:24,643] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:12:24,643] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:12:24,643] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:12:24,643] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:12:24,643] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:12:24,643] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition product-List-event-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-List-event-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:12:24,644] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:12:24,644] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:12:24,644] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:12:24,644] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:12:24,644] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:12:24,644] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:12:24,644] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:12:24,644] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:12:24,644] ERROR [Controller id=1 epoch=6] Controller 1 epoch 6 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-05-17 14:12:24,645] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-05-17 14:12:24,655] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,655] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,655] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,655] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,655] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,655] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,655] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,655] INFO [Controller id=1 epoch=6] Partition product-List-event-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:7,ZkVersion:7,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,655] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,655] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:29,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,655] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,656] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,656] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,656] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,656] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,656] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,656] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:28,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,656] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,656] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,656] INFO [Controller id=1 epoch=6] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,656] INFO [Controller id=1 epoch=6] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:29,ControllerEpoch:6) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-05-17 14:12:24,656] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-05-17 14:12:24,656] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 1 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-17 14:12:24,657] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(0, 1) for 21 partitions (state.change.logger)
[2024-05-17 14:12:24,657] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 37 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:12:24,658] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 9 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:12:24,658] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 37 epoch 6 for partition product-created-events-topics-1 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2024-05-17 14:12:24,659] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 37 epoch 6 for partition product-created-events-topics-2 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2024-05-17 14:12:24,659] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 37 epoch 6 for partition product-created-events-topics-0 since its associated leader epoch 16 matches the current leader epoch (state.change.logger)
[2024-05-17 14:12:24,659] INFO [Broker id=1] Finished LeaderAndIsr request in 2ms correlationId 37 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:12:24,660] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 1 with correlation id 9 epoch 6 for partition product-created-events-topics-1 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2024-05-17 14:12:24,660] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 1 with correlation id 9 epoch 6 for partition product-created-events-topics-2 since its associated leader epoch 17 matches the current leader epoch (state.change.logger)
[2024-05-17 14:12:24,660] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 1 with correlation id 9 epoch 6 for partition product-created-events-topics-0 since its associated leader epoch 16 matches the current leader epoch (state.change.logger)
[2024-05-17 14:12:24,660] INFO [Broker id=1] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 38 (state.change.logger)
[2024-05-17 14:12:24,660] INFO [Broker id=0] Finished LeaderAndIsr request in 3ms correlationId 9 from controller 1 for 3 partitions (state.change.logger)
[2024-05-17 14:12:24,662] INFO [Broker id=0] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 10 (state.change.logger)
[2024-05-17 14:13:01,173] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(0, 1) for 0 partitions (state.change.logger)
[2024-05-17 14:13:01,174] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(2) for 57 partitions (state.change.logger)
[2024-05-17 14:13:01,175] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 21 become-follower partitions (state.change.logger)
[2024-05-17 14:13:01,176] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 21 partitions (state.change.logger)
[2024-05-17 14:13:01,177] INFO [Broker id=1] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 40 (state.change.logger)
[2024-05-17 14:13:01,177] INFO [Broker id=0] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 12 (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-30 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=12, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-33 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=12, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-36 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=12, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-48 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=12, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-6 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=12, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=12, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-45 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=12, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-21 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=12, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Changed partition product-List-event-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=8, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=8) (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-27 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=12, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-9 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=12, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-42 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=12, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=12, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-18 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=12, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-15 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=12, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-24 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=12, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-39 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=12, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Changed partition __consumer_offsets-12 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=12, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Sending LeaderAndIsr request to broker 2 with 18 become-leader and 0 become-follower partitions (state.change.logger)
[2024-05-17 14:13:01,191] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 18 partitions (state.change.logger)
[2024-05-17 14:13:01,192] INFO [Broker id=1] Add 18 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 41 (state.change.logger)
[2024-05-17 14:13:01,193] INFO [Broker id=0] Add 18 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 13 (state.change.logger)
[2024-05-17 14:13:01,549] INFO [Broker id=2] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 0 (state.change.logger)
[2024-05-17 14:13:01,564] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 1 for 21 partitions (state.change.logger)
[2024-05-17 14:13:01,595] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-3 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:13:01,599] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-18 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:13:01,599] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-39 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:13:01,600] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-9 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:13:01,601] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-24 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:13:01,602] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-27 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:13:01,610] INFO [Broker id=2] Follower product-created-events-topics-1 starts at leader epoch 17 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,610] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-42 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:13:01,611] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-12 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:13:01,611] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-33 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:13:01,611] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-48 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:13:01,612] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-21 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:13:01,612] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-36 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:13:01,613] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-6 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:13:01,614] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition product-List-event-0 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:13:01,615] INFO [Broker id=2] Follower product-created-events-topics-0 starts at leader epoch 16 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,615] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-45 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:13:01,617] INFO [Broker id=2] Follower product-created-events-topics-2 starts at leader epoch 17 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,618] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-15 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:13:01,620] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-30 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:13:01,622] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 6 for partition __consumer_offsets-0 (last update controller epoch 6) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-05-17 14:13:01,627] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 6 with correlation id 1 for 3 partitions (state.change.logger)
[2024-05-17 14:13:01,694] INFO [Broker id=2] Finished LeaderAndIsr request in 130ms correlationId 1 from controller 1 for 21 partitions (state.change.logger)
[2024-05-17 14:13:01,699] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-05-17 14:13:01,701] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 42 (state.change.logger)
[2024-05-17 14:13:01,701] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 14 (state.change.logger)
[2024-05-17 14:13:01,702] INFO [Broker id=2] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 2 (state.change.logger)
[2024-05-17 14:13:01,704] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 1 for 18 partitions (state.change.logger)
[2024-05-17 14:13:01,709] INFO [Controller id=1 epoch=6] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 2 partitions (state.change.logger)
[2024-05-17 14:13:01,709] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 6 as part of the become-leader transition for 18 partitions (state.change.logger)
[2024-05-17 14:13:01,710] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 15 (state.change.logger)
[2024-05-17 14:13:01,713] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 43 (state.change.logger)
[2024-05-17 14:13:01,714] INFO [Broker id=2] Leader __consumer_offsets-3 starts at leader epoch 12 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,721] INFO [Broker id=2] Leader __consumer_offsets-18 starts at leader epoch 12 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,725] INFO [Broker id=2] Leader __consumer_offsets-39 starts at leader epoch 12 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,728] INFO [Broker id=2] Leader __consumer_offsets-9 starts at leader epoch 12 from offset 37 with high watermark 37 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,731] INFO [Broker id=2] Leader __consumer_offsets-24 starts at leader epoch 12 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,733] INFO [Broker id=2] Leader __consumer_offsets-27 starts at leader epoch 12 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,736] INFO [Broker id=2] Leader __consumer_offsets-42 starts at leader epoch 12 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,739] INFO [Broker id=2] Leader __consumer_offsets-12 starts at leader epoch 12 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,741] INFO [Broker id=2] Leader __consumer_offsets-33 starts at leader epoch 12 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,743] INFO [Broker id=2] Leader __consumer_offsets-48 starts at leader epoch 12 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,745] INFO [Broker id=2] Leader __consumer_offsets-21 starts at leader epoch 12 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,747] INFO [Broker id=2] Leader __consumer_offsets-36 starts at leader epoch 12 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,749] INFO [Broker id=2] Leader __consumer_offsets-6 starts at leader epoch 12 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,751] INFO [Broker id=2] Leader product-List-event-0 starts at leader epoch 8 from offset 11 with high watermark 11 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,754] INFO [Broker id=2] Leader __consumer_offsets-45 starts at leader epoch 12 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,756] INFO [Broker id=2] Leader __consumer_offsets-15 starts at leader epoch 12 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,758] INFO [Broker id=2] Leader __consumer_offsets-30 starts at leader epoch 12 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,760] INFO [Broker id=2] Leader __consumer_offsets-0 starts at leader epoch 12 from offset 3 with high watermark 3 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-05-17 14:13:01,778] INFO [Broker id=2] Finished LeaderAndIsr request in 74ms correlationId 3 from controller 1 for 18 partitions (state.change.logger)
[2024-05-17 14:13:01,780] INFO [Broker id=2] Add 18 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 4 (state.change.logger)
[2024-05-17 14:13:01,782] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 5 (state.change.logger)
[2024-05-17 14:13:01,784] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 6 with correlation id 6 (state.change.logger)
[2024-10-16 12:15:33,669] INFO [Controller id=1 epoch=7] Sending UpdateMetadata request to brokers HashSet(1) for 0 partitions (state.change.logger)
[2024-10-16 12:15:33,768] INFO [Controller id=1 epoch=7] Sending LeaderAndIsr request to broker 1 with 23 become-leader and 0 become-follower partitions (state.change.logger)
[2024-10-16 12:15:33,776] INFO [Controller id=1 epoch=7] Sending UpdateMetadata request to brokers HashSet(1) for 23 partitions (state.change.logger)
[2024-10-16 12:15:33,860] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 23 partitions (state.change.logger)
[2024-10-16 12:15:33,905] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:33,905] INFO [Controller id=1 epoch=7] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:31,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:33,906] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:33,906] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:33,906] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:33,906] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:33,906] INFO [Controller id=1 epoch=7] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:31,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:33,906] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:33,906] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:33,906] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:33,906] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:33,912] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:33,913] INFO [Controller id=1 epoch=7] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:30,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:33,914] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:33,914] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:33,914] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:33,914] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:33,914] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:33,914] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:7) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:33,971] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 1 from controller 1 epoch 7 as part of the become-leader transition for 23 partitions (state.change.logger)
[2024-10-16 12:15:34,009] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,010] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,010] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,010] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,010] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,011] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,011] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,011] INFO [Controller id=1 epoch=7] Partition product-List-event-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:9,ZkVersion:9,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,011] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,011] INFO [Controller id=1 epoch=7] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:32,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,012] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,012] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,012] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,012] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,012] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,012] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,012] INFO [Controller id=1 epoch=7] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:31,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,012] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,012] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,012] INFO [Controller id=1 epoch=7] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,013] INFO [Controller id=1 epoch=7] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:32,ControllerEpoch:7) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:15:34,013] INFO [Controller id=1 epoch=7] Sending LeaderAndIsr request to broker 1 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-10-16 12:15:34,013] INFO [Controller id=1 epoch=7] Sending UpdateMetadata request to brokers HashSet(1) for 37 partitions (state.change.logger)
[2024-10-16 12:15:34,014] INFO [Broker id=1] Leader __consumer_offsets-37 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,026] INFO [Broker id=1] Leader __consumer_offsets-7 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,030] INFO [Broker id=1] Leader __consumer_offsets-22 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,035] INFO [Broker id=1] Leader product-created-events-topics-1 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [1,0,2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,046] INFO [Broker id=1] Leader __consumer_offsets-10 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,051] INFO [Broker id=1] Leader __consumer_offsets-31 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,065] INFO [Broker id=1] Leader __consumer_offsets-46 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,071] INFO [Broker id=1] Leader __consumer_offsets-1 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,085] INFO [Broker id=1] Leader product-created-events-topic-0 starts at leader epoch 4 from offset 57 with high watermark 57 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,086] INFO [Broker id=1] Leader product-created-events-topic.DLT-0 starts at leader epoch 2 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,101] INFO [Broker id=1] Leader __consumer_offsets-16 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,117] INFO [Broker id=1] Leader __consumer_offsets-19 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,122] INFO [Broker id=1] Leader __consumer_offsets-34 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,132] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,133] INFO [Broker id=1] Leader __consumer_offsets-4 starts at leader epoch 4 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,138] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,138] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,139] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,139] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,147] INFO [Broker id=1] Leader __consumer_offsets-25 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,154] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,163] INFO [Broker id=1] Leader __consumer_offsets-40 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,167] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,167] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,168] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,168] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,168] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition product-List-event-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-List-event-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,168] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,169] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,169] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,169] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,170] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,170] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,170] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,170] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,171] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,171] INFO [Broker id=1] Leader __consumer_offsets-43 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,179] INFO [Broker id=1] Leader product-List-evnt-0 starts at leader epoch 2 from offset 18 with high watermark 18 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,171] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,181] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,181] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,183] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,183] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [1,0,2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,184] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,184] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,184] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,185] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,185] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,185] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,185] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,185] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,186] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,187] ERROR [Controller id=1 epoch=7] Controller 1 epoch 7 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processStartup(KafkaController.scala:1433)
	at kafka.controller.KafkaController.process(KafkaController.scala:2568)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:15:34,187] INFO [Broker id=1] Leader __consumer_offsets-13 starts at leader epoch 4 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,196] INFO [Broker id=1] Leader __consumer_offsets-28 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,198] INFO [Controller id=1 epoch=7] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-10-16 12:15:34,200] INFO [Broker id=1] Leader product-created-events-topics-2 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [1,0,2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,207] INFO [Broker id=1] Leader __consumer_offsets-49 starts at leader epoch 4 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:15:34,270] INFO [Broker id=1] Finished LeaderAndIsr request in 413ms correlationId 1 from controller 1 for 23 partitions (state.change.logger)
[2024-10-16 12:15:34,302] INFO [Broker id=1] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 7 with correlation id 2 (state.change.logger)
[2024-10-16 12:15:34,308] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-10-16 12:15:34,313] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 7 as part of the become-leader transition for 3 partitions (state.change.logger)
[2024-10-16 12:15:34,314] INFO [Broker id=1] Leader product-created-events-topics-1 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was 17. (state.change.logger)
[2024-10-16 12:15:34,328] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 1 epoch 7 for partition product-created-events-topics-1 (last update controller epoch 7) since it is already the leader for the partition. (state.change.logger)
[2024-10-16 12:15:34,329] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was 16. (state.change.logger)
[2024-10-16 12:15:34,333] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 1 epoch 7 for partition product-created-events-topics-0 (last update controller epoch 7) since it is already the leader for the partition. (state.change.logger)
[2024-10-16 12:15:34,333] INFO [Broker id=1] Leader product-created-events-topics-2 starts at leader epoch 19 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was 17. (state.change.logger)
[2024-10-16 12:15:34,344] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 3 from controller 1 epoch 7 for partition product-created-events-topics-2 (last update controller epoch 7) since it is already the leader for the partition. (state.change.logger)
[2024-10-16 12:15:34,344] INFO [Broker id=1] Finished LeaderAndIsr request in 36ms correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-10-16 12:15:34,348] INFO [Broker id=1] Add 37 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 7 with correlation id 4 (state.change.logger)
[2024-10-16 12:16:19,277] INFO [Controller id=2 epoch=8] Sending UpdateMetadata request to brokers HashSet(2) for 0 partitions (state.change.logger)
[2024-10-16 12:16:19,373] INFO [Controller id=2 epoch=8] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 21 become-follower partitions (state.change.logger)
[2024-10-16 12:16:19,377] INFO [Controller id=2 epoch=8] Sending UpdateMetadata request to brokers HashSet(2) for 21 partitions (state.change.logger)
[2024-10-16 12:16:19,536] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 2 for 21 partitions (state.change.logger)
[2024-10-16 12:16:19,552] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,552] INFO [Controller id=2 epoch=8] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:32,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,553] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,553] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,553] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,553] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,553] INFO [Controller id=2 epoch=8] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:32,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,553] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,553] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,553] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,554] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,554] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,554] INFO [Controller id=2 epoch=8] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:31,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,554] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,554] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,554] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,554] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,554] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,555] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:12,ZkVersion:12,ControllerEpoch:8) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,735] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-3 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,753] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-18 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,754] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-39 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,754] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-9 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,755] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-24 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,755] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-27 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,756] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition product-created-events-topics-1 (last update controller epoch 7) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,756] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-42 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,756] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,757] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-12 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,757] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-33 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,757] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,758] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-48 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,758] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,758] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-21 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,758] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,758] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,758] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,758] INFO [Controller id=2 epoch=8] Partition product-created-events-topic-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,759] INFO [Controller id=2 epoch=8] Partition product-created-events-topics-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:19,ZkVersion:32,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,759] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,759] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,759] INFO [Controller id=2 epoch=8] Partition product-created-events-topics-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:33,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,759] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,759] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,759] INFO [Controller id=2 epoch=8] Partition product-created-events-topics-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:33,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,760] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,760] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,760] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,760] INFO [Controller id=2 epoch=8] Partition product-created-events-topic.DLT-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,760] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,761] INFO [Controller id=2 epoch=8] Partition product-List-evnt-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,761] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,765] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-36 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,765] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,765] INFO [Controller id=2 epoch=8] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:8) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:19,766] INFO [Controller id=2 epoch=8] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-10-16 12:16:19,766] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-6 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,766] INFO [Controller id=2 epoch=8] Sending UpdateMetadata request to brokers HashSet(2) for 39 partitions (state.change.logger)
[2024-10-16 12:16:19,767] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition product-List-event-0 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,767] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition product-created-events-topics-0 (last update controller epoch 7) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,768] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-45 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,768] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition product-created-events-topics-2 (last update controller epoch 7) but cannot become follower since the new leader 1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,769] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-15 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,770] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-30 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,770] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-0 (last update controller epoch 7) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,773] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 2 epoch 8 with correlation id 1 for 0 partitions (state.change.logger)
[2024-10-16 12:16:19,826] INFO [Broker id=2] Finished LeaderAndIsr request in 291ms correlationId 1 from controller 2 for 21 partitions (state.change.logger)
[2024-10-16 12:16:19,867] INFO [Broker id=2] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 2 (state.change.logger)
[2024-10-16 12:16:19,870] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 2 for 3 partitions (state.change.logger)
[2024-10-16 12:16:19,875] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 3 from controller 2 epoch 8 for partition product-created-events-topics-1 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,879] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 3 from controller 2 epoch 8 for partition product-created-events-topics-0 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,879] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 3 from controller 2 epoch 8 for partition product-created-events-topics-2 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:19,879] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 2 epoch 8 with correlation id 3 for 0 partitions (state.change.logger)
[2024-10-16 12:16:19,880] INFO [Broker id=2] Finished LeaderAndIsr request in 11ms correlationId 3 from controller 2 for 3 partitions (state.change.logger)
[2024-10-16 12:16:19,884] INFO [Broker id=2] Add 39 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 4 (state.change.logger)
[2024-10-16 12:16:20,028] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,031] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,031] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,032] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,032] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-created-events-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,033] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,035] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,035] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,035] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,036] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,036] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-created-events-topics-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,037] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,047] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,047] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,048] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,048] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,048] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,048] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,049] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,049] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,050] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-created-events-topics-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,050] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,050] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,051] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,052] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-created-events-topic.DLT-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic.DLT-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,053] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,054] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,054] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,055] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,055] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-created-events-topics-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,056] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,056] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,056] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,057] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,057] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-List-evnt-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-List-evnt-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,057] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,057] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,057] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,064] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:20,067] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-30 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=14, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-10-16 12:16:20,067] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-21 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=14, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-10-16 12:16:20,067] INFO [Controller id=2 epoch=8] Changed partition product-List-event-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=10, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=10) (state.change.logger)
[2024-10-16 12:16:20,067] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-27 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=14, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-10-16 12:16:20,067] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-9 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=14, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-10-16 12:16:20,067] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-33 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=14, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-10-16 12:16:20,067] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-36 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=14, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-10-16 12:16:20,067] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-42 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=14, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-10-16 12:16:20,067] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=14, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-10-16 12:16:20,067] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-18 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=14, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-10-16 12:16:20,067] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-15 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=14, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-10-16 12:16:20,067] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-24 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=14, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-10-16 12:16:20,067] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-48 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=14, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-10-16 12:16:20,067] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-6 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=14, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-10-16 12:16:20,067] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=14, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-10-16 12:16:20,067] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-39 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=14, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-10-16 12:16:20,067] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-12 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=14, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-10-16 12:16:20,067] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-45 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=14, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-10-16 12:16:20,067] INFO [Controller id=2 epoch=8] Sending LeaderAndIsr request to broker 2 with 18 become-leader and 0 become-follower partitions (state.change.logger)
[2024-10-16 12:16:20,068] INFO [Controller id=2 epoch=8] Sending UpdateMetadata request to brokers HashSet(2) for 18 partitions (state.change.logger)
[2024-10-16 12:16:20,085] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 5 from controller 2 for 18 partitions (state.change.logger)
[2024-10-16 12:16:20,107] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 2 epoch 8 as part of the become-leader transition for 18 partitions (state.change.logger)
[2024-10-16 12:16:20,119] INFO [Broker id=2] Leader __consumer_offsets-3 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:20,127] INFO [Broker id=2] Leader __consumer_offsets-18 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:20,137] INFO [Broker id=2] Leader __consumer_offsets-39 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:20,141] INFO [Broker id=2] Leader __consumer_offsets-9 starts at leader epoch 14 from offset 46 with high watermark 46 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:20,143] INFO [Broker id=2] Leader __consumer_offsets-24 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:20,147] INFO [Broker id=2] Leader __consumer_offsets-27 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:20,154] INFO [Broker id=2] Leader __consumer_offsets-42 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:20,158] INFO [Broker id=2] Leader __consumer_offsets-12 starts at leader epoch 14 from offset 1 with high watermark 1 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:20,161] INFO [Broker id=2] Leader __consumer_offsets-33 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:20,163] INFO [Broker id=2] Leader __consumer_offsets-48 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:20,166] INFO [Broker id=2] Leader __consumer_offsets-21 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:20,175] INFO [Broker id=2] Leader __consumer_offsets-36 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:20,178] INFO [Broker id=2] Leader __consumer_offsets-6 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:20,181] INFO [Broker id=2] Leader product-List-event-0 starts at leader epoch 10 from offset 11 with high watermark 11 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:20,184] INFO [Broker id=2] Leader __consumer_offsets-45 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:20,195] INFO [Broker id=2] Leader __consumer_offsets-15 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:20,198] INFO [Broker id=2] Leader __consumer_offsets-30 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:20,200] INFO [Broker id=2] Leader __consumer_offsets-0 starts at leader epoch 14 from offset 3 with high watermark 3 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:20,461] INFO [Broker id=2] Finished LeaderAndIsr request in 376ms correlationId 5 from controller 2 for 18 partitions (state.change.logger)
[2024-10-16 12:16:20,464] INFO [Broker id=2] Add 18 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 6 (state.change.logger)
[2024-10-16 12:16:29,520] INFO [Controller id=2 epoch=8] Sending UpdateMetadata request to brokers HashSet(2) for 0 partitions (state.change.logger)
[2024-10-16 12:16:29,522] INFO [Controller id=2 epoch=8] Sending UpdateMetadata request to brokers HashSet(0) for 57 partitions (state.change.logger)
[2024-10-16 12:16:29,531] INFO [Controller id=2 epoch=8] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 19 become-follower partitions (state.change.logger)
[2024-10-16 12:16:29,531] INFO [Controller id=2 epoch=8] Sending UpdateMetadata request to brokers HashSet(0, 2) for 19 partitions (state.change.logger)
[2024-10-16 12:16:29,534] INFO [Broker id=2] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 8 (state.change.logger)
[2024-10-16 12:16:29,610] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,610] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,610] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,610] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,613] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-created-events-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,613] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,614] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-created-events-topics-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,614] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,614] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,615] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-created-events-topics-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,615] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,615] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,615] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,615] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,616] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-created-events-topics-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,616] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,616] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-created-events-topic.DLT-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic.DLT-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,616] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,616] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,619] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition product-List-evnt-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-List-evnt-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,619] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,619] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,619] ERROR [Controller id=2 epoch=8] Controller 2 epoch 8 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:29,620] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-35 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=13) (state.change.logger)
[2024-10-16 12:16:29,620] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-38 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=13) (state.change.logger)
[2024-10-16 12:16:29,620] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-8 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=13) (state.change.logger)
[2024-10-16 12:16:29,620] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-41 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=13) (state.change.logger)
[2024-10-16 12:16:29,620] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-23 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=13) (state.change.logger)
[2024-10-16 12:16:29,620] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-47 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=13) (state.change.logger)
[2024-10-16 12:16:29,620] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-17 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=13) (state.change.logger)
[2024-10-16 12:16:29,620] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-11 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=13) (state.change.logger)
[2024-10-16 12:16:29,620] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=13) (state.change.logger)
[2024-10-16 12:16:29,620] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-14 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=13) (state.change.logger)
[2024-10-16 12:16:29,620] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-20 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=13) (state.change.logger)
[2024-10-16 12:16:29,620] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-44 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=13) (state.change.logger)
[2024-10-16 12:16:29,620] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=13) (state.change.logger)
[2024-10-16 12:16:29,620] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-26 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=13) (state.change.logger)
[2024-10-16 12:16:29,620] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-29 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=13) (state.change.logger)
[2024-10-16 12:16:29,620] INFO [Controller id=2 epoch=8] Changed partition __consumer_offsets-32 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=13, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=13) (state.change.logger)
[2024-10-16 12:16:29,621] INFO [Controller id=2 epoch=8] Sending LeaderAndIsr request to broker 0 with 16 become-leader and 0 become-follower partitions (state.change.logger)
[2024-10-16 12:16:29,621] INFO [Controller id=2 epoch=8] Sending UpdateMetadata request to brokers HashSet(0, 2) for 16 partitions (state.change.logger)
[2024-10-16 12:16:29,625] INFO [Broker id=2] Add 16 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 9 (state.change.logger)
[2024-10-16 12:16:30,463] INFO [Broker id=0] Add 57 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 0 (state.change.logger)
[2024-10-16 12:16:30,507] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 2 for 19 partitions (state.change.logger)
[2024-10-16 12:16:30,608] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-35 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:30,613] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-5 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:30,614] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-20 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:30,628] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-41 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:30,631] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition product-created-events-topics-1 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:30,632] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-29 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:30,643] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-44 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:30,664] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-14 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:30,668] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-2 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:30,682] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-23 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:30,688] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-38 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:30,690] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-8 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:30,691] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-11 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:30,691] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-26 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:30,702] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition product-created-events-topics-0 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:30,709] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition product-created-events-topics-2 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:30,710] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-47 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:30,712] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-17 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:30,726] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 2 epoch 8 for partition __consumer_offsets-32 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:30,729] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 2 epoch 8 with correlation id 1 for 0 partitions (state.change.logger)
[2024-10-16 12:16:30,765] INFO [Broker id=0] Finished LeaderAndIsr request in 259ms correlationId 1 from controller 2 for 19 partitions (state.change.logger)
[2024-10-16 12:16:30,792] INFO [Broker id=0] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 2 (state.change.logger)
[2024-10-16 12:16:30,806] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 2 for 16 partitions (state.change.logger)
[2024-10-16 12:16:30,813] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 2 epoch 8 as part of the become-leader transition for 16 partitions (state.change.logger)
[2024-10-16 12:16:30,834] INFO [Broker id=0] Leader __consumer_offsets-35 starts at leader epoch 13 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:30,852] INFO [Broker id=0] Leader __consumer_offsets-5 starts at leader epoch 13 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:30,855] INFO [Broker id=0] Leader __consumer_offsets-20 starts at leader epoch 13 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:30,864] INFO [Broker id=0] Leader __consumer_offsets-41 starts at leader epoch 13 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:30,868] INFO [Broker id=0] Leader __consumer_offsets-29 starts at leader epoch 13 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:30,871] INFO [Broker id=0] Leader __consumer_offsets-44 starts at leader epoch 13 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:30,883] INFO [Broker id=0] Leader __consumer_offsets-14 starts at leader epoch 13 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:30,886] INFO [Broker id=0] Leader __consumer_offsets-2 starts at leader epoch 13 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:30,889] INFO [Broker id=0] Leader __consumer_offsets-23 starts at leader epoch 13 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:30,899] INFO [Broker id=0] Leader __consumer_offsets-38 starts at leader epoch 13 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:30,902] INFO [Broker id=0] Leader __consumer_offsets-8 starts at leader epoch 13 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:30,916] INFO [Broker id=0] Leader __consumer_offsets-11 starts at leader epoch 13 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:30,920] INFO [Broker id=0] Leader __consumer_offsets-26 starts at leader epoch 13 from offset 135 with high watermark 135 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:30,923] INFO [Broker id=0] Leader __consumer_offsets-47 starts at leader epoch 13 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:30,935] INFO [Broker id=0] Leader __consumer_offsets-17 starts at leader epoch 13 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:30,937] INFO [Broker id=0] Leader __consumer_offsets-32 starts at leader epoch 13 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:16:31,040] INFO [Broker id=0] Finished LeaderAndIsr request in 232ms correlationId 3 from controller 2 for 16 partitions (state.change.logger)
[2024-10-16 12:16:31,074] INFO [Broker id=0] Add 16 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 2 epoch 8 with correlation id 4 (state.change.logger)
[2024-10-16 12:16:49,257] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2024-10-16 12:16:49,325] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 0 with 16 become-leader and 3 become-follower partitions (state.change.logger)
[2024-10-16 12:16:49,329] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0) for 19 partitions (state.change.logger)
[2024-10-16 12:16:49,332] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 0 for 19 partitions (state.change.logger)
[2024-10-16 12:16:49,334] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 9 for partition __consumer_offsets-47 since its associated leader epoch 13 matches the current leader epoch (state.change.logger)
[2024-10-16 12:16:49,334] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 9 for partition __consumer_offsets-14 since its associated leader epoch 13 matches the current leader epoch (state.change.logger)
[2024-10-16 12:16:49,334] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 9 for partition __consumer_offsets-11 since its associated leader epoch 13 matches the current leader epoch (state.change.logger)
[2024-10-16 12:16:49,334] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 9 for partition __consumer_offsets-44 since its associated leader epoch 13 matches the current leader epoch (state.change.logger)
[2024-10-16 12:16:49,334] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 9 for partition __consumer_offsets-41 since its associated leader epoch 13 matches the current leader epoch (state.change.logger)
[2024-10-16 12:16:49,334] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 9 for partition __consumer_offsets-23 since its associated leader epoch 13 matches the current leader epoch (state.change.logger)
[2024-10-16 12:16:49,334] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 9 for partition __consumer_offsets-20 since its associated leader epoch 13 matches the current leader epoch (state.change.logger)
[2024-10-16 12:16:49,334] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 9 for partition __consumer_offsets-17 since its associated leader epoch 13 matches the current leader epoch (state.change.logger)
[2024-10-16 12:16:49,334] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 9 for partition __consumer_offsets-32 since its associated leader epoch 13 matches the current leader epoch (state.change.logger)
[2024-10-16 12:16:49,334] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 9 for partition __consumer_offsets-29 since its associated leader epoch 13 matches the current leader epoch (state.change.logger)
[2024-10-16 12:16:49,334] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 9 for partition __consumer_offsets-26 since its associated leader epoch 13 matches the current leader epoch (state.change.logger)
[2024-10-16 12:16:49,335] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 9 for partition __consumer_offsets-8 since its associated leader epoch 13 matches the current leader epoch (state.change.logger)
[2024-10-16 12:16:49,335] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 9 for partition __consumer_offsets-5 since its associated leader epoch 13 matches the current leader epoch (state.change.logger)
[2024-10-16 12:16:49,335] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 9 for partition __consumer_offsets-38 since its associated leader epoch 13 matches the current leader epoch (state.change.logger)
[2024-10-16 12:16:49,335] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 9 for partition __consumer_offsets-35 since its associated leader epoch 13 matches the current leader epoch (state.change.logger)
[2024-10-16 12:16:49,335] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 1 epoch 9 for partition __consumer_offsets-2 since its associated leader epoch 13 matches the current leader epoch (state.change.logger)
[2024-10-16 12:16:49,335] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition product-created-events-topics-1 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:49,335] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition product-created-events-topics-0 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:49,335] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition product-created-events-topics-2 (last update controller epoch 8) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:49,335] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 1 for 0 partitions (state.change.logger)
[2024-10-16 12:16:49,335] INFO [Broker id=0] Finished LeaderAndIsr request in 3ms correlationId 1 from controller 0 for 19 partitions (state.change.logger)
[2024-10-16 12:16:49,341] INFO [Broker id=0] Add 19 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 2 (state.change.logger)
[2024-10-16 12:16:49,399] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,400] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,400] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,400] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,400] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,400] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,400] INFO [Controller id=0 epoch=9] Partition product-created-events-topic-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,400] INFO [Controller id=0 epoch=9] Partition product-created-events-topics-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:33,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,401] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,401] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,401] INFO [Controller id=0 epoch=9] Partition product-created-events-topics-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:21,ZkVersion:34,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,401] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,401] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,401] INFO [Controller id=0 epoch=9] Partition product-created-events-topics-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:21,ZkVersion:34,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,401] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,401] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,402] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,402] INFO [Controller id=0 epoch=9] Partition product-created-events-topic.DLT-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,402] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,402] INFO [Controller id=0 epoch=9] Partition product-List-evnt-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:4,ZkVersion:4,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,402] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,402] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,402] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,438] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,438] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,438] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,438] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,438] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,439] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,439] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,439] INFO [Controller id=0 epoch=9] Partition product-List-event-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:11,ZkVersion:11,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,439] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,439] INFO [Controller id=0 epoch=9] Partition product-created-events-topics-2 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:21,ZkVersion:34,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,439] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,439] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,439] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,440] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,440] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,440] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,440] INFO [Controller id=0 epoch=9] Partition product-created-events-topics-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:20,ZkVersion:33,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,441] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,441] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,441] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:15,ZkVersion:15,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,441] INFO [Controller id=0 epoch=9] Partition product-created-events-topics-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:21,ZkVersion:34,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:16:49,441] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-10-16 12:16:49,441] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0) for 41 partitions (state.change.logger)
[2024-10-16 12:16:49,442] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2024-10-16 12:16:49,442] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 9 for partition product-created-events-topics-1 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:49,442] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 9 for partition product-created-events-topics-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:49,442] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 3 from controller 0 epoch 9 for partition product-created-events-topics-2 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:16:49,442] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 3 for 0 partitions (state.change.logger)
[2024-10-16 12:16:49,443] INFO [Broker id=0] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 0 for 3 partitions (state.change.logger)
[2024-10-16 12:16:49,446] INFO [Broker id=0] Add 41 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 4 (state.change.logger)
[2024-10-16 12:16:49,503] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,505] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,506] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,506] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,506] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-created-events-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,507] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,507] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,507] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,508] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,508] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-List-event-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-List-event-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,508] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,509] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,509] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,509] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-created-events-topics-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,510] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,510] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,510] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,510] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,511] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,511] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,511] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,512] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,512] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,513] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,514] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,515] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,515] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,515] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-created-events-topics-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,517] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,518] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-created-events-topic.DLT-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic.DLT-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,518] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,518] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,519] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,519] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,519] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-created-events-topics-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,520] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,520] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,520] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-List-evnt-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-List-evnt-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,520] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,521] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,522] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:16:49,523] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-10-16 12:17:48,358] INFO [Controller id=0 epoch=9] Changed partition topic2-0 state from NonExistentPartition to NewPartition with assigned replicas 0 (state.change.logger)
[2024-10-16 12:17:48,358] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-10-16 12:17:48,359] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-10-16 12:17:48,383] INFO [Controller id=0 epoch=9] Changed partition topic2-0 from NewPartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=0, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=0) (state.change.logger)
[2024-10-16 12:17:48,383] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 0 with 1 become-leader and 0 become-follower partitions (state.change.logger)
[2024-10-16 12:17:48,383] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0) for 1 partitions (state.change.logger)
[2024-10-16 12:17:48,384] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-10-16 12:17:48,385] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 5 from controller 0 for 1 partitions (state.change.logger)
[2024-10-16 12:17:48,386] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 0 epoch 9 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-10-16 12:17:48,413] INFO [Broker id=0] Leader topic2-0 starts at leader epoch 0 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:17:48,416] INFO [Broker id=0] Finished LeaderAndIsr request in 31ms correlationId 5 from controller 0 for 1 partitions (state.change.logger)
[2024-10-16 12:17:48,418] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 6 (state.change.logger)
[2024-10-16 12:18:30,535] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2024-10-16 12:18:30,541] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(2) for 58 partitions (state.change.logger)
[2024-10-16 12:18:30,545] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 21 become-follower partitions (state.change.logger)
[2024-10-16 12:18:30,546] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0, 2) for 21 partitions (state.change.logger)
[2024-10-16 12:18:30,550] INFO [Broker id=0] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 8 (state.change.logger)
[2024-10-16 12:18:30,613] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,614] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,614] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,614] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-created-events-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,614] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,615] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,615] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,615] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,615] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-created-events-topics-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,615] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,616] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,616] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,616] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,616] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,616] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-created-events-topics-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,616] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-created-events-topic.DLT-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic.DLT-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,616] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,617] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-created-events-topics-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topics-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,617] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,618] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-List-evnt-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-List-evnt-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,618] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,618] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,618] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:18:30,619] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-30 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=16, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=16) (state.change.logger)
[2024-10-16 12:18:30,619] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=16, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=16) (state.change.logger)
[2024-10-16 12:18:30,619] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-21 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=16, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=16) (state.change.logger)
[2024-10-16 12:18:30,619] INFO [Controller id=0 epoch=9] Changed partition product-List-event-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=12, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=12) (state.change.logger)
[2024-10-16 12:18:30,619] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-27 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=16, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=16) (state.change.logger)
[2024-10-16 12:18:30,619] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-9 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=16, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=16) (state.change.logger)
[2024-10-16 12:18:30,619] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-33 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=16, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=16) (state.change.logger)
[2024-10-16 12:18:30,619] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-36 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=16, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=16) (state.change.logger)
[2024-10-16 12:18:30,619] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-42 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=16, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=16) (state.change.logger)
[2024-10-16 12:18:30,619] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=16, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=16) (state.change.logger)
[2024-10-16 12:18:30,619] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-18 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=16, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=16) (state.change.logger)
[2024-10-16 12:18:30,619] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-15 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=16, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=16) (state.change.logger)
[2024-10-16 12:18:30,619] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-24 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=16, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=16) (state.change.logger)
[2024-10-16 12:18:30,619] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-48 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=16, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=16) (state.change.logger)
[2024-10-16 12:18:30,619] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-6 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=16, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=16) (state.change.logger)
[2024-10-16 12:18:30,619] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-39 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=16, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=16) (state.change.logger)
[2024-10-16 12:18:30,619] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-12 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=16, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=16) (state.change.logger)
[2024-10-16 12:18:30,619] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-45 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=16, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=16) (state.change.logger)
[2024-10-16 12:18:30,619] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 2 with 18 become-leader and 0 become-follower partitions (state.change.logger)
[2024-10-16 12:18:30,620] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0, 2) for 18 partitions (state.change.logger)
[2024-10-16 12:18:30,622] INFO [Broker id=0] Add 18 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 9 (state.change.logger)
[2024-10-16 12:18:31,166] INFO [Broker id=2] Add 58 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 0 (state.change.logger)
[2024-10-16 12:18:31,193] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 0 for 21 partitions (state.change.logger)
[2024-10-16 12:18:31,258] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-3 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,267] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-18 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,267] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-39 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,268] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-9 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,272] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-24 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,273] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-27 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,274] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition product-created-events-topics-1 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,275] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-42 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,276] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-12 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,277] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-33 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,281] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-48 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,282] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-21 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,283] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-36 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,284] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-6 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,284] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition product-List-event-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,285] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition product-created-events-topics-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,286] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-45 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,286] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition product-created-events-topics-2 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,288] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-15 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,289] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-30 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,290] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:31,294] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 1 for 0 partitions (state.change.logger)
[2024-10-16 12:18:31,314] INFO [Broker id=2] Finished LeaderAndIsr request in 122ms correlationId 1 from controller 0 for 21 partitions (state.change.logger)
[2024-10-16 12:18:31,332] INFO [Broker id=2] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 2 (state.change.logger)
[2024-10-16 12:18:31,336] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 0 for 18 partitions (state.change.logger)
[2024-10-16 12:18:31,346] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 9 as part of the become-leader transition for 18 partitions (state.change.logger)
[2024-10-16 12:18:31,353] INFO [Broker id=2] Leader __consumer_offsets-3 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:31,360] INFO [Broker id=2] Leader __consumer_offsets-18 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:31,362] INFO [Broker id=2] Leader __consumer_offsets-39 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:31,365] INFO [Broker id=2] Leader __consumer_offsets-9 starts at leader epoch 16 from offset 46 with high watermark 46 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:31,413] INFO [Broker id=2] Leader __consumer_offsets-24 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:31,416] INFO [Broker id=2] Leader __consumer_offsets-27 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:31,420] INFO [Broker id=2] Leader __consumer_offsets-42 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:31,423] INFO [Broker id=2] Leader __consumer_offsets-12 starts at leader epoch 16 from offset 1 with high watermark 1 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:31,427] INFO [Broker id=2] Leader __consumer_offsets-33 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:31,431] INFO [Broker id=2] Leader __consumer_offsets-48 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:31,438] INFO [Broker id=2] Leader __consumer_offsets-21 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:31,441] INFO [Broker id=2] Leader __consumer_offsets-36 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:31,444] INFO [Broker id=2] Leader __consumer_offsets-6 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:31,446] INFO [Broker id=2] Leader product-List-event-0 starts at leader epoch 12 from offset 11 with high watermark 11 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:31,448] INFO [Broker id=2] Leader __consumer_offsets-45 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:31,450] INFO [Broker id=2] Leader __consumer_offsets-15 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:31,452] INFO [Broker id=2] Leader __consumer_offsets-30 starts at leader epoch 16 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:31,454] INFO [Broker id=2] Leader __consumer_offsets-0 starts at leader epoch 16 from offset 3 with high watermark 3 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:31,487] INFO [Broker id=2] Finished LeaderAndIsr request in 151ms correlationId 3 from controller 0 for 18 partitions (state.change.logger)
[2024-10-16 12:18:31,489] INFO [Broker id=2] Add 18 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 4 (state.change.logger)
[2024-10-16 12:18:44,446] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0, 2) for 0 partitions (state.change.logger)
[2024-10-16 12:18:44,447] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(1) for 58 partitions (state.change.logger)
[2024-10-16 12:18:44,452] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 23 become-follower partitions (state.change.logger)
[2024-10-16 12:18:44,458] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 23 partitions (state.change.logger)
[2024-10-16 12:18:44,465] INFO [Broker id=0] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 11 (state.change.logger)
[2024-10-16 12:18:44,477] INFO [Broker id=2] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 6 (state.change.logger)
[2024-10-16 12:18:44,627] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-22 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:18:44,634] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:18:44,642] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-25 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:18:44,642] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-49 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:18:44,642] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-31 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:18:44,642] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-37 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:18:44,642] INFO [Controller id=0 epoch=9] Changed partition product-created-events-topic-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:18:44,642] INFO [Controller id=0 epoch=9] Changed partition product-created-events-topics-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=21, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=34) (state.change.logger)
[2024-10-16 12:18:44,642] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-19 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:18:44,642] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-13 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:18:44,642] INFO [Controller id=0 epoch=9] Changed partition product-created-events-topics-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=22, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=35) (state.change.logger)
[2024-10-16 12:18:44,643] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:18:44,643] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-7 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:18:44,643] INFO [Controller id=0 epoch=9] Changed partition product-created-events-topics-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=22, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=35) (state.change.logger)
[2024-10-16 12:18:44,643] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-46 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:18:44,643] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-16 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:18:44,643] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-28 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:18:44,643] INFO [Controller id=0 epoch=9] Changed partition product-created-events-topic.DLT-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=5, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=5) (state.change.logger)
[2024-10-16 12:18:44,643] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-43 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:18:44,643] INFO [Controller id=0 epoch=9] Changed partition product-List-evnt-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=5, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=5) (state.change.logger)
[2024-10-16 12:18:44,643] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-34 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:18:44,643] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-10 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:18:44,643] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-40 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:18:44,643] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-10-16 12:18:44,643] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 1 with 23 become-leader and 0 become-follower partitions (state.change.logger)
[2024-10-16 12:18:44,643] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-10-16 12:18:44,649] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 23 partitions (state.change.logger)
[2024-10-16 12:18:44,650] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 12 from controller 0 for 3 partitions (state.change.logger)
[2024-10-16 12:18:44,670] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 7 from controller 0 for 3 partitions (state.change.logger)
[2024-10-16 12:18:44,685] INFO [Broker id=2] Follower product-created-events-topics-1 starts at leader epoch 22 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:44,687] INFO [Broker id=2] Follower product-created-events-topics-0 starts at leader epoch 21 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:44,687] INFO [Broker id=2] Follower product-created-events-topics-2 starts at leader epoch 22 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:44,688] INFO [Broker id=0] Follower product-created-events-topics-1 starts at leader epoch 22 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:44,688] INFO [Broker id=0] Follower product-created-events-topics-0 starts at leader epoch 21 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:44,688] INFO [Broker id=0] Follower product-created-events-topics-2 starts at leader epoch 22 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:44,697] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 7 for 3 partitions (state.change.logger)
[2024-10-16 12:18:44,709] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 12 for 3 partitions (state.change.logger)
[2024-10-16 12:18:44,805] INFO [Broker id=0] Finished LeaderAndIsr request in 156ms correlationId 12 from controller 0 for 3 partitions (state.change.logger)
[2024-10-16 12:18:44,809] INFO [Broker id=0] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 13 (state.change.logger)
[2024-10-16 12:18:44,823] INFO [Broker id=2] Finished LeaderAndIsr request in 153ms correlationId 7 from controller 0 for 3 partitions (state.change.logger)
[2024-10-16 12:18:44,953] INFO [Broker id=2] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 8 (state.change.logger)
[2024-10-16 12:18:45,439] INFO [Broker id=1] Add 58 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 0 (state.change.logger)
[2024-10-16 12:18:45,520] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 0 for 23 partitions (state.change.logger)
[2024-10-16 12:18:45,575] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-37 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,585] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-7 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,586] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-22 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,587] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition product-created-events-topics-1 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,588] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-10 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,588] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-31 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,588] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-46 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,589] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-1 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,589] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition product-created-events-topic-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,590] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition product-created-events-topic.DLT-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,590] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-16 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,591] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-19 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,591] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-34 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,592] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-4 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,593] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-25 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,603] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-40 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,605] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-43 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,605] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition product-List-evnt-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,607] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition product-created-events-topics-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,607] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-13 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,607] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-28 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,608] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition product-created-events-topics-2 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,609] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-49 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:18:45,622] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 1 for 0 partitions (state.change.logger)
[2024-10-16 12:18:45,644] INFO [Broker id=1] Finished LeaderAndIsr request in 124ms correlationId 1 from controller 0 for 23 partitions (state.change.logger)
[2024-10-16 12:18:45,660] INFO [Broker id=1] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 2 (state.change.logger)
[2024-10-16 12:18:45,665] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 0 for 23 partitions (state.change.logger)
[2024-10-16 12:18:45,671] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 9 as part of the become-leader transition for 23 partitions (state.change.logger)
[2024-10-16 12:18:45,688] INFO [Broker id=1] Leader __consumer_offsets-37 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,702] INFO [Broker id=1] Leader __consumer_offsets-7 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,705] INFO [Broker id=1] Leader __consumer_offsets-22 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,708] INFO [Broker id=1] Leader product-created-events-topics-1 starts at leader epoch 22 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,722] INFO [Broker id=1] Leader __consumer_offsets-10 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,744] INFO [Broker id=1] Leader __consumer_offsets-31 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,755] INFO [Broker id=1] Leader __consumer_offsets-46 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,760] INFO [Broker id=1] Leader __consumer_offsets-1 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,789] INFO [Broker id=1] Leader product-created-events-topic-0 starts at leader epoch 7 from offset 57 with high watermark 57 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,792] INFO [Broker id=1] Leader product-created-events-topic.DLT-0 starts at leader epoch 5 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,806] INFO [Broker id=1] Leader __consumer_offsets-16 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,809] INFO [Broker id=1] Leader __consumer_offsets-19 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,821] INFO [Broker id=1] Leader __consumer_offsets-34 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,824] INFO [Broker id=1] Leader __consumer_offsets-4 starts at leader epoch 7 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,827] INFO [Broker id=1] Leader __consumer_offsets-25 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,838] INFO [Broker id=1] Leader __consumer_offsets-40 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,840] INFO [Broker id=1] Leader __consumer_offsets-43 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,842] INFO [Broker id=1] Leader product-List-evnt-0 starts at leader epoch 5 from offset 18 with high watermark 18 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,845] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 21 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,855] INFO [Broker id=1] Leader __consumer_offsets-13 starts at leader epoch 7 from offset 3 with high watermark 3 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,858] INFO [Broker id=1] Leader __consumer_offsets-28 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,861] INFO [Broker id=1] Leader product-created-events-topics-2 starts at leader epoch 22 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,863] INFO [Broker id=1] Leader __consumer_offsets-49 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:18:45,949] INFO [Broker id=1] Finished LeaderAndIsr request in 284ms correlationId 3 from controller 0 for 23 partitions (state.change.logger)
[2024-10-16 12:18:45,967] INFO [Broker id=1] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 4 (state.change.logger)
[2024-10-16 12:18:46,602] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-10-16 12:18:46,604] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 14 (state.change.logger)
[2024-10-16 12:18:46,611] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 5 (state.change.logger)
[2024-10-16 12:18:46,624] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 2 partitions (state.change.logger)
[2024-10-16 12:18:46,625] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 15 (state.change.logger)
[2024-10-16 12:18:46,626] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 6 (state.change.logger)
[2024-10-16 12:19:01,099] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-10-16 12:19:01,114] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:01,114] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:01,114] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:01,114] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:01,115] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:01,115] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:01,115] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:01,115] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:01,115] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-List-event-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-List-event-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:01,115] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:01,116] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:01,116] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:01,116] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:01,116] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:01,116] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:01,116] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:01,116] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:01,117] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:01,117] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-10-16 12:19:01,143] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-30 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,143] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-33 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,143] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-36 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,143] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-6 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,143] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,143] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-45 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,143] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-21 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,143] INFO [Controller id=0 epoch=9] Partition product-List-event-0 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:13,ZkVersion:13,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,143] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-27 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,143] INFO [Controller id=0 epoch=9] Partition product-created-events-topics-2 state changed to (Leader:1,ISR:1,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:36,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,144] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-9 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,144] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-42 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,144] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-3 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,144] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-18 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,144] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-15 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,144] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-24 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,144] INFO [Controller id=0 epoch=9] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:1,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:21,ZkVersion:35,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,144] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-48 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,144] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-39 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,144] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-12 state changed to (Leader:-1,ISR:2,LeaderRecoveryState:RECOVERED,LeaderEpoch:17,ZkVersion:17,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,144] INFO [Controller id=0 epoch=9] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:1,0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:36,ControllerEpoch:9) after removing replica 2 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:01,144] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-10-16 12:19:01,144] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 1 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-10-16 12:19:01,145] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0, 1) for 21 partitions (state.change.logger)
[2024-10-16 12:19:01,155] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 7 from controller 0 for 3 partitions (state.change.logger)
[2024-10-16 12:19:01,156] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 16 from controller 0 for 3 partitions (state.change.logger)
[2024-10-16 12:19:01,156] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 16 epoch 9 for partition product-created-events-topics-1 since its associated leader epoch 22 matches the current leader epoch (state.change.logger)
[2024-10-16 12:19:01,156] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 16 epoch 9 for partition product-created-events-topics-2 since its associated leader epoch 22 matches the current leader epoch (state.change.logger)
[2024-10-16 12:19:01,156] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 16 epoch 9 for partition product-created-events-topics-0 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2024-10-16 12:19:01,156] INFO [Broker id=0] Finished LeaderAndIsr request in 1ms correlationId 16 from controller 0 for 3 partitions (state.change.logger)
[2024-10-16 12:19:01,157] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 0 with correlation id 7 epoch 9 for partition product-created-events-topics-1 since its associated leader epoch 22 matches the current leader epoch (state.change.logger)
[2024-10-16 12:19:01,157] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 0 with correlation id 7 epoch 9 for partition product-created-events-topics-2 since its associated leader epoch 22 matches the current leader epoch (state.change.logger)
[2024-10-16 12:19:01,157] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 0 with correlation id 7 epoch 9 for partition product-created-events-topics-0 since its associated leader epoch 21 matches the current leader epoch (state.change.logger)
[2024-10-16 12:19:01,157] INFO [Broker id=0] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 17 (state.change.logger)
[2024-10-16 12:19:01,158] INFO [Broker id=1] Finished LeaderAndIsr request in 3ms correlationId 7 from controller 0 for 3 partitions (state.change.logger)
[2024-10-16 12:19:01,161] INFO [Broker id=1] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 8 (state.change.logger)
[2024-10-16 12:19:28,084] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-10-16 12:19:28,113] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,113] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-30 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-30 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,114] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,114] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,114] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-created-events-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,114] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,114] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,114] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,114] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-21 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-21 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,115] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-List-event-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-List-event-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,115] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,115] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-27 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-27 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,115] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,115] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-9 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-9 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,116] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,116] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-33 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-33 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,116] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,116] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,116] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,116] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,116] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-36 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-36 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,117] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-42 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-42 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,117] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-3 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-3 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,117] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-18 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-18 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,117] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-15 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-15 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,117] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-24 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-24 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,117] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-48 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-48 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,117] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-created-events-topic.DLT-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic.DLT-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,118] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,118] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-6 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-6 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,118] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-39 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-39 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,118] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-12 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-12 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,118] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-45 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-45 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,118] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,118] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-List-evnt-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-List-evnt-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,118] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,119] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,119] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:19:28,119] INFO [Controller id=0 epoch=9] Changed partition product-created-events-topics-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=23, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=37) (state.change.logger)
[2024-10-16 12:19:28,119] INFO [Controller id=0 epoch=9] Changed partition product-created-events-topics-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=22, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=36) (state.change.logger)
[2024-10-16 12:19:28,119] INFO [Controller id=0 epoch=9] Changed partition product-created-events-topics-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=23, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=37) (state.change.logger)
[2024-10-16 12:19:28,119] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 0 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-10-16 12:19:28,119] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0) for 3 partitions (state.change.logger)
[2024-10-16 12:19:28,122] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 18 from controller 0 for 3 partitions (state.change.logger)
[2024-10-16 12:19:28,125] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 18 from controller 0 epoch 9 as part of the become-leader transition for 3 partitions (state.change.logger)
[2024-10-16 12:19:28,125] INFO [Broker id=0] Leader product-created-events-topics-1 starts at leader epoch 23 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was 22. (state.change.logger)
[2024-10-16 12:19:28,130] INFO [Broker id=0] Leader product-created-events-topics-0 starts at leader epoch 22 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was 21. (state.change.logger)
[2024-10-16 12:19:28,139] INFO [Broker id=0] Leader product-created-events-topics-2 starts at leader epoch 23 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was 22. (state.change.logger)
[2024-10-16 12:19:28,144] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-22 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,144] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-4 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,144] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-25 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,144] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-49 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,144] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-31 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,144] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-37 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,144] INFO [Controller id=0 epoch=9] Partition product-created-events-topic-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,144] INFO [Controller id=0 epoch=9] Partition product-created-events-topics-0 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:22,ZkVersion:36,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,144] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-19 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,144] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-13 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,144] INFO [Controller id=0 epoch=9] Partition product-created-events-topics-1 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:23,ZkVersion:37,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,144] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-1 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,144] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-7 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,145] INFO [Controller id=0 epoch=9] Partition product-created-events-topics-2 state changed to (Leader:0,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:23,ZkVersion:37,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,145] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-46 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,145] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-16 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,145] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-28 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,145] INFO [Controller id=0 epoch=9] Partition product-created-events-topic.DLT-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,146] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-43 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,146] INFO [Controller id=0 epoch=9] Partition product-List-evnt-0 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:6,ZkVersion:6,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,146] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-34 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,146] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-10 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,146] INFO [Controller id=0 epoch=9] Partition __consumer_offsets-40 state changed to (Leader:-1,ISR:1,LeaderRecoveryState:RECOVERED,LeaderEpoch:8,ZkVersion:8,ControllerEpoch:9) after removing replica 1 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:19:28,146] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 0 with 3 become-leader and 0 become-follower partitions (state.change.logger)
[2024-10-16 12:19:28,146] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0) for 23 partitions (state.change.logger)
[2024-10-16 12:19:28,148] INFO [Broker id=0] Finished LeaderAndIsr request in 26ms correlationId 18 from controller 0 for 3 partitions (state.change.logger)
[2024-10-16 12:19:28,149] INFO [Broker id=0] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 19 (state.change.logger)
[2024-10-16 12:19:28,150] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 20 from controller 0 for 3 partitions (state.change.logger)
[2024-10-16 12:19:28,150] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 20 epoch 9 for partition product-created-events-topics-1 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2024-10-16 12:19:28,150] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 20 epoch 9 for partition product-created-events-topics-2 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2024-10-16 12:19:28,150] INFO [Broker id=0] Ignoring LeaderAndIsr request from controller 0 with correlation id 20 epoch 9 for partition product-created-events-topics-0 since its associated leader epoch 22 matches the current leader epoch (state.change.logger)
[2024-10-16 12:19:28,150] INFO [Broker id=0] Finished LeaderAndIsr request in 0ms correlationId 20 from controller 0 for 3 partitions (state.change.logger)
[2024-10-16 12:19:28,152] INFO [Broker id=0] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 21 (state.change.logger)
[2024-10-16 12:20:29,676] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0) for 0 partitions (state.change.logger)
[2024-10-16 12:20:29,677] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(2) for 58 partitions (state.change.logger)
[2024-10-16 12:20:29,678] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 21 become-follower partitions (state.change.logger)
[2024-10-16 12:20:29,678] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0, 2) for 21 partitions (state.change.logger)
[2024-10-16 12:20:29,680] INFO [Broker id=0] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 23 (state.change.logger)
[2024-10-16 12:20:29,784] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-22 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-22 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,784] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-25 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-25 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,784] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-37 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-37 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,784] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-created-events-topic-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,784] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-19 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-19 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,784] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-13 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-13 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,784] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-4 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-4 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,785] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-7 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-7 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,785] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-46 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-46 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,785] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-49 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-49 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,785] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-16 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-16 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,785] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-28 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-28 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,785] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-31 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-31 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,785] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-created-events-topic.DLT-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-created-events-topic.DLT-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,786] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-43 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-43 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,786] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-1 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-1 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,786] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition product-List-evnt-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition product-List-evnt-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,787] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-34 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-34 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,787] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-10 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-10 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,787] ERROR [Controller id=0 epoch=9] Controller 0 epoch 9 failed to change state for partition __consumer_offsets-40 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-40 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onBrokerStartup(KafkaController.scala:545)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1606)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-30 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=18, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=18) (state.change.logger)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-48 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=18, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=18) (state.change.logger)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=18, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=18) (state.change.logger)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-21 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=18, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=18) (state.change.logger)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Changed partition product-List-event-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=14, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=14) (state.change.logger)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-27 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=18, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=18) (state.change.logger)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-9 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=18, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=18) (state.change.logger)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-33 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=18, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=18) (state.change.logger)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-36 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=18, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=18) (state.change.logger)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-42 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=18, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=18) (state.change.logger)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-3 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=18, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=18) (state.change.logger)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-18 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=18, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=18) (state.change.logger)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-15 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=18, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=18) (state.change.logger)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-24 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=18, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=18) (state.change.logger)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-6 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=18, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=18) (state.change.logger)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-39 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=18, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=18) (state.change.logger)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-12 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=18, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=18) (state.change.logger)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-45 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=18, isr=List(2), leaderRecoveryState=RECOVERED, zkVersion=18) (state.change.logger)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 2 with 18 become-leader and 0 become-follower partitions (state.change.logger)
[2024-10-16 12:20:29,787] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0, 2) for 18 partitions (state.change.logger)
[2024-10-16 12:20:29,790] INFO [Broker id=0] Add 18 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 24 (state.change.logger)
[2024-10-16 12:20:30,456] INFO [Broker id=2] Add 58 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 0 (state.change.logger)
[2024-10-16 12:20:30,501] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 0 for 21 partitions (state.change.logger)
[2024-10-16 12:20:30,659] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-3 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:30,957] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-18 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:30,985] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-39 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:31,033] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-9 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:31,067] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-24 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:31,115] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-27 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:31,194] INFO [Broker id=2] Follower product-created-events-topics-1 starts at leader epoch 23 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,194] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-42 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:31,218] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-12 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:31,246] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-33 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:31,288] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-48 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:31,313] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-21 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:31,327] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-36 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:31,469] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-6 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:31,506] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition product-List-event-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:31,551] INFO [Broker id=2] Follower product-created-events-topics-0 starts at leader epoch 22 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,551] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-45 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:31,612] INFO [Broker id=2] Follower product-created-events-topics-2 starts at leader epoch 23 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,613] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-15 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:31,654] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-30 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:31,686] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:31,724] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 1 for 3 partitions (state.change.logger)
[2024-10-16 12:20:31,856] INFO [Broker id=2] Finished LeaderAndIsr request in 1355ms correlationId 1 from controller 0 for 21 partitions (state.change.logger)
[2024-10-16 12:20:31,866] INFO [Broker id=2] Add 21 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 2 (state.change.logger)
[2024-10-16 12:20:31,868] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 0 for 18 partitions (state.change.logger)
[2024-10-16 12:20:31,876] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 9 as part of the become-leader transition for 18 partitions (state.change.logger)
[2024-10-16 12:20:31,905] INFO [Broker id=2] Leader __consumer_offsets-3 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,922] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0, 2) for 1 partitions (state.change.logger)
[2024-10-16 12:20:31,923] INFO [Broker id=2] Leader __consumer_offsets-18 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,925] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 25 (state.change.logger)
[2024-10-16 12:20:31,926] INFO [Broker id=2] Leader __consumer_offsets-39 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,929] INFO [Broker id=2] Leader __consumer_offsets-9 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,937] INFO [Broker id=2] Leader __consumer_offsets-24 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,939] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0, 2) for 2 partitions (state.change.logger)
[2024-10-16 12:20:31,941] INFO [Broker id=2] Leader __consumer_offsets-27 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,941] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 26 (state.change.logger)
[2024-10-16 12:20:31,944] INFO [Broker id=2] Leader __consumer_offsets-42 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,947] INFO [Broker id=2] Leader __consumer_offsets-12 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,950] INFO [Broker id=2] Leader __consumer_offsets-33 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,953] INFO [Broker id=2] Leader __consumer_offsets-48 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,958] INFO [Broker id=2] Leader __consumer_offsets-21 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,965] INFO [Broker id=2] Leader __consumer_offsets-36 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,977] INFO [Broker id=2] Leader __consumer_offsets-6 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,979] INFO [Broker id=2] Leader product-List-event-0 starts at leader epoch 14 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,982] INFO [Broker id=2] Leader __consumer_offsets-45 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,991] INFO [Broker id=2] Leader __consumer_offsets-15 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,994] INFO [Broker id=2] Leader __consumer_offsets-30 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:31,997] INFO [Broker id=2] Leader __consumer_offsets-0 starts at leader epoch 18 from offset 0 with high watermark 0 ISR [2] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:32,102] INFO [Broker id=2] Finished LeaderAndIsr request in 234ms correlationId 3 from controller 0 for 18 partitions (state.change.logger)
[2024-10-16 12:20:32,113] INFO [Broker id=2] Add 18 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 4 (state.change.logger)
[2024-10-16 12:20:32,116] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 5 (state.change.logger)
[2024-10-16 12:20:32,119] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 6 (state.change.logger)
[2024-10-16 12:20:33,472] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0, 2) for 0 partitions (state.change.logger)
[2024-10-16 12:20:33,473] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(1) for 58 partitions (state.change.logger)
[2024-10-16 12:20:33,476] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 23 become-follower partitions (state.change.logger)
[2024-10-16 12:20:33,476] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 23 partitions (state.change.logger)
[2024-10-16 12:20:33,478] INFO [Broker id=0] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 28 (state.change.logger)
[2024-10-16 12:20:33,479] INFO [Broker id=2] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 8 (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-22 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-4 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-25 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-49 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-31 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-37 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition product-created-events-topic-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-19 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-13 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-7 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-46 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-16 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-28 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition product-created-events-topic.DLT-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-43 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition product-List-evnt-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=7, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=7) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-34 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-10 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Changed partition __consumer_offsets-40 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=9, isr=List(1), leaderRecoveryState=RECOVERED, zkVersion=9) (state.change.logger)
[2024-10-16 12:20:33,498] INFO [Controller id=0 epoch=9] Sending LeaderAndIsr request to broker 1 with 20 become-leader and 0 become-follower partitions (state.change.logger)
[2024-10-16 12:20:33,499] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 20 partitions (state.change.logger)
[2024-10-16 12:20:33,504] INFO [Broker id=0] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 29 (state.change.logger)
[2024-10-16 12:20:33,504] INFO [Broker id=2] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 9 (state.change.logger)
[2024-10-16 12:20:34,147] INFO [Broker id=1] Add 58 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 0 (state.change.logger)
[2024-10-16 12:20:34,181] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 0 for 23 partitions (state.change.logger)
[2024-10-16 12:20:34,258] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-37 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,452] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-7 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,471] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-22 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,526] INFO [Broker id=1] Follower product-created-events-topics-1 starts at leader epoch 23 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:34,526] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-10 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,547] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-31 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,579] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-46 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,612] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-1 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,643] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition product-created-events-topic-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,661] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition product-created-events-topic.DLT-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,693] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-16 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,724] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-19 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,743] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-34 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,767] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-4 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,795] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-25 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,816] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-40 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,833] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-43 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,849] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition product-List-evnt-0 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,878] INFO [Broker id=1] Follower product-created-events-topics-0 starts at leader epoch 22 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:34,878] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-13 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,896] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-28 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,932] INFO [Broker id=1] Follower product-created-events-topics-2 starts at leader epoch 23 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:34,932] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 1 from controller 0 epoch 9 for partition __consumer_offsets-49 (last update controller epoch 9) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:20:34,952] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 0 epoch 9 with correlation id 1 for 3 partitions (state.change.logger)
[2024-10-16 12:20:35,066] INFO [Broker id=1] Finished LeaderAndIsr request in 886ms correlationId 1 from controller 0 for 23 partitions (state.change.logger)
[2024-10-16 12:20:35,071] INFO [Broker id=1] Add 23 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 2 (state.change.logger)
[2024-10-16 12:20:35,071] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-10-16 12:20:35,072] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 30 (state.change.logger)
[2024-10-16 12:20:35,073] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 0 for 20 partitions (state.change.logger)
[2024-10-16 12:20:35,076] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 10 (state.change.logger)
[2024-10-16 12:20:35,084] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 0 epoch 9 as part of the become-leader transition for 20 partitions (state.change.logger)
[2024-10-16 12:20:35,088] INFO [Controller id=0 epoch=9] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 2 partitions (state.change.logger)
[2024-10-16 12:20:35,089] INFO [Broker id=0] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 31 (state.change.logger)
[2024-10-16 12:20:35,090] INFO [Broker id=1] Leader __consumer_offsets-37 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,093] INFO [Broker id=2] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 11 (state.change.logger)
[2024-10-16 12:20:35,106] INFO [Broker id=1] Leader __consumer_offsets-7 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,109] INFO [Broker id=1] Leader __consumer_offsets-22 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,111] INFO [Broker id=1] Leader __consumer_offsets-10 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,114] INFO [Broker id=1] Leader __consumer_offsets-31 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,117] INFO [Broker id=1] Leader __consumer_offsets-46 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,120] INFO [Broker id=1] Leader __consumer_offsets-1 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,122] INFO [Broker id=1] Leader product-created-events-topic-0 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,124] INFO [Broker id=1] Leader product-created-events-topic.DLT-0 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,127] INFO [Broker id=1] Leader __consumer_offsets-16 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,130] INFO [Broker id=1] Leader __consumer_offsets-19 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,132] INFO [Broker id=1] Leader __consumer_offsets-34 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,134] INFO [Broker id=1] Leader __consumer_offsets-4 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,136] INFO [Broker id=1] Leader __consumer_offsets-25 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,139] INFO [Broker id=1] Leader __consumer_offsets-40 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,141] INFO [Broker id=1] Leader __consumer_offsets-43 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,144] INFO [Broker id=1] Leader product-List-evnt-0 starts at leader epoch 7 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,147] INFO [Broker id=1] Leader __consumer_offsets-13 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,149] INFO [Broker id=1] Leader __consumer_offsets-28 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,152] INFO [Broker id=1] Leader __consumer_offsets-49 starts at leader epoch 9 from offset 0 with high watermark 0 ISR [1] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 12:20:35,179] INFO [Broker id=1] Finished LeaderAndIsr request in 107ms correlationId 3 from controller 0 for 20 partitions (state.change.logger)
[2024-10-16 12:20:35,182] INFO [Broker id=1] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 4 (state.change.logger)
[2024-10-16 12:20:35,184] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 5 (state.change.logger)
[2024-10-16 12:20:35,186] INFO [Broker id=1] Add 2 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 0 epoch 9 with correlation id 6 (state.change.logger)
[2024-10-16 12:27:01,265] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(1, 2) for 0 partitions (state.change.logger)
[2024-10-16 12:27:01,320] INFO [Controller id=1 epoch=10] Sending LeaderAndIsr request to broker 1 with 20 become-leader and 3 become-follower partitions (state.change.logger)
[2024-10-16 12:27:01,329] INFO [Controller id=1 epoch=10] Sending LeaderAndIsr request to broker 2 with 18 become-leader and 3 become-follower partitions (state.change.logger)
[2024-10-16 12:27:01,330] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(1, 2) for 41 partitions (state.change.logger)
[2024-10-16 12:27:01,331] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 1 from controller 1 for 23 partitions (state.change.logger)
[2024-10-16 12:27:01,332] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 1 from controller 1 for 21 partitions (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition product-List-evnt-0 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition product-created-events-topics-1 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition product-created-events-topics-2 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition product-List-event-0 since its associated leader epoch 14 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition product-created-events-topics-0 since its associated leader epoch 22 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition product-created-events-topic.DLT-0 since its associated leader epoch 7 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition product-created-events-topic-0 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition product-created-events-topics-1 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-16 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-13 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition product-created-events-topics-2 since its associated leader epoch 23 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-46 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition product-created-events-topics-0 since its associated leader epoch 22 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-43 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-15 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-10 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-48 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-22 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-45 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-19 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-12 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-49 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-9 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-42 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-31 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-24 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-21 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-28 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-25 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-18 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-7 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-0 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-30 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-40 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-27 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-37 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-39 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-6 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-4 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-1 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=1] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-34 since its associated leader epoch 9 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-3 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-36 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,334] INFO [Broker id=2] Ignoring LeaderAndIsr request from controller 1 with correlation id 1 epoch 10 for partition __consumer_offsets-33 since its associated leader epoch 18 matches the current leader epoch (state.change.logger)
[2024-10-16 12:27:01,335] INFO [Broker id=1] Finished LeaderAndIsr request in 4ms correlationId 1 from controller 1 for 23 partitions (state.change.logger)
[2024-10-16 12:27:01,335] INFO [Broker id=2] Finished LeaderAndIsr request in 3ms correlationId 1 from controller 1 for 21 partitions (state.change.logger)
[2024-10-16 12:27:01,346] INFO [Broker id=1] Add 41 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2024-10-16 12:27:01,347] INFO [Broker id=2] Add 41 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2024-10-16 12:27:01,395] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,395] INFO [Controller id=1 epoch=10] Partition product-created-events-topics-2 state changed to (Leader:-1,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:24,ZkVersion:40,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,396] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,396] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,396] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,396] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,396] INFO [Controller id=1 epoch=10] Partition product-created-events-topics-1 state changed to (Leader:-1,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:24,ZkVersion:40,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,396] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,397] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,397] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,397] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,397] INFO [Controller id=1 epoch=10] Partition topic2-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:1,ZkVersion:1,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,397] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,397] INFO [Controller id=1 epoch=10] Partition product-created-events-topics-0 state changed to (Leader:-1,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:23,ZkVersion:39,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,397] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,397] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,397] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,397] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,398] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,398] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:14,ZkVersion:14,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 12:27:01,399] INFO [Controller id=1 epoch=10] Sending LeaderAndIsr request to broker 1 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-10-16 12:27:01,399] INFO [Controller id=1 epoch=10] Sending LeaderAndIsr request to broker 2 with 0 become-leader and 3 become-follower partitions (state.change.logger)
[2024-10-16 12:27:01,399] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(1, 2) for 20 partitions (state.change.logger)
[2024-10-16 12:27:01,400] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-10-16 12:27:01,401] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 10 for partition product-created-events-topics-1 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:27:01,400] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-10-16 12:27:01,401] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 10 for partition product-created-events-topics-0 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:27:01,401] ERROR [Broker id=1] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 10 for partition product-created-events-topics-2 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:27:01,401] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 3 for 0 partitions (state.change.logger)
[2024-10-16 12:27:01,401] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 10 for partition product-created-events-topics-1 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:27:01,401] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 10 for partition product-created-events-topics-0 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:27:01,401] ERROR [Broker id=2] Received LeaderAndIsrRequest with correlation id 3 from controller 1 epoch 10 for partition product-created-events-topics-2 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 12:27:01,401] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 3 for 0 partitions (state.change.logger)
[2024-10-16 12:27:01,401] INFO [Broker id=1] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-10-16 12:27:01,401] INFO [Broker id=2] Finished LeaderAndIsr request in 1ms correlationId 3 from controller 1 for 3 partitions (state.change.logger)
[2024-10-16 12:27:01,403] INFO [Broker id=1] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 4 (state.change.logger)
[2024-10-16 12:27:01,403] INFO [Broker id=2] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 4 (state.change.logger)
[2024-10-16 12:27:01,458] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:27:01,459] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:27:01,459] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:27:01,459] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:27:01,460] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:27:01,460] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:27:01,460] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:27:01,461] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:27:01,461] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:27:01,461] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition topic2-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:27:01,462] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:27:01,462] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:27:01,463] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:27:01,463] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:27:01,468] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:27:01,468] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:27:01,469] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.PartitionStateMachine.startup(PartitionStateMachine.scala:43)
	at kafka.controller.KafkaController.onControllerFailover(KafkaController.scala:271)
	at kafka.controller.KafkaController.elect(KafkaController.scala:1532)
	at kafka.controller.KafkaController.processReelect(KafkaController.scala:2493)
	at kafka.controller.KafkaController.process(KafkaController.scala:2538)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 12:27:01,470] INFO [Controller id=1 epoch=10] Changed partition product-created-events-topics-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=2, leaderEpoch=25, isr=List(2, 1), leaderRecoveryState=RECOVERED, zkVersion=41) (state.change.logger)
[2024-10-16 12:27:01,470] INFO [Controller id=1 epoch=10] Changed partition product-created-events-topics-1 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=25, isr=List(2, 1), leaderRecoveryState=RECOVERED, zkVersion=41) (state.change.logger)
[2024-10-16 12:27:01,470] INFO [Controller id=1 epoch=10] Changed partition product-created-events-topics-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=1, leaderEpoch=24, isr=List(2, 1), leaderRecoveryState=RECOVERED, zkVersion=40) (state.change.logger)
[2024-10-16 12:27:01,471] INFO [Controller id=1 epoch=10] Sending LeaderAndIsr request to broker 1 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2024-10-16 12:27:01,471] INFO [Controller id=1 epoch=10] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-10-16 12:27:01,471] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(1, 2) for 3 partitions (state.change.logger)
[2024-10-16 12:27:01,472] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 5 from controller 1 for 3 partitions (state.change.logger)
[2024-10-16 12:27:01,473] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 5 from controller 1 for 3 partitions (state.change.logger)
[2024-10-16 12:27:01,474] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 1 epoch 10 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-10-16 12:27:01,475] INFO [Broker id=2] Leader product-created-events-topics-2 starts at leader epoch 25 from offset 0 with high watermark 0 ISR [2,1] addingReplicas [] removingReplicas []. Previous leader epoch was 23. (state.change.logger)
[2024-10-16 12:27:01,477] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 5 from controller 1 epoch 10 as part of the become-leader transition for 2 partitions (state.change.logger)
[2024-10-16 12:27:01,478] INFO [Broker id=1] Leader product-created-events-topics-1 starts at leader epoch 25 from offset 0 with high watermark 0 ISR [2,1] addingReplicas [] removingReplicas []. Previous leader epoch was 23. (state.change.logger)
[2024-10-16 12:27:01,480] INFO [Broker id=2] Follower product-created-events-topics-1 starts at leader epoch 25 from offset 0 with high watermark 0. Previous leader epoch was 23. (state.change.logger)
[2024-10-16 12:27:01,480] INFO [Broker id=2] Follower product-created-events-topics-0 starts at leader epoch 24 from offset 0 with high watermark 0. Previous leader epoch was 22. (state.change.logger)
[2024-10-16 12:27:01,481] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 24 from offset 0 with high watermark 0 ISR [2,1] addingReplicas [] removingReplicas []. Previous leader epoch was 22. (state.change.logger)
[2024-10-16 12:27:01,482] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 5 for 2 partitions (state.change.logger)
[2024-10-16 12:27:01,484] INFO [Broker id=1] Follower product-created-events-topics-2 starts at leader epoch 25 from offset 0 with high watermark 0. Previous leader epoch was 23. (state.change.logger)
[2024-10-16 12:27:01,486] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 5 for 1 partitions (state.change.logger)
[2024-10-16 12:27:01,522] INFO [Broker id=1] Finished LeaderAndIsr request in 50ms correlationId 5 from controller 1 for 3 partitions (state.change.logger)
[2024-10-16 12:27:01,525] INFO [Broker id=1] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 6 (state.change.logger)
[2024-10-16 12:27:01,531] INFO [Broker id=2] Finished LeaderAndIsr request in 58ms correlationId 5 from controller 1 for 3 partitions (state.change.logger)
[2024-10-16 12:27:01,533] INFO [Broker id=2] Add 3 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 6 (state.change.logger)
[2024-10-16 15:11:51,920] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(1, 2) for 0 partitions (state.change.logger)
[2024-10-16 15:11:51,938] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(0) for 58 partitions (state.change.logger)
[2024-10-16 15:11:51,946] INFO [Controller id=1 epoch=10] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 20 become-follower partitions (state.change.logger)
[2024-10-16 15:11:51,948] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 20 partitions (state.change.logger)
[2024-10-16 15:11:51,953] INFO [Broker id=1] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 8 (state.change.logger)
[2024-10-16 15:11:51,959] INFO [Broker id=2] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 8 (state.change.logger)
[2024-10-16 15:11:51,999] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-8 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=15) (state.change.logger)
[2024-10-16 15:11:51,999] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-35 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=15) (state.change.logger)
[2024-10-16 15:11:51,999] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-47 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=15) (state.change.logger)
[2024-10-16 15:11:51,999] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-38 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=15) (state.change.logger)
[2024-10-16 15:11:51,999] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-17 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=15) (state.change.logger)
[2024-10-16 15:11:51,999] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-11 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=15) (state.change.logger)
[2024-10-16 15:11:51,999] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-29 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=15) (state.change.logger)
[2024-10-16 15:11:51,999] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-32 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=15) (state.change.logger)
[2024-10-16 15:11:51,999] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-41 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=15) (state.change.logger)
[2024-10-16 15:11:51,999] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-23 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=15) (state.change.logger)
[2024-10-16 15:11:51,999] INFO [Controller id=1 epoch=10] Changed partition topic2-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=2, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=2) (state.change.logger)
[2024-10-16 15:11:51,999] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=15) (state.change.logger)
[2024-10-16 15:11:51,999] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-14 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=15) (state.change.logger)
[2024-10-16 15:11:51,999] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-20 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=15) (state.change.logger)
[2024-10-16 15:11:51,999] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-44 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=15) (state.change.logger)
[2024-10-16 15:11:51,999] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=15) (state.change.logger)
[2024-10-16 15:11:51,999] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-26 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=15, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=15) (state.change.logger)
[2024-10-16 15:11:51,999] INFO [Controller id=1 epoch=10] Sending LeaderAndIsr request to broker 0 with 17 become-leader and 0 become-follower partitions (state.change.logger)
[2024-10-16 15:11:51,999] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 17 partitions (state.change.logger)
[2024-10-16 15:11:52,002] INFO [Broker id=1] Add 17 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 9 (state.change.logger)
[2024-10-16 15:11:52,003] INFO [Broker id=2] Add 17 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 9 (state.change.logger)
[2024-10-16 15:11:52,833] INFO [Broker id=0] Add 58 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2024-10-16 15:11:52,870] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 1 for 20 partitions (state.change.logger)
[2024-10-16 15:11:53,031] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-35 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:11:53,037] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition topic2-0 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:11:53,038] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-5 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:11:53,038] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-20 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:11:53,042] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-41 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:11:53,054] INFO [Broker id=0] Follower product-created-events-topics-1 starts at leader epoch 25 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,054] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-29 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:11:53,056] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-44 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:11:53,058] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-14 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:11:53,058] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-2 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:11:53,062] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-23 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:11:53,063] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-38 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:11:53,064] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-8 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:11:53,065] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-11 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:11:53,069] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-26 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:11:53,071] INFO [Broker id=0] Follower product-created-events-topics-0 starts at leader epoch 24 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,072] INFO [Broker id=0] Follower product-created-events-topics-2 starts at leader epoch 25 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,072] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-47 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:11:53,072] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-17 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:11:53,073] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-32 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:11:53,091] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 1 for 3 partitions (state.change.logger)
[2024-10-16 15:11:53,220] INFO [Broker id=0] Finished LeaderAndIsr request in 363ms correlationId 1 from controller 1 for 20 partitions (state.change.logger)
[2024-10-16 15:11:53,230] INFO [Broker id=0] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2024-10-16 15:11:53,233] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 1 for 17 partitions (state.change.logger)
[2024-10-16 15:11:53,239] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 10 as part of the become-leader transition for 17 partitions (state.change.logger)
[2024-10-16 15:11:53,246] INFO [Broker id=0] Leader __consumer_offsets-35 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,259] INFO [Broker id=0] Leader topic2-0 starts at leader epoch 2 from offset 2 with high watermark 2 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,270] INFO [Broker id=0] Leader __consumer_offsets-5 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,280] INFO [Broker id=0] Leader __consumer_offsets-20 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,288] INFO [Broker id=0] Leader __consumer_offsets-41 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,291] INFO [Broker id=0] Leader __consumer_offsets-29 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,294] INFO [Broker id=0] Leader __consumer_offsets-44 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,299] INFO [Broker id=0] Leader __consumer_offsets-14 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,301] INFO [Broker id=0] Leader __consumer_offsets-2 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,304] INFO [Broker id=0] Leader __consumer_offsets-23 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,306] INFO [Broker id=0] Leader __consumer_offsets-38 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,309] INFO [Broker id=0] Leader __consumer_offsets-8 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,312] INFO [Broker id=0] Leader __consumer_offsets-11 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,319] INFO [Broker id=0] Leader __consumer_offsets-26 starts at leader epoch 15 from offset 140 with high watermark 140 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,327] INFO [Broker id=0] Leader __consumer_offsets-47 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,335] INFO [Broker id=0] Leader __consumer_offsets-17 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,356] INFO [Broker id=0] Leader __consumer_offsets-32 starts at leader epoch 15 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:11:53,389] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-10-16 15:11:53,409] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 10 (state.change.logger)
[2024-10-16 15:11:53,410] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 10 (state.change.logger)
[2024-10-16 15:11:53,461] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-10-16 15:11:53,474] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 11 (state.change.logger)
[2024-10-16 15:11:53,475] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 11 (state.change.logger)
[2024-10-16 15:11:53,479] INFO [Broker id=0] Finished LeaderAndIsr request in 247ms correlationId 3 from controller 1 for 17 partitions (state.change.logger)
[2024-10-16 15:11:53,497] INFO [Broker id=0] Add 17 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 4 (state.change.logger)
[2024-10-16 15:11:53,499] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 5 (state.change.logger)
[2024-10-16 15:11:53,504] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 6 (state.change.logger)
[2024-10-16 15:11:53,532] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-10-16 15:11:53,535] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 7 (state.change.logger)
[2024-10-16 15:11:53,542] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 12 (state.change.logger)
[2024-10-16 15:11:53,544] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 12 (state.change.logger)
[2024-10-16 15:12:25,152] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-10-16 15:12:25,164] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:12:25,166] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:12:25,166] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:12:25,166] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:12:25,166] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:12:25,167] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:12:25,167] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:12:25,168] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:12:25,168] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:12:25,173] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:12:25,173] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition topic2-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:12:25,173] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:12:25,173] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:12:25,174] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:12:25,174] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:12:25,174] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:12:25,174] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:12:25,175] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-10-16 15:12:25,213] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,213] INFO [Controller id=1 epoch=10] Partition product-created-events-topics-2 state changed to (Leader:2,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:26,ZkVersion:43,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,213] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,214] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,214] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,214] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,214] INFO [Controller id=1 epoch=10] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:26,ZkVersion:43,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,214] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,214] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,214] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,214] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,214] INFO [Controller id=1 epoch=10] Partition topic2-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:3,ZkVersion:3,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,214] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,214] INFO [Controller id=1 epoch=10] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:25,ZkVersion:42,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,214] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,214] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,217] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,218] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,218] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,218] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:16,ZkVersion:16,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:12:25,226] INFO [Controller id=1 epoch=10] Sending LeaderAndIsr request to broker 1 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2024-10-16 15:12:25,227] INFO [Controller id=1 epoch=10] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-10-16 15:12:25,227] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(1, 2) for 20 partitions (state.change.logger)
[2024-10-16 15:12:25,229] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 13 from controller 1 for 3 partitions (state.change.logger)
[2024-10-16 15:12:25,231] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 13 from controller 1 epoch 10 as part of the become-leader transition for 2 partitions (state.change.logger)
[2024-10-16 15:12:25,231] INFO [Broker id=1] Leader product-created-events-topics-1 starts at leader epoch 26 from offset 0 with high watermark 0 ISR [2,1] addingReplicas [] removingReplicas []. Previous leader epoch was 25. (state.change.logger)
[2024-10-16 15:12:25,232] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 13 from controller 1 for 3 partitions (state.change.logger)
[2024-10-16 15:12:25,235] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 13 from controller 1 epoch 10 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-10-16 15:12:25,247] INFO [Broker id=2] Leader product-created-events-topics-2 starts at leader epoch 26 from offset 0 with high watermark 0 ISR [2,1] addingReplicas [] removingReplicas []. Previous leader epoch was 25. (state.change.logger)
[2024-10-16 15:12:25,251] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 13 from controller 1 epoch 10 for partition product-created-events-topics-1 (last update controller epoch 10) since it is already the leader for the partition. (state.change.logger)
[2024-10-16 15:12:25,252] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 25 from offset 0 with high watermark 0 ISR [2,1] addingReplicas [] removingReplicas []. Previous leader epoch was 24. (state.change.logger)
[2024-10-16 15:12:25,267] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 13 from controller 1 epoch 10 for partition product-created-events-topics-0 (last update controller epoch 10) since it is already the leader for the partition. (state.change.logger)
[2024-10-16 15:12:25,268] INFO [Broker id=1] Follower product-created-events-topics-2 starts at leader epoch 26 from offset 0 with high watermark 0. Previous leader epoch was 25. (state.change.logger)
[2024-10-16 15:12:25,269] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 13 for 1 partitions (state.change.logger)
[2024-10-16 15:12:25,270] INFO [Broker id=2] Skipped the become-leader state change after marking its partition as leader with correlation id 13 from controller 1 epoch 10 for partition product-created-events-topics-2 (last update controller epoch 10) since it is already the leader for the partition. (state.change.logger)
[2024-10-16 15:12:25,271] INFO [Broker id=2] Follower product-created-events-topics-1 starts at leader epoch 26 from offset 0 with high watermark 0. Previous leader epoch was 25. (state.change.logger)
[2024-10-16 15:12:25,271] INFO [Broker id=2] Follower product-created-events-topics-0 starts at leader epoch 25 from offset 0 with high watermark 0. Previous leader epoch was 24. (state.change.logger)
[2024-10-16 15:12:25,275] INFO [Broker id=1] Finished LeaderAndIsr request in 46ms correlationId 13 from controller 1 for 3 partitions (state.change.logger)
[2024-10-16 15:12:25,286] INFO [Broker id=1] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 14 (state.change.logger)
[2024-10-16 15:12:25,287] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 13 for 2 partitions (state.change.logger)
[2024-10-16 15:12:25,301] INFO [Broker id=2] Finished LeaderAndIsr request in 69ms correlationId 13 from controller 1 for 3 partitions (state.change.logger)
[2024-10-16 15:12:25,303] INFO [Broker id=2] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 14 (state.change.logger)
[2024-10-16 15:12:39,635] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(1, 2) for 0 partitions (state.change.logger)
[2024-10-16 15:12:39,636] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(0) for 58 partitions (state.change.logger)
[2024-10-16 15:12:39,637] INFO [Controller id=1 epoch=10] Sending LeaderAndIsr request to broker 0 with 0 become-leader and 20 become-follower partitions (state.change.logger)
[2024-10-16 15:12:39,638] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 20 partitions (state.change.logger)
[2024-10-16 15:12:39,646] INFO [Broker id=2] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 16 (state.change.logger)
[2024-10-16 15:12:39,648] INFO [Broker id=1] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 16 (state.change.logger)
[2024-10-16 15:12:39,735] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-8 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=17, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=17) (state.change.logger)
[2024-10-16 15:12:39,735] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-35 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=17, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=17) (state.change.logger)
[2024-10-16 15:12:39,735] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-47 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=17, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=17) (state.change.logger)
[2024-10-16 15:12:39,735] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-38 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=17, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=17) (state.change.logger)
[2024-10-16 15:12:39,735] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-17 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=17, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=17) (state.change.logger)
[2024-10-16 15:12:39,735] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-11 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=17, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=17) (state.change.logger)
[2024-10-16 15:12:39,735] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-29 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=17, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=17) (state.change.logger)
[2024-10-16 15:12:39,735] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-32 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=17, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=17) (state.change.logger)
[2024-10-16 15:12:39,735] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-41 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=17, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=17) (state.change.logger)
[2024-10-16 15:12:39,735] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-23 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=17, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=17) (state.change.logger)
[2024-10-16 15:12:39,735] INFO [Controller id=1 epoch=10] Changed partition topic2-0 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=4, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=4) (state.change.logger)
[2024-10-16 15:12:39,735] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-2 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=17, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=17) (state.change.logger)
[2024-10-16 15:12:39,735] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-14 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=17, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=17) (state.change.logger)
[2024-10-16 15:12:39,735] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-20 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=17, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=17) (state.change.logger)
[2024-10-16 15:12:39,735] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-44 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=17, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=17) (state.change.logger)
[2024-10-16 15:12:39,735] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-5 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=17, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=17) (state.change.logger)
[2024-10-16 15:12:39,735] INFO [Controller id=1 epoch=10] Changed partition __consumer_offsets-26 from OfflinePartition to OnlinePartition with state LeaderAndIsr(leader=0, leaderEpoch=17, isr=List(0), leaderRecoveryState=RECOVERED, zkVersion=17) (state.change.logger)
[2024-10-16 15:12:39,735] INFO [Controller id=1 epoch=10] Sending LeaderAndIsr request to broker 0 with 17 become-leader and 0 become-follower partitions (state.change.logger)
[2024-10-16 15:12:39,736] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 17 partitions (state.change.logger)
[2024-10-16 15:12:39,737] INFO [Broker id=1] Add 17 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 17 (state.change.logger)
[2024-10-16 15:12:39,737] INFO [Broker id=2] Add 17 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 17 (state.change.logger)
[2024-10-16 15:12:40,402] INFO [Broker id=0] Add 58 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 0 (state.change.logger)
[2024-10-16 15:12:40,435] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 1 from controller 1 for 20 partitions (state.change.logger)
[2024-10-16 15:12:40,523] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-35 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:12:40,537] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition topic2-0 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:12:40,537] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-5 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:12:40,539] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-20 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:12:40,547] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-41 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:12:40,602] INFO [Broker id=0] Follower product-created-events-topics-1 starts at leader epoch 26 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:40,602] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-29 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:12:40,614] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-44 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:12:40,632] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-14 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:12:40,653] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-2 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:12:40,665] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-23 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:12:40,666] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-38 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:12:40,667] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-8 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:12:40,671] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-11 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:12:40,684] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-26 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:12:40,699] INFO [Broker id=0] Follower product-created-events-topics-0 starts at leader epoch 25 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:40,701] INFO [Broker id=0] Follower product-created-events-topics-2 starts at leader epoch 26 from offset 0 with high watermark 0. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:40,701] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-47 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:12:40,705] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-17 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:12:40,718] ERROR [Broker id=0] Received LeaderAndIsrRequest with correlation id 1 from controller 1 epoch 10 for partition __consumer_offsets-32 (last update controller epoch 10) but cannot become follower since the new leader -1 is unavailable. (state.change.logger)
[2024-10-16 15:12:40,743] INFO [Broker id=0] Stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 1 for 3 partitions (state.change.logger)
[2024-10-16 15:12:40,991] INFO [Broker id=0] Finished LeaderAndIsr request in 555ms correlationId 1 from controller 1 for 20 partitions (state.change.logger)
[2024-10-16 15:12:40,998] INFO [Broker id=0] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 2 (state.change.logger)
[2024-10-16 15:12:40,999] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-10-16 15:12:41,000] INFO [Broker id=0] Handling LeaderAndIsr request correlationId 3 from controller 1 for 17 partitions (state.change.logger)
[2024-10-16 15:12:41,009] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 18 (state.change.logger)
[2024-10-16 15:12:41,009] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 18 (state.change.logger)
[2024-10-16 15:12:41,013] INFO [Broker id=0] Stopped fetchers as part of LeaderAndIsr request correlationId 3 from controller 1 epoch 10 as part of the become-leader transition for 17 partitions (state.change.logger)
[2024-10-16 15:12:41,017] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-10-16 15:12:41,025] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 19 (state.change.logger)
[2024-10-16 15:12:41,026] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 19 (state.change.logger)
[2024-10-16 15:12:41,027] INFO [Broker id=0] Leader __consumer_offsets-35 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:41,047] INFO [Broker id=0] Leader topic2-0 starts at leader epoch 4 from offset 2 with high watermark 2 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:41,062] INFO [Broker id=0] Leader __consumer_offsets-5 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:41,075] INFO [Broker id=0] Leader __consumer_offsets-20 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:41,077] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(0, 1, 2) for 1 partitions (state.change.logger)
[2024-10-16 15:12:41,080] INFO [Broker id=1] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 20 (state.change.logger)
[2024-10-16 15:12:41,080] INFO [Broker id=2] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 20 (state.change.logger)
[2024-10-16 15:12:41,081] INFO [Broker id=0] Leader __consumer_offsets-41 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:41,093] INFO [Broker id=0] Leader __consumer_offsets-29 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:41,096] INFO [Broker id=0] Leader __consumer_offsets-44 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:41,099] INFO [Broker id=0] Leader __consumer_offsets-14 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:41,106] INFO [Broker id=0] Leader __consumer_offsets-2 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:41,108] INFO [Broker id=0] Leader __consumer_offsets-23 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:41,111] INFO [Broker id=0] Leader __consumer_offsets-38 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:41,114] INFO [Broker id=0] Leader __consumer_offsets-8 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:41,121] INFO [Broker id=0] Leader __consumer_offsets-11 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:41,124] INFO [Broker id=0] Leader __consumer_offsets-26 starts at leader epoch 17 from offset 142 with high watermark 142 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:41,126] INFO [Broker id=0] Leader __consumer_offsets-47 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:41,129] INFO [Broker id=0] Leader __consumer_offsets-17 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:41,136] INFO [Broker id=0] Leader __consumer_offsets-32 starts at leader epoch 17 from offset 0 with high watermark 0 ISR [0] addingReplicas [] removingReplicas []. Previous leader epoch was -1. (state.change.logger)
[2024-10-16 15:12:41,274] INFO [Broker id=0] Finished LeaderAndIsr request in 275ms correlationId 3 from controller 1 for 17 partitions (state.change.logger)
[2024-10-16 15:12:41,281] INFO [Broker id=0] Add 17 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 4 (state.change.logger)
[2024-10-16 15:12:41,293] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 5 (state.change.logger)
[2024-10-16 15:12:41,301] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 6 (state.change.logger)
[2024-10-16 15:12:41,305] INFO [Broker id=0] Add 1 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 7 (state.change.logger)
[2024-10-16 15:13:13,138] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-10-16 15:13:13,154] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-8 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-8 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:13:13,155] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-35 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-35 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:13:13,155] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-47 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-47 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:13:13,155] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-38 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-38 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:13:13,155] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-17 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-17 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:13:13,156] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-11 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-11 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:13:13,156] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-29 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-29 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:13:13,156] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-32 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-32 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:13:13,156] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-41 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-41 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:13:13,156] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-23 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-23 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:13:13,156] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition topic2-0 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition topic2-0 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:13:13,157] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-2 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-2 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:13:13,157] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-14 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-14 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:13:13,158] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-20 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-20 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:13:13,158] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-44 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-44 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:13:13,158] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-5 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-5 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:13:13,159] ERROR [Controller id=1 epoch=10] Controller 1 epoch 10 failed to change state for partition __consumer_offsets-26 from OfflinePartition to OnlinePartition (state.change.logger)
kafka.common.StateChangeFailedException: Failed to elect leader for partition __consumer_offsets-26 under strategy OfflinePartitionLeaderElectionStrategy(false)
	at kafka.controller.ZkPartitionStateMachine.$anonfun$doElectLeaderForPartitions$7(PartitionStateMachine.scala:432)
	at scala.collection.IterableOnceOps.foreach(IterableOnce.scala:563)
	at scala.collection.IterableOnceOps.foreach$(IterableOnce.scala:561)
	at scala.collection.AbstractIterable.foreach(Iterable.scala:926)
	at kafka.controller.ZkPartitionStateMachine.doElectLeaderForPartitions(PartitionStateMachine.scala:429)
	at kafka.controller.ZkPartitionStateMachine.electLeaderForPartitions(PartitionStateMachine.scala:335)
	at kafka.controller.ZkPartitionStateMachine.doHandleStateChanges(PartitionStateMachine.scala:241)
	at kafka.controller.ZkPartitionStateMachine.handleStateChanges(PartitionStateMachine.scala:161)
	at kafka.controller.PartitionStateMachine.triggerOnlineStateChangeForPartitions(PartitionStateMachine.scala:75)
	at kafka.controller.PartitionStateMachine.triggerOnlinePartitionStateChange(PartitionStateMachine.scala:60)
	at kafka.controller.KafkaController.onReplicasBecomeOffline(KafkaController.scala:628)
	at kafka.controller.KafkaController.onBrokerFailure(KafkaController.scala:598)
	at kafka.controller.KafkaController.processBrokerChange(KafkaController.scala:1622)
	at kafka.controller.KafkaController.process(KafkaController.scala:2532)
	at kafka.controller.QueuedEvent.process(ControllerEventManager.scala:52)
	at kafka.controller.ControllerEventManager$ControllerEventThread.process$1(ControllerEventManager.scala:130)
	at kafka.controller.ControllerEventManager$ControllerEventThread.$anonfun$doWork$1(ControllerEventManager.scala:133)
	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.scala:18)
	at kafka.metrics.KafkaTimer.time(KafkaTimer.scala:31)
	at kafka.controller.ControllerEventManager$ControllerEventThread.doWork(ControllerEventManager.scala:133)
	at kafka.utils.ShutdownableThread.run(ShutdownableThread.scala:96)
[2024-10-16 15:13:13,159] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet() for 0 partitions (state.change.logger)
[2024-10-16 15:13:13,212] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-8 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:18,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,212] INFO [Controller id=1 epoch=10] Partition product-created-events-topics-2 state changed to (Leader:2,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:27,ZkVersion:45,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,212] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-35 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:18,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,212] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-47 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:18,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,212] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-38 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:18,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,212] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-11 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:18,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,212] INFO [Controller id=1 epoch=10] Partition product-created-events-topics-1 state changed to (Leader:1,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:27,ZkVersion:45,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,212] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-29 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:18,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,212] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-32 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:18,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,213] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-41 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:18,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,213] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-23 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:18,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,213] INFO [Controller id=1 epoch=10] Partition topic2-0 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:5,ZkVersion:5,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,213] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-17 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:18,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,213] INFO [Controller id=1 epoch=10] Partition product-created-events-topics-0 state changed to (Leader:1,ISR:2,1,LeaderRecoveryState:RECOVERED,LeaderEpoch:26,ZkVersion:44,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,213] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-2 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:18,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,213] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-14 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:18,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,213] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-20 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:18,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,214] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-44 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:18,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,214] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-5 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:18,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,214] INFO [Controller id=1 epoch=10] Partition __consumer_offsets-26 state changed to (Leader:-1,ISR:0,LeaderRecoveryState:RECOVERED,LeaderEpoch:18,ZkVersion:18,ControllerEpoch:10) after removing replica 0 from the ISR as part of transition to OfflineReplica (state.change.logger)
[2024-10-16 15:13:13,214] INFO [Controller id=1 epoch=10] Sending LeaderAndIsr request to broker 1 with 2 become-leader and 1 become-follower partitions (state.change.logger)
[2024-10-16 15:13:13,214] INFO [Controller id=1 epoch=10] Sending LeaderAndIsr request to broker 2 with 1 become-leader and 2 become-follower partitions (state.change.logger)
[2024-10-16 15:13:13,214] INFO [Controller id=1 epoch=10] Sending UpdateMetadata request to brokers HashSet(1, 2) for 20 partitions (state.change.logger)
[2024-10-16 15:13:13,215] INFO [Broker id=1] Handling LeaderAndIsr request correlationId 21 from controller 1 for 3 partitions (state.change.logger)
[2024-10-16 15:13:13,216] INFO [Broker id=2] Handling LeaderAndIsr request correlationId 21 from controller 1 for 3 partitions (state.change.logger)
[2024-10-16 15:13:13,216] INFO [Broker id=1] Stopped fetchers as part of LeaderAndIsr request correlationId 21 from controller 1 epoch 10 as part of the become-leader transition for 2 partitions (state.change.logger)
[2024-10-16 15:13:13,217] INFO [Broker id=1] Leader product-created-events-topics-1 starts at leader epoch 27 from offset 0 with high watermark 0 ISR [2,1] addingReplicas [] removingReplicas []. Previous leader epoch was 26. (state.change.logger)
[2024-10-16 15:13:13,217] INFO [Broker id=2] Stopped fetchers as part of LeaderAndIsr request correlationId 21 from controller 1 epoch 10 as part of the become-leader transition for 1 partitions (state.change.logger)
[2024-10-16 15:13:13,218] INFO [Broker id=2] Leader product-created-events-topics-2 starts at leader epoch 27 from offset 0 with high watermark 0 ISR [2,1] addingReplicas [] removingReplicas []. Previous leader epoch was 26. (state.change.logger)
[2024-10-16 15:13:13,221] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 21 from controller 1 epoch 10 for partition product-created-events-topics-1 (last update controller epoch 10) since it is already the leader for the partition. (state.change.logger)
[2024-10-16 15:13:13,221] INFO [Broker id=1] Leader product-created-events-topics-0 starts at leader epoch 26 from offset 0 with high watermark 0 ISR [2,1] addingReplicas [] removingReplicas []. Previous leader epoch was 25. (state.change.logger)
[2024-10-16 15:13:13,221] INFO [Broker id=2] Skipped the become-leader state change after marking its partition as leader with correlation id 21 from controller 1 epoch 10 for partition product-created-events-topics-2 (last update controller epoch 10) since it is already the leader for the partition. (state.change.logger)
[2024-10-16 15:13:13,221] INFO [Broker id=2] Follower product-created-events-topics-1 starts at leader epoch 27 from offset 0 with high watermark 0. Previous leader epoch was 26. (state.change.logger)
[2024-10-16 15:13:13,221] INFO [Broker id=2] Follower product-created-events-topics-0 starts at leader epoch 26 from offset 0 with high watermark 0. Previous leader epoch was 25. (state.change.logger)
[2024-10-16 15:13:13,223] INFO [Broker id=2] Stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 21 for 2 partitions (state.change.logger)
[2024-10-16 15:13:13,224] INFO [Broker id=1] Skipped the become-leader state change after marking its partition as leader with correlation id 21 from controller 1 epoch 10 for partition product-created-events-topics-0 (last update controller epoch 10) since it is already the leader for the partition. (state.change.logger)
[2024-10-16 15:13:13,224] INFO [Broker id=1] Follower product-created-events-topics-2 starts at leader epoch 27 from offset 0 with high watermark 0. Previous leader epoch was 26. (state.change.logger)
[2024-10-16 15:13:13,234] INFO [Broker id=2] Finished LeaderAndIsr request in 19ms correlationId 21 from controller 1 for 3 partitions (state.change.logger)
[2024-10-16 15:13:13,234] INFO [Broker id=1] Stopped fetchers as part of become-follower request from controller 1 epoch 10 with correlation id 21 for 1 partitions (state.change.logger)
[2024-10-16 15:13:13,235] INFO [Broker id=2] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 22 (state.change.logger)
[2024-10-16 15:13:13,236] INFO [Broker id=1] Finished LeaderAndIsr request in 21ms correlationId 21 from controller 1 for 3 partitions (state.change.logger)
[2024-10-16 15:13:13,237] INFO [Broker id=1] Add 20 partitions and deleted 0 partitions from metadata cache in response to UpdateMetadata request sent by controller 1 epoch 10 with correlation id 22 (state.change.logger)
